<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Developer | iOSæ¢¦å·¥å‚]]></title>
  <link href="http://al1020119.github.io/blog/categories/developer/atom.xml" rel="self"/>
  <link href="http://al1020119.github.io/"/>
  <updated>2016-08-04T10:11:23+08:00</updated>
  <id>http://al1020119.github.io/</id>
  <author>
    <name><![CDATA[iCocos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOSå¼€å‘å„ç§åº•å±‚å®ç°--åŒ…ä½ æ»¡æ„ğŸ˜˜ï¼]]></title>
    <link href="http://al1020119.github.io/blog/2016/08/01/gezhongdicenshixian/"/>
    <updated>2016-08-01T23:53:19+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/08/01/gezhongdicenshixian</id>
    <content type="html"><![CDATA[<p>iOSå¼€å‘å¸¸ç”¨æŠ€æœ¯åº•å±‚å®ç°ï¼ˆç²¾ç®€æ¦‚è¿°ï¼‰</p>

<p>æœ¬ç« å°†å¯¹ioså¼€å‘æŠ€æœ¯åº•å±‚å®ç°çš„æ€»ç»“ï¼Œå…¶å®å…³äºioså¼€å‘ä¸­å„ç§åº•å±‚çš„å®ç°ï¼Œç½‘ä¸Šç›¸å…³æ–‡ç« å¤šåˆ°æ•°ä¸è¿‡æ¥ï¼Œè€Œä¸ä¸”éå¸¸ä¸é”™ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰è‡ªä¿¡æˆ‘èƒ½æ¯”ä»–ä»¬åšçš„æ›´å¥½ï¼Œå› ä¸ºæ¯•ç«Ÿæ¯ä¸ªäººä¸“ç ”çš„ä¸œè¥¿ä¸ä¸€æ ·ï¼Œæœ¬æ–‡ä¸»è¦æ­£å¯¹ä¸‰ç±»ç”¨æˆ·ï¼</p>

<ol>
<li>èµ„æ·±çš„ioså¼€å‘è€…ï¼Œå¯¹åº•å±‚åšè¿‡ä¸“é—¨ç ”ç©¶ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªç³»ç»Ÿæ•´ç†ï¼Œæˆ–è€…è¯´ä¸èƒ½å¾ˆæ¸…æ¥šçš„è¡¨è¾¾ã€‚</li>
<li>ioså¼€å‘åˆå­¦è€…ï¼Œæ²¡æœ‰ä¸“é—¨ç ”ç©¶è¿‡åº•å±‚æˆ–è€…ç›¸å…³æºç çš„åˆå­¦è€…ï¼Œä½†æ˜¯ä¸å¤ªå»ºè®®ä¸€å¼€å§‹å°±çœ‹ï¼Œå› ä¸ºå¦‚æœä½ æ²¡æœ‰è¿‡ä¸€ç‚¹æ¥è§¦ï¼Œçœ‹äº†ä¹Ÿçœ‹ä¸æ‡‚ï¼Œæˆ–è€…çœ‹äº†ä¹Ÿç™½çœ‹ï¼Œæœ€å¤šå°±æ˜¯ç•™ä¸ªå°è±¡åœ¨è„‘å­äº†ï¼Œå¯¹åˆå­¦è€…æ¥è¯´ï¼Œåˆ‡è®°ä¸èƒ½é èƒŒæˆ–è€…äº†è§£ï¼Œè€Œä¸”ç»†ç»†ç ”ç©¶æ¯ä¸€ä¸ªæŠ€æœ¯ç‚¹ï¼Œå†æ…¢æ…¢æ·±å…¥æŒ–æ˜ã€‚</li>
<li>ioså¼€å‘å¾…ä¸šç¨‹åºå‘˜ï¼ˆé¢è¯•ï¼‰ä¸“ç”¨ï¼Œä¸ç®¡ä½ æœ‰æ²¡æœ‰æ¥è§¦è¿‡ioså¼€å‘ç›¸å…³çš„åº•å±‚ï¼Œåªè¦ä½ æ˜¯åœ¨å‡†å¤‡æ‰¾å·¥ä½œçš„ç¨‹åºå‘˜ï¼Œæˆ‘ç›¸ä¿¡ä½ çœ‹äº†ç»å¯¹æœ‰ç”¨ï¼Œä½†æ˜¯å¹¶ä¸èƒ½æ­£é¢ä½ å°±çœŸçš„ç†è§£äº†ï¼Œæ‰€ä»¥å¸Œæœ›è¿™å¯¹ä½ æ¥è¯´åªæ˜¯çŸ­æš‚çš„ï¼Œåç»­å¾—èŠ±å¤§é‡æ—¶é—´å»ä¸“é—¨ç ”ç©¶æ‰èƒ½åœ¨è¿™æ¡è·¯ä¸Šèµ°å¾—æ›´è¿œï¼Œä¸ç„¶ä½ æ°¸è¿œåªæ˜¯ä¸ªç å†œï¼</li>
</ol>


<p>å¥½äº†ï¼ŒåºŸè¯ä¹Ÿä¸å¤šè¯´äº†ï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚ã€‚ã€‚ã€‚ã€‚</p>

<h6>ç³»ç»Ÿç¯‡</h6>

<ul>
<li>å†…å­˜ç®¡ç†</li>
<li>Runtime</li>
</ul>


<h6>ä»£ç ç¯‡</h6>

<ul>
<li>Block</li>
<li>__Block</li>
</ul>


<!--more-->


<h6>å®æˆ˜</h6>

<ul>
<li>KVO</li>
<li>KVC</li>
</ul>


<h6>é«˜çº§</h6>

<ul>
<li>GCD</li>
</ul>


<h6>é€šç”¨ç¯‡</h6>

<ul>
<li>æ•°ç»„</li>
<li>å­—å…¸</li>
<li>é›†åˆ</li>
</ul>


<h6>å¿…å¤‡ç¯‡</h6>

<ul>
<li>å¤šçº¿ç¨‹</li>
<li>ç½‘ç»œ</li>
<li>æ•°æ®æŒä¹…åŒ–</li>
</ul>


<h6>å…¨æ ˆç¯‡</h6>

<ul>
<li>JSPatch</li>
<li>React Native</li>
</ul>


<h6>#å†™åœ¨æœ€å</h6>

<p>æ›´æ–°ä¸­ï¼Œæ•¬è¯·å…³æ³¨ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>

<pre><code>Q Qï¼š2211523682/790806573

å¾®ä¿¡ï¼š18370997821/13148454507

å¾®åšWB:http://weibo.com/u/3288975567?is_hot=1

gitåšæ–‡ï¼šhttp://al1020119.github.io/

githubï¼šhttps://github.com/al1020119
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç¬¬ä¸‰æ–¹æ”¯ä»˜æ€»ç»“]]></title>
    <link href="http://al1020119.github.io/blog/2016/01/18/disanfangzhifu/"/>
    <updated>2016-01-18T11:35:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/01/18/disanfangzhifu</id>
    <content type="html"><![CDATA[<p>å¼•è¨€ï¼š
éšç€ç§»åŠ¨äº’è”çš„å‘å±•ï¼Œæ”¯ä»˜åŠŸèƒ½è¶Šæ¥è¶Šæµè¡Œï¼Œè¿™ä¹Ÿä½¿å¾—å„å¤§appå…¬å¸ä¸å¾—ä¸é›†æˆç›¸å…³æ”¯ä»˜åŠŸèƒ½ï¼Œæ–‡æœ¬å°±å°±æ­¤è°ˆè°ˆæ”¯ä»˜ç›¸å…³ã€‚</p>

<p>æœ¬æ–‡æºç æºç ï¼ˆå°è£…ï¼‰<a href="https://github.com/al1020119/iCocosPay">iCocosPay</a>ï¼ˆå†…é›†å¸¸è§æ”¯ä»˜æ–¹æ¡ˆï¼šæˆæ”¯ä»˜å®ï¼Œå¾®ä¿¡ï¼Œé“¶è”ï¼‰</p>

<p>ç›®å½•</p>

<ul>
<li>å¸¸è§æ”¯ä»˜æ–¹æ¡ˆ</li>
<li>ç¬¬ä¸‰æ–¹æ”¯ä»˜SDK</li>
<li>è‹¹æœå®˜æ–¹æ”¯ä»˜æ–¹æ¡ˆ</li>
<li>webæ”¯ä»˜æ–¹æ¡ˆ</li>
</ul>


<!--more-->


<h2>ä¸€:å¸¸è§æ”¯ä»˜æ–¹æ¡ˆ</h2>

<p>å…ˆæ¥çœ‹ä¸€ç»„æˆªå›¾</p>

<p><img src="/images/zhifu001.png" title="Caption" ></p>

<p><img src="/images/zhifu002.png" title="Caption" ></p>

<p><img src="/images/zhifu003.png" title="Caption" ></p>

<p><img src="/images/zhifu004.png" title="Caption" ></p>

<p><img src="/images/zhifu005.png" title="Caption" ></p>

<ul>
<li><p>å¾®ä¿¡æ”¯ä»˜</p></li>
<li><p>æ”¯ä»˜å®æ”¯ä»˜</p></li>
<li><p>é“¶è”ï¼ˆå¿«æ·ï¼‰æ”¯ä»˜</p></li>
<li><p>äº¬ä¸œæ”¯ä»˜</p></li>
<li><p>ç™¾åº¦é’±åŒ…</p></li>
<li><p>webæ”¯ä»˜</p></li>
<li><p>QQé’±åŒ…æ”¯ä»˜</p></li>
<li><p>è¿è¿æ”¯ä»˜</p></li>
</ul>


<p>ï¿¼ï¿¼ï¿¼ï¿¼
æ•´ç†å›¾ï¼š</p>

<p><img src="/images/zhifu006.png" title="Caption" ></p>

<h2>äºŒï¼šæœ€å¸¸è§çš„ä¸‰ç§æ”¯ä»˜æ–¹å¼</h2>

<ul>
<li>å¾®ä¿¡æ”¯ä»˜SDK</li>
<li>æ”¯ä»˜å®æ”¯ä»˜SDK</li>
<li>é“¶è”å¿«æ·æ”¯ä»˜SDK</li>
</ul>


<h4>å¾®ä¿¡</h4>

<h5>ä»€ä¹ˆæ˜¯å¾®ä¿¡æ”¯ä»˜</h5>

<p>å¾®ä¿¡æ”¯ä»˜æ˜¯é›†æˆåœ¨å¾®ä¿¡å®¢æˆ·ç«¯çš„æ”¯ä»˜åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰‹æœºå®Œæˆå¿«é€Ÿçš„æ”¯ä»˜æµç¨‹ã€‚å¾®ä¿¡æ”¯ä»˜ä»¥ç»‘å®šé“¶è¡Œå¡çš„å¿«æ·æ”¯ä»˜ä¸ºåŸºç¡€ï¼Œå‘ç”¨æˆ·æä¾›å®‰å…¨ã€å¿«æ·ã€é«˜æ•ˆçš„æ”¯ä»˜æœåŠ¡ã€‚</p>

<h5>ç”³è¯·æµç¨‹ï¼š</h5>

<p>ç¬¬ä¸€é˜¶æ®µï¼š</p>

<p><img src="/images/zhifu007.png" title="Caption" ></p>

<p>ç¬¬äºŒé˜¶æ®µï¼š</p>

<p><img src="/images/zhifu008.png" title="Caption" ></p>

<p>ç¬¬ä¸‰é˜¶æ®µï¼š</p>

<p><img src="/images/zhifu009.png" title="Caption" ></p>

<h5>åº”ç”¨åœºæ™¯ï¼š</h5>

<p>å•†æˆ·APPè°ƒç”¨å¾®ä¿¡æä¾›çš„SDKè°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¨¡å—ï¼Œå•†æˆ·APPä¼šè·³è½¬åˆ°å¾®ä¿¡ä¸­å®Œæˆæ”¯ä»˜ï¼Œæ”¯ä»˜å®Œåè·³å›åˆ°å•†æˆ·APPå†…ï¼Œæœ€åå±•ç¤ºæ”¯ä»˜ç»“æœã€‚</p>

<h5>æ”¯ä»˜æµç¨‹</h5>

<p>Appå†…æäº¤è®¢å•ï¼ˆç¡®è®¤æ”¯ä»˜ï¼‰
å•†å“ä¿¡æ¯ç¡®è®¤ï¼ˆç«‹å³æ”¯ä»˜ï¼‰
è¾“å…¥å¯†ç ï¼ˆè¿›è¡Œæ”¯ä»˜ï¼‰
æ”¯ä»˜æˆåŠŸ</p>

<h5>Appæ¥å…¥æ­¥éª¤</h5>

<p><img src="/images/zhifu010.png" title="Caption" ></p>

<h4>æ”¯ä»˜å®</h4>

<h5>ä»€ä¹ˆæ˜¯æ”¯ä»˜å®æ”¯ä»˜ï¼š</h5>

<p>æ”¯ä»˜å®ç§»åŠ¨æ”¯ä»˜æ˜¯ä¸€ç§ç¨‹åºå¼çš„æ”¯ä»˜æ–¹å¼ï¼Œåœ¨æ‰‹æœºã€æŒä¸Šç”µè„‘ç­‰æ— çº¿è®¾å¤‡çš„åº”ç”¨ç¨‹åºå†…ï¼Œä¹°å®¶å¯é€šè¿‡æ”¯ä»˜å®è¿›è¡Œä»˜æ¬¾è´­ä¹°ç‰¹å®šæœåŠ¡æˆ–å•†å“ï¼Œèµ„é‡‘å³æ—¶åˆ°è´¦ã€‚</p>

<h5>ç”³è¯·æµç¨‹</h5>

<p><img src="/images/zhifu011.png" title="Caption" ></p>

<h5>æ”¯ä»˜æµç¨‹ï¼š</h5>

<p>ä¹°å®¶å†æ‰‹æœºåº”ç”¨ä¸­è´­ä¹°å•†å“æˆ–è€…æœåŠ¡
ä¹°å®¶é€‰æ‹©æ”¯ä»˜å®æ–¹å¼æ”¯ä»˜
è¿›å…¥æ”¯ä»˜å®æ”¶é“¶å°è¿›è¡Œæ”¯ä»˜
æ”¯ä»˜æˆåŠŸ
äº¤æ˜“å®Œæˆä¹°å®¶å¯æŸ¥çœ‹äº¤æ˜“ä¿¡æ¯
è¿”å›å¯¹åº”çš„appç•Œé¢</p>

<h5>Appæ¥å…¥æ­¥éª¤</h5>

<p><img src="/images/zhifu012.png" title="Caption" ></p>

<h4>é“¶è”</h4>

<h5>ä»€ä¹ˆå€¼é“¶è”æ”¯ä»˜</h5>

<p><img src="/images/zhifu013.png" title="Caption" ></p>

<h5>ç”³è¯·æµç¨‹ï¼š</h5>

<p><img src="/images/zhifu014.png" title="Caption" ></p>

<h5>æ”¯ä»˜æµç¨‹ï¼š</h5>

<p><img src="/images/zhifu015.png" title="Caption" ></p>

<h5>æ¥å…¥æµç¨‹ï¼š</h5>

<p><img src="/images/zhifu016.png" title="Caption" ></p>

<h5>æœ€åæ•´ç†ä¸€ä¸‹å…·ä½“æ­¥éª¤ï¼š</h5>

<ol>
<li>é¦–å…ˆå®¢æˆ·ç«¯æµè§ˆå•†å“ï¼Œç‚¹å‡»ä¸‹å•ï¼Œè¯·æ±‚åˆ°è¾¾å•†æˆ·åå°ã€‚</li>
<li>å•†æˆ·åå°å†æäº¤è®¢å•ä¿¡æ¯åˆ°é“¶è”åå°ã€‚</li>
<li>é“¶è”åå°è¿”å›äº¤æ˜“æµæ°´å·ã€‚</li>
<li>å•†æˆ·åå°å°†äº¤æ˜“æµæ°´å·è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>å®¢æˆ·ç«¯å†é€šè¿‡äº¤æ˜“æµæ°´å·å¯åŠ¨æ‰‹æœºæ§ä»¶å¼€å§‹æ”¯ä»˜ã€‚</li>
<li>æ”¯ä»˜æ§ä»¶æ”¶é›†æ”¯ä»˜ä¿¡æ¯å¹¶è¯·æ±‚é“¶è”åå°ï¼Œå®Œæˆæ”¯ä»˜åé“¶è”åå°é€šçŸ¥å•†æˆ·åå°æ”¯ä»˜ç»“æœã€‚</li>
<li>é“¶è”åå°é€šçŸ¥æ”¯ä»˜æ§ä»¶æ”¯ä»˜ç»“æœã€‚</li>
<li>æ”¯ä»˜æ§ä»¶é€šçŸ¥å®¢æˆ·ç«¯æ”¯ä»˜ç»“æœã€‚</li>
<li>æœ€åå®¢æˆ·ç«¯å°†æ”¯ä»˜ç»“æœå±•ç¤ºç»™ç”¨æˆ·ã€‚</li>
</ol>


<h2>ä¸‰ï¼šè‹¹æœå®˜æ–¹æ”¯ä»˜æ–¹æ¡ˆ</h2>

<ul>
<li>IPA</li>
<li>Apple Pay</li>
</ul>


<h3>IPA</h3>

<h5>ä»€ä¹ˆæ˜¯IPAï¼š</h5>

<p>In App Purchaseå±äºiPhone SDK3.0çš„æ–°ç‰¹æ€§ï¼Œç”¨äºåœ¨åº”ç”¨ç¨‹åºä¸­è´­ä¹°ä»˜è´¹é“å…·ï¼Œå¢åŠ æ–°åŠŸèƒ½ï¼Œè®¢é˜…æ‚å¿—ã€‚æ˜¯åº”ç”¨ç¨‹åºé™¤äº†æ¤å…¥å¹¿å‘Šå¤–çš„å¦ä¸€ç§å–å¾—æ”¶ç›Šçš„æ–¹å¼ã€‚</p>

<h5>IPAæ”¯æŒçš„äº§å“ç±»å‹ï¼š</h5>

<p><img src="/images/zhifu017.png" title="Caption" ></p>

<p>IPAä¸¤ç§æ”¯ä»˜æ–¹å¼ï¼š
æ–¹å¼ä¸€ï¼šå†…ç½®äº§å“ç±»å‹</p>

<p><img src="/images/zhifu018.png" title="Caption" >
æ–¹å¼äºŒï¼šæœåŠ¡å™¨ç±»å‹</p>

<p><img src="/images/zhifu019.png" title="Caption" ></p>

<h5>æ³¨æ„äº‹é¡¹ï¼š</h5>

<ol>
<li>ä½ å¿…é¡»æä¾›ç”µå­ç±»äº§å“å’ŒæœåŠ¡ã€‚ä¸è¦ä½¿ç”¨In App Purchase å»å‡ºå”®å®ç‰©å’Œå®é™…æœåŠ¡ã€‚</li>
<li>ä¸èƒ½æä¾›ä»£è¡¨ä¸­ä»‹è´§å¸çš„ç‰©å“ï¼Œå› ä¸ºè®©ç”¨æˆ·çŸ¥æ™“ä»–ä»¬è´­ä¹°çš„å•†å“å’ŒæœåŠ¡æ˜¯å¾ˆé‡è¦çš„ã€‚</li>
</ol>


<h5>ç›¸å…³æµç¨‹ï¼š</h5>

<ol>
<li>ç¨‹åºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å¾—ä¸€ä»½äº§å“åˆ—è¡¨ã€‚</li>
<li>æœåŠ¡å™¨è¿”å›åŒ…å«äº§å“æ ‡è¯†ç¬¦çš„åˆ—è¡¨ã€‚</li>
<li>ç¨‹åºå‘App Storeå‘é€è¯·æ±‚ï¼Œå¾—åˆ°äº§å“çš„ä¿¡æ¯ã€‚</li>
<li>App Storeè¿”å›äº§å“ä¿¡æ¯ã€‚</li>
<li>ç¨‹åºæŠŠè¿”å›çš„äº§å“ä¿¡æ¯æ˜¾ç¤ºç»™ç”¨æˆ·ï¼ˆAppçš„storeç•Œé¢ï¼‰</li>
<li>ç”¨æˆ·é€‰æ‹©æŸä¸ªäº§å“</li>
<li>ç¨‹åºå‘App Storeå‘é€æ”¯ä»˜è¯·æ±‚</li>
<li>App Storeå¤„ç†æ”¯ä»˜è¯·æ±‚å¹¶è¿”å›äº¤æ˜“å®Œæˆä¿¡æ¯ã€‚</li>
<li>ç¨‹åºä»ä¿¡æ¯ä¸­è·å¾—æ•°æ®ï¼Œå¹¶å‘é€è‡³æœåŠ¡å™¨ã€‚</li>
<li>æœåŠ¡å™¨çºªå½•æ•°æ®ï¼Œå¹¶è¿›è¡Œå®¡(æˆ‘ä»¬çš„)æŸ¥ã€‚</li>
<li>æœåŠ¡å™¨å°†æ•°æ®å‘ç»™App Storeæ¥éªŒè¯è¯¥äº¤æ˜“çš„æœ‰æ•ˆæ€§ã€‚</li>
<li>App Storeå¯¹æ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£æï¼Œè¿”å›è¯¥æ•°æ®å’Œè¯´æ˜å…¶æ˜¯å¦æœ‰æ•ˆçš„æ ‡è¯†ã€‚</li>
<li>æœåŠ¡å™¨è¯»å–è¿”å›çš„æ•°æ®ï¼Œç¡®å®šç”¨æˆ·è´­ä¹°çš„å†…å®¹ã€‚</li>
<li>æœåŠ¡å™¨å°†è´­ä¹°çš„å†…å®¹ä¼ é€’ç»™ç¨‹åºã€‚</li>
</ol>


<h3>Apple Pay</h3>

<h5>ä»€ä¹ˆæ˜¯Apple Payï¼š</h5>

<p>Apple Payä¸è¯¸å¤šä¼ ç»Ÿç§»åŠ¨æ”¯ä»˜ç³»ç»Ÿä¸åŒï¼Œä¸ä½†æœ‰Touch IDæŒ‡çº¹è¯†åˆ«æŠ€æœ¯æŠ¤èˆªï¼Œè¿˜èƒ½åœ¨Apple Watchä¸Šè¿ä½œã€‚</p>

<h5>ç›¸å…³æµç¨‹ï¼š</h5>

<ol>
<li>ç¨‹åºé€šè¿‡bundleå­˜å‚¨çš„plistæ–‡ä»¶å¾—åˆ°äº§å“æ ‡è¯†ç¬¦çš„åˆ—è¡¨ã€‚</li>
<li>ç¨‹åºå‘App Storeå‘é€è¯·æ±‚ï¼Œå¾—åˆ°äº§å“çš„ä¿¡æ¯ã€‚</li>
<li>App Storeè¿”å›äº§å“ä¿¡æ¯ã€‚</li>
<li>ç¨‹åºæŠŠè¿”å›çš„äº§å“ä¿¡æ¯æ˜¾ç¤ºç»™ç”¨æˆ·ï¼ˆAppçš„storeç•Œé¢ï¼‰</li>
<li>ç”¨æˆ·é€‰æ‹©æŸä¸ªäº§å“</li>
<li>ç¨‹åºå‘App Storeå‘é€æ”¯ä»˜è¯·æ±‚</li>
<li>App Storeå¤„ç†æ”¯ä»˜è¯·æ±‚å¹¶è¿”å›äº¤æ˜“å®Œæˆä¿¡æ¯ã€‚</li>
<li>Appè·å–ä¿¡æ¯å¹¶æä¾›å†…å®¹ç»™ç”¨æˆ·ã€‚</li>
</ol>


<h2>å››ï¼šwebæ”¯ä»˜æ–¹æ¡ˆ</h2>

<h5>æ¦‚è¿°ï¼š</h5>

<p>iOSä¸­é€šè¿‡UIWebViewå±•ç¤ºWAPæˆ–HTML5æ”¯ä»˜é¡µé¢ï¼Œä»è€Œå®Œæˆæ”¯ä»˜åŠŸèƒ½ï¼Œæ— éœ€æ¥å…¥é¢å¤–ç¬¬ä¸‰æ–¹SDKã€‚
UIWebViewæ˜¯iOS SDKä¸­ä¸€ä¸ªæœ€å¸¸ç”¨çš„æ§ä»¶ï¼Œæ˜¯å†…ç½®çš„æµè§ˆå™¨æ§ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æµè§ˆç½‘é¡µã€æ‰“å¼€æ–‡æ¡£ç­‰ç­‰ã€‚</p>

<h5>ç±»å‹ç•Œé¢ï¼š</h5>

<p><img src="/images/zhifu020.png" title="Caption" ></p>

<p>æ€»ç»“ï¼š</p>

<p>æœ€åæœ¬äººæ ¹æ®å®é™…å¼€å‘æ•´ç†äº†ä¸€ä»½å…³äºæ”¯ä»˜çš„æºç ï¼ˆå°è£…ï¼‰<a href="https://github.com/al1020119/iCocosPay">iCocosPay</a>ï¼Œå†…é›†æˆäº†ï¼šæ”¯ä»˜å®æ”¯ä»˜ï¼Œå¾®ä¿¡æ”¯ä»˜ï¼Œé“¶è”å¿«æ·æ”¯ä»˜ï¼</p>

<p>ä½ æ˜¯ä¸æ˜¯åœ¨æ‰¾æ¥å£æ–‡æ¡£ï¼Ÿ</p>

<ul>
<li><a href="https://pay.weixin.qq.com/wiki/doc/api/index.html">å¾®ä¿¡æ”¯ä»˜</a></li>
<li><a href="https://b.alipay.com/order/productDetail.htm?productId=2015110218010538&amp;tabId=1#ps-tabinfo-hashhttp://doc.open.alipay.com/doc2/detail?treeId=59&amp;articleId=103563&amp;docType=1">æ”¯ä»˜å®æ”¯ä»˜</a></li>
<li><a href="https://open.unionpay.com/ajweb/index">é“¶è”</a></li>
<li><a href="https://b.alipay.com/order/productDetail.htm?productId=2015110218008816https://open.unionpay.com/ajweb/help/file/techFile?productId=66">Webæ”¯ä»˜</a></li>
<li><a href="https://developer.apple.com/in-app-purchase/">IAP</a></li>
<li><a href="https://developer.apple.com/apple-pay/">Apple Pay</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[é‡é‡çº§-MVC-MVVM-DC]]></title>
    <link href="http://al1020119.github.io/blog/2016/01/01/zhong-liang-ji/"/>
    <updated>2016-01-01T16:21:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/01/01/zhong-liang-ji</id>
    <content type="html"><![CDATA[<p>é¦–å…ˆå†è¿™é‡Œç¥å¤§å®¶æ–°å¹´å¿«ä¹&hellip;&hellip;.</p>

<p>æ–°çš„ä¸€å¹´æ¥ç‚¹é‡é‡çº§çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>

<p>ç›¸ä¿¡ä½ æ—¢ç„¶èƒ½çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆä¸€å®šå¬è¯´è¿‡MVCï¼Œä»€ä¹ˆæ²¡æœ‰å¬è¿‡ï¼Ÿå‡ºé—¨å·¦è½¬æ‰¾åº¦å¨˜ï¼Œä¸é€ï¼</p>

<p>å¦‚æœä½ å¬è¯´è¿‡MVCï¼Œé‚£ä¹ˆæˆ–è®¸ä½ å¬è¯´è¿‡MVVMï¼Œè¿™é‡Œå¯èƒ½å¾ˆå¤šäººå¯¹MVVMå¹¶ä¸äº†è§£ï¼Œæˆ–è®¸åªæ˜¯å¬è¿‡ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨è¿‡ï¼Œæœ‰äº›å°±ç®—ç”¨è¿‡è¿˜æ˜¯ä¸æ¸…æ¥šé‡Œé¢çš„å…³ç³»ï¼Œåªæ˜¯æ¬ç –è€Œå·²ã€‚</p>

<p>å¯¹äº†ï¼Œä»Šå¤©æˆ‘ä»¬è®¨è®ºçš„å°±æ˜¯ä¸€ä¸ªç±»MVVMçš„æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯åœ¨MVVMä¸Šé¢çš„ä¸€ä¸ªå¢å¼ºç‰ˆçš„å¼€å‘æ¨¡å¼ï¼</p>

<p>MVVMä¸æ­£æ˜¯MVCçš„å¢å¼ºç‰ˆå—ï¼Ÿ</p>

<p>å¥½äº†ä¸‹é¢æ­£å¼å¼€å§‹ï¼Œæ–°å¹´ä¸èƒ½è€½è¯¯å¤§å®¶å¤ªå¤šæ—¶é—´æ¬ç –ï¼Œï¼Œå“ˆå“ˆï¼</p>

<h2>Model-View-Controller</h2>

<!--more-->


<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹MVCï¼Œè¿™é‡ŒMVCå…·ä½“ç»†èŠ‚å°±ä¸å¤šè¯´äº†ã€‚</p>

<ul>
<li>Model(M)ï¼šæ¨¡å‹æ•°æ®</li>
<li>View(V)ï¼šè§†å›¾</li>
<li>Controller&copy;ï¼šæ§åˆ¶å™¨</li>
</ul>


<p><img src="/images/zhongliangji001.png" title="Caption" ></p>

<h6>æœ‰ç‚¹ï¼š</h6>

<ul>
<li>æ˜“å­¦ä¹ </li>
<li>æ˜“å¼€å‘</li>
<li>åŒå“Ÿæ¬§è¯ºä¸ªæˆç†Ÿ</li>
</ul>


<h6>ç¼ºç‚¹ï¼š</h6>

<ul>
<li>Massive View Controller</li>
</ul>


<h2>Model-View-ViewModel</h2>

<p>ç„¶åæ¥çœ‹çœ‹ç°åœ¨æ¯”è¾ƒçƒ­å¾—è¯é¢˜ï¼ˆæ¶æ„ï¼‰MVVM
* Modelï¼ˆMï¼‰:æ¨¡å‹
* View(Vï¼‰:è§†å›¾
* ViewModelï¼ˆVMï¼‰:æ¨¡å‹ï¼ˆé€»è¾‘ï¼‰</p>

<p><img src="/images/zhongliangji002.png" title="Caption" ></p>

<h6>Viewä¸ViewModuleè¿æ¥å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼</h6>

<ul>
<li><p>Binding Dataï¼šå®ç°æ•°æ®çš„ä¼ é€’</p></li>
<li><p>Commandï¼šå®ç°æ“ä½œçš„è°ƒç”¨</p></li>
<li><p>AttachBehaviorï¼šå®ç°æ§ä»¶åŠ è½½è¿‡ç¨‹ä¸­çš„æ“ä½œ</p></li>
</ul>


<h5>Viewæ²¡æœ‰å¤§é‡ä»£ç é€»è¾‘ã€‚</h5>

<ul>
<li><p>ç»“åˆWPFã€Silverlightç»‘å®šæœºåˆ¶ï¼ŒMVPæ¼”å˜å‡ºäº†MVVMï¼Œå……åˆ†åˆ©ç”¨äº†WPFã€Silverlightçš„ä¼˜åŠ¿ï¼Œå°†å¤§é‡ä»£ç é€»è¾‘ã€çŠ¶æ€è½¬åˆ°ViewModelï¼Œå¯ä»¥è¯´MVVMæ˜¯ä¸“é—¨ä¸ºWPFã€Silverlightæ‰“é€ çš„ã€‚</p></li>
<li><p>Viewç»‘å®šåˆ°ViewModelï¼Œç„¶åæ‰§è¡Œä¸€äº›å‘½ä»¤åœ¨å‘å®ƒè¯·æ±‚ä¸€ä¸ªåŠ¨ä½œã€‚è€Œåè¿‡æ¥ï¼ŒViewModelè·ŸModelé€šè®¯ï¼Œå‘Šè¯‰å®ƒæ›´æ–°æ¥å“åº”UIã€‚è¿™æ ·ä¾¿ä½¿å¾—ä¸ºåº”ç”¨æ„å»ºUIéå¸¸çš„å®¹æ˜“ã€‚å¾€ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸Šè´´ä¸€ä¸ªç•Œé¢è¶Šå®¹æ˜“ï¼Œå¤–è§‚è®¾è®¡å¸ˆå°±è¶Šå®¹æ˜“ä½¿ç”¨Blendæ¥åˆ›å»ºä¸€ä¸ªæ¼‚äº®çš„ç•Œé¢ã€‚åŒæ—¶ï¼Œå½“UIå’ŒåŠŸèƒ½è¶Šæ¥è¶Šæ¾è€¦åˆçš„æ—¶å€™ï¼ŒåŠŸèƒ½çš„å¯æµ‹è¯•æ€§å°±è¶Šæ¥è¶Šå¼ºã€‚</p></li>
</ul>


<h6>ä¼˜ç‚¹ï¼š</h6>

<ul>
<li>å‡è½»ViewControllerçš„è´Ÿæ‹…</li>
<li>æé«˜äº†æµ‹è¯•æ€§</li>
<li>å¼ºå¤§çš„ç»‘å®šæœºåˆ¶</li>
</ul>


<h6>ç¼ºç‚¹ï¼š</h6>

<ul>
<li>æé«˜çš„å­¦ä¹ æˆæœ¬å’Œå¼€å‘æˆæœ¬</li>
<li>æ•°æ®ç»‘å®šæ˜¯çš„bugæ›´éš¾è°ƒè¯•</li>
<li>View Modelçš„èŒè´£ä»»ç„¶å¾ˆé‡</li>
<li>æ®æœ¬äººäº†è§£ï¼ŒMVVMç»“åˆRACä½¿ç”¨èƒ½å¤Ÿå‘æŒ¥æœ€å¤§çš„æ•ˆç‡</li>
</ul>


<p>æ€»ä¸Šæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼š</p>

<ul>
<li>æ¯ä¸ªVéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„VMï¼ŒVçš„æ•°æ®å±•ç¤ºç›’æ ·å¼éƒ½ç”±å…¶å®šåˆ¶</li>
<li>ä¸å¼•å…¥åŒæƒ³ç»‘å®šæœºåˆ¶æˆ–è€…è§‚å¯Ÿæœºåˆ¶ï¼Œè€Œæ˜¯é€šè¿‡ä¼ ç»Ÿçš„ä»£ç†å›è°ƒæˆ–è€…é€šçŸ¥å°†UIäº‹ä»¶ä¼ ç»™å¤–ç•Œ</li>
<li>VCåªè´Ÿè´£å°†VMè£…é…ç»™Vï¼Œæ¥å—UIäº‹ä»¶</li>
</ul>


<p>æˆ–è®¸ç»†å¿ƒåœ°èƒ½å‘ç°ä¸‹é¢çš„å¥½å¤„</p>

<ul>
<li>Viewå¯ä»¥å®Œå…¨è§£è€¦ï¼Œåªéœ€è¦ç¡®å®šå¥½ViewModelå’Œå›è°ƒæ¥å£å³å¯</li>
<li>View Controllerå±‚å¯ä»¥å°½å¯èƒ½å°‘å¾—å’ŒViewçš„å…·ä½“è¡¨ç°æ‰“äº¤é“ï¼Œå°†è¿™ä¸åˆ†èŒè´£è½¬ç»™äº†View Modelï¼Œå‡è½»äº†* View Controllerçš„è´Ÿæ‹…</li>
<li>ä½¿ç”¨å›è°ƒçš„ä¼ ç»Ÿå›è°ƒæœºåˆ¶ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼Œæ•°æ®å’Œäº‹ä»¶æµå…¥å’Œæµå‡ºæ˜“è§‚å¯Ÿè€Œä¸”æ›´æ˜“æ§åˆ¶ï¼Œé™ä½ç»´æŠ¤å’Œå›è°ƒæˆæœ¬</li>
</ul>


<h2>Model-View-ViewModel-DataController-Model</h2>

<p>å¥½äº†é‡é‡çº§çš„ä¸œè¥¿æ¥äº†ï¼ŒMVVM-DMï¼ˆMVVM Without Binding With Data Controllerï¼‰</p>

<ul>
<li>Modelï¼ˆMï¼‰:æ¨¡å‹</li>
<li>View(Vï¼‰:è§†å›¾</li>
<li>ViewModelï¼ˆVMï¼‰:åŠ å·¥åçš„æ•°æ®ï¼‰</li>
<li>Data Controllerï¼šç›¸å…³é€»è¾‘</li>
<li>Modelï¼šå¯¹åº”Data Controller</li>
</ul>


<p><img src="/images/zhongliangji003.png" title="Caption" ></p>

<p>æˆ–è®¸æœ‰äº›äººçœ‹åˆ°ä¸Šé¢çš„æ–‡å­—å°±èƒ½çŸ¥é“æˆ‘æœ¬æ–‡çš„å«ä¹‰äº†ï¼Œå¯¹æ²¡é”™ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³MVVMä¸­View Modelè‡ƒè‚¿æƒ…å†µï¼</p>

<h6>ä¼˜ç‚¹ï¼š</h6>

<ul>
<li>é¿å…äº†ä¼ ç»Ÿçš„MVVMæ¶æ„VMå±‚æœ‰å¯èƒ½å˜å¾—è‡ƒè‚¿çš„æƒ…å†µï¼Œæ›´åŠ æ¸…æ™°çš„æ¨¡å—èŒè´£</li>
<li>ä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Œæ•°æ®çš„åŠ å·¥å’Œå¤„ç†éƒ½æ”¾åœ¨Data Controllerä¸­ï¼ŒView Controillerä¸ç”¨å…³å¿ƒæ•°æ®å¦‚ä½•è·å¾—ï¼Œå¦‚ä½•å¤„ç†ï¼ŒData Controllerä¸ç”¨å…³å¿ƒç•Œé¢å¦‚ä½•å±•ç¤ºï¼Œå¦‚ä½•äº¤äº’</li>
<li>Data Controllerä¸ç•Œé¢æ— å…³ï¼Œæ‰€ä»¥å¯ä»¥æœ‰æ›´å¥½çš„å¯æµ‹è¯•æ€§å’Œå¯æœç”¨æ€§</li>
</ul>


<h6>ç¼ºç‚¹ï¼š</h6>

<p>æš‚æ—¶æ²¡æœ‰å‘ç°ï¼ˆéš¾åº¦ï¼šä¸€ä¸‹æ¯”è¾ƒéš¾æ¥å—ï¼‰</p>

<h4>å…·ä½“æ€è·¯æ˜¯ï¼š</h4>

<ul>
<li>1.æ¯ä¸ªViewcontrollerä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„Data Controllerï¼ˆåŒ…å«é¡µé¢çš„æ‰€æœ‰ç›¸å…³é€»è¾‘ï¼šView Related data Controllerï¼‰ ï¼Œåœ¨Viewçš„ViewDidLoadæ–¹æ³•ä¸­åˆå§‹åŒ–Viewï¼ŒlayoutSubViewsä¸­å¸ƒå±€</li>
<li>2.Viewcongtrollerå‘Data Controllerå‘é€è¯·æ±‚ï¼ŒData ControlleråŒ…å«åªæ˜¯çº¯ç²¹çš„Modelç›¸å…³é€»è¾‘ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥å¤ç”¨æ›´å°çš„Data Controllerï¼‰å¦‚ï¼šç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®æŒä¹…ï¼ˆè¯·æ±‚ï¼‰ï¼Œæ•°æ®åŠ å·¥ï¼Œå…¶ä»–ã€‚</li>
<li>3.Data Controllerå°†è¯·æ±‚åˆ°å¾—æ•°æ®åŠ å·¥è¿”å›ç»™View Controller</li>
<li>4.View Controllerå°†Data Controllerè¿”å›çš„åŠ å·¥å¥½çš„æ•°æ®ç”ŸæˆViewModelï¼ˆå±•ç¤ºViewæ‰€éœ€è¦çš„æ•°æ®ï¼‰ï¼Œ</li>
<li>5.View Controlleråè°ƒæ§åˆ¶å¹¶å°†ç”Ÿæˆçš„View Modelè£…é…åˆ°Viewï¼ˆæ¯ä¸ªViewéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„View Modelï¼Œå¯ä»¥æœ‰å­View Modelï¼‰ä¸Šé¢æ˜¾ç¤ºï¼Œè¿™é‡Œç›¸å½“äºä½¿ç”¨ViewModelæ•°æ®æ¥æ¸²æŸ“ç•Œé¢</li>
</ul>


<p>ç»¼ä¸Šï¼š</p>

<ul>
<li>å°†å¤„ç†æ•°æ®å’Œè·å–æ•°æ®çš„èŒè´£ä»ä¼ ç»Ÿçš„MVVMçš„Vmä¸­æŠ½å–å‡ºæ¥ï¼Œæˆä¸ºData Controller</li>
<li>VCè¯·æ±‚æ•°æ®å’Œå°†ä¸€äº›æ•°æ®ä¿®æ”¹çš„äº‹ä»¶ï¼ˆå¯ä»¥æ˜¯UIäº‹ä»¶è§¦å‘ï¼‰ä¼ é€’ç»™Data Controller</li>
<li>Data Controlleræ”¶åˆ°VCçš„è¯·æ±‚åï¼Œå‘Mè·å–æ•°æ®å’Œæ›´æ–°æ•°æ®ï¼Œå¹¶å°†åŠ å·¥åçš„æ•°æ®è¿”å›</li>
<li>Data Controllerè¿˜è´Ÿè´£ç½‘ç»œå±‚å’ŒæŒä¹…åŒ–å±‚çš„é€»è¾‘</li>
</ul>


<blockquote><p>æ€»ç»“ï¼š</p>

<ul>
<li>å±‚æ¬¡æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®ã€‚</li>
<li>è€¦åˆæ€§ä½ï¼Œå¤ç”¨æ€§é«˜</li>
<li>æµ‹è¯•æ€§é«˜</li>
<li>ä½å­¦ä¹ æˆæœ¬ï¼Œä½å¼€å‘æˆæœ¬</li>
<li>é«˜å®æ–½æ€§ï¼Œæ— éœ€æ•´ä½“é‡æ„</li>
</ul>
</blockquote>

<p>æœ¬æ–‡å€Ÿé‰´çŒ¿é¢˜åº“å®¢æˆ·ç«¯æ¶æ„è®¾è®¡ï¼Œæœ€åé™„ä¸Š<a href="blog.devtang.com">å”å·§å¤§V</a>å¾—åšå®¢ï¼Œä»¥è¡¨æ•¬æ„</p>

<p>å‚è€ƒï¼š
<a href="https://mp.weixin.qq.com/s?__biz=MjM5NTIyNTUyMQ==&amp;mid=444322139&amp;idx=1&amp;sn=c7bef4d439f46ee539aa76d612023d43&amp;scene=1&amp;srcid=1230NOb8TaHKmwxS9l8H6ctl&amp;key=62bb001fdbc364e5a1bc589b94bd5aded40e489b2517710a1807b2d4f9e3f8a64fe2eed72590fd83cda13ebebec3002f&amp;ascene=0&amp;uin=MjMzNjU5MzYyMQ%3D%3D&amp;devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.10.5+build%2814F27%29&amp;version=11020201&amp;pass_ticket=5ku6y9zhut5EyBt%2Bg%2FbjIWyq9HCDh4DuNn5XU5p4pwFMaKTtMfZYlkkNnlZDh11C">çŒ¿é¢˜åº“ iOS å®¢æˆ·ç«¯æ¶æ„è®¾è®¡</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç½‘ç»œè¯·æ±‚ç–¯ï¼ˆå°ï¼‰è£…]]></title>
    <link href="http://al1020119.github.io/blog/2015/08/25/wang-shang-qing-qiu-feng-(feng-)zhuang/"/>
    <updated>2015-08-25T09:37:30+08:00</updated>
    <id>http://al1020119.github.io/blog/2015/08/25/wang-shang-qing-qiu-feng-(feng-)zhuang</id>
    <content type="html"><![CDATA[<p>ä¸€ç›´æƒ³æ€»ç»“ä¸€ä¸‹å…³äºiOSçš„ç¦»çº¿æ•°æ®ç¼“å­˜çš„æ–¹é¢çš„é—®é¢˜ï¼Œç„¶åæœ€è¿‘ä¹Ÿç®€å•çš„å¯¹AFNè¿›è¡Œäº†å†æ¬¡å°è£…ï¼Œæ‰€æœ‰æƒ³æŠŠè¿™ä¸¤ä¸ªç»“åˆèµ·æ¥å†™ä¸€ä¸‹ã€‚æ•°æ®å±•ç¤ºå‹çš„é¡µé¢åšç¦»çº¿ç¼“å­˜å¯ä»¥æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œç”¨æˆ·åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä»ç„¶å¯ä»¥è·å–ä¸€äº›æ•°æ®ï¼Œè¿™é‡Œçš„æ•°æ®ç¼“å­˜é¦–é€‰è‚¯å®šæ˜¯SQLiteï¼Œè½»é‡çº§ï¼Œå¯¹æ•°æ®çš„å­˜å‚¨è¯»å–ç›¸å¯¹äºå…¶ä»–å‡ ç§æ–¹å¼æœ‰ä¼˜åŠ¿ï¼Œè¿™é‡Œå¯¹AFNçš„å°è£…æ²¡æœ‰æ¶‰åŠå¤ªå¤šä¸šåŠ¡é€»è¾‘å±‚é¢çš„éœ€æ±‚ï¼Œä¸»è¦è¿˜æ˜¯å¯¹ä¸€äº›æ–¹æ³•å†æ¬¡å°è£…æ–¹ä¾¿ä½¿ç”¨ï¼Œè§£é™¤é¡¹ç›®å¯¹ç¬¬ä¸‰æ–¹çš„è€¦åˆæ€§ï¼Œèƒ½å¤Ÿç®€å•çš„å¿«é€Ÿçš„æ›´æ¢åº•å±‚ä½¿ç”¨çš„ç½‘ç»œè¯·æ±‚ä»£ç ã€‚è¿™ç¯‡ä¸»è¦å†™ç¦»çº¿ç¼“å­˜æ€è·¯ï¼Œå¯¹AFNçš„å°è£…åªåšç®€å•çš„ä»‹ç»ã€‚</p>

<p>å…³äºXLNetworkApi</p>

<!--more-->


<p>XLNetworkApiçš„ä¸€äº›åŠŸèƒ½å’Œè¯´æ˜ï¼š</p>

<p>ä½¿ç”¨XLNetworkRequeståšä¸€äº›GETã€POSTã€PUTã€DELETEè¯·æ±‚ï¼Œä¸ä¸šåŠ¡é€»è¾‘å¯¹æ¥éƒ¨åˆ†ç›´æ¥ä»¥æ•°ç»„æˆ–è€…å­—å…¸çš„å½¢å¼è¿”å›ã€‚
ä»¥åŠç½‘ç»œä¸‹è½½ã€ä¸Šä¼ æ–‡ä»¶ï¼Œä»¥blockçš„å½¢å¼è¿”å›å®æ—¶çš„ä¸‹è½½ã€ä¸Šä¼ è¿›åº¦ï¼Œä¸Šä¼ æ–‡ä»¶å‚æ•°é€šè¿‡æ¨¡å‹XLFileConfigå»å­˜å–ã€‚
é€šè¿‡ç»§æ‰¿äºXLDataServiceæ¥å°†ä¸€äº›æ•°æ®å¤„ç†ï¼Œæ¨¡å‹è½¬åŒ–å°è£…èµ·æ¥ï¼Œäºä¸šåŠ¡é€»è¾‘å¯¹æ¥è¿”å›çš„æ˜¯å¯¹åº”çš„æ¨¡å‹ï¼Œå‡å°‘Controllorå¤„ç†æ•°æ®å¤„ç†é€»è¾‘çš„å‹åŠ›ã€‚
è‡ªå®šä¹‰ä¸€äº›å›è°ƒçš„block</p>

<pre><code>/**
è¯·æ±‚æˆåŠŸblock
*/
typedef void (^requestSuccessBlock)(id responseObj);
/**
è¯·æ±‚å¤±è´¥block
*/
typedef void (^requestFailureBlock) (NSError *error);
/**
è¯·æ±‚å“åº”block
*/
typedef void (^responseBlock)(id dataObj, NSError *error);
/**
ç›‘å¬è¿›åº¦å“åº”block
*/
typedef void (^progressBlock)(int64_t bytesWritten, int64_t totalBytesWritten, int64_t totalBytesExpectedToWrite);
XLNetworkRequest.méƒ¨åˆ†å®ç°
#import "XLNetworkRequest.h"
#import "AFNetworking.h"
@implementation XLNetworkRequest
+ (void)getRequest:(NSString *)url params:(NSDictionary *)params success:(requestSuccessBlock)successHandler failure:(requestFailureBlock)failureHandler {
//ç½‘ç»œä¸å¯ç”¨
  if (![self checkNetworkStatus]) {
      successHandler(nil);
      failureHandler(nil);
      return;
  }
  AFHTTPRequestOperationManager *manager = [self getRequstManager];
  [manager GET:url parameters:params success:^(AFHTTPRequestOperation * _Nonnull operation, id  _Nonnull responseObject) {
      successHandler(responseObject);
  } failure:^(AFHTTPRequestOperation * _Nullable operation, NSError * _Nonnull error) {
      XLLog(@"------è¯·æ±‚å¤±è´¥-------%@",error);
      failureHandler(error);
  }];
}
</code></pre>

<p>ä¸‹è½½éƒ¨åˆ†ä»£ç </p>

<pre><code>    //ä¸‹è½½æ–‡ä»¶ï¼Œç›‘å¬ä¸‹è½½è¿›åº¦
    + (void)downloadRequest:(NSString *)url successAndProgress:(progressBlock)progressHandler complete:(responseBlock)completionHandler {
      if (![self checkNetworkStatus]) {
          progressHandler(0, 0, 0);
          completionHandler(nil, nil);
          return;
      }
      NSURLSessionConfiguration *sessionConfiguration = [NSURLSessionConfiguration defaultSessionConfiguration];
      AFURLSessionManager *manager = [[AFURLSessionManager alloc] initWithSessionConfiguration:sessionConfiguration];
      NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]];
      NSProgress *kProgress = nil;
      NSURLSessionDownloadTask *downloadTask = [manager downloadTaskWithRequest:request progress:&amp;kProgress destination:^NSURL * _Nonnull(NSURL * _Nonnull targetPath, NSURLResponse * _Nonnull response) {
          NSURL *documentUrl = [[NSFileManager defaultManager] URLForDirectory :NSDocumentDirectory inDomain:NSUserDomainMask appropriateForURL:nil create:NO error:nil];
          return [documentUrl URLByAppendingPathComponent:[response suggestedFilename]];
      } completionHandler:^(NSURLResponse * _Nonnull response, NSURL * _Nonnull filePath, NSError * _Nonnull error){
          if (error) {
              XLLog(@"------ä¸‹è½½å¤±è´¥-------%@",error);
          }
          completionHandler(response, error);
      }];
      [manager setDownloadTaskDidWriteDataBlock:^(NSURLSession * _Nonnull session, NSURLSessionDownloadTask * _Nonnull downloadTask, int64_t bytesWritten, int64_t totalBytesWritten, int64_t totalBytesExpectedToWrite) {
          progressHandler(bytesWritten, totalBytesWritten, totalBytesExpectedToWrite);
      }];
      [downloadTask resume];
    }
</code></pre>

<p>ä¸Šä¼ éƒ¨åˆ†ä»£ç </p>

<pre><code>//ä¸Šä¼ æ–‡ä»¶ï¼Œç›‘å¬ä¸Šä¼ è¿›åº¦
+ (void)updateRequest:(NSString *)url params:(NSDictionary *)params fileConfig:(XLFileConfig *)fileConfig successAndProgress:(progressBlock)progressHandler complete:(responseBlock)completionHandler {
  if (![self checkNetworkStatus]) {
      progressHandler(0, 0, 0);
      completionHandler(nil, nil);
      return;
  }
  NSMutableURLRequest *request = [[AFHTTPRequestSerializer serializer] multipartFormRequestWithMethod:@"POST" URLString:url parameters:params constructingBodyWithBlock:^(id  _Nonnull formData) {
      [formData appendPartWithFileData:fileConfig.fileData name:fileConfig.name fileName:fileConfig.fileName mimeType:fileConfig.mimeType];
  } error:nil];
  //è·å–ä¸Šä¼ è¿›åº¦
  AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
  [operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
      progressHandler(bytesWritten, totalBytesWritten, totalBytesExpectedToWrite);
  }];
  [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation * _Nonnull operation, id  _Nonnull responseObject) {
      completionHandler(responseObject, nil);
  } failure:^(AFHTTPRequestOperation * _Nonnull operation, NSError * _Nonnull error) {
      completionHandler(nil, error);
      if (error) {
          XLLog(@"------ä¸Šä¼ å¤±è´¥-------%@",error);
      }
  }];
  [operation start];
}
</code></pre>

<p>XLDataService.méƒ¨åˆ†å®ç°</p>

<pre><code>+ (void)getWithUrl:(NSString *)url param:(id)param modelClass:(Class)modelClass responseBlock:(responseBlock)responseDataBlock {
      [XLNetworkRequest getRequest:url params:param success:^(id responseObj) {
      //æ•°ç»„ã€å­—å…¸è½¬åŒ–ä¸ºæ¨¡å‹æ•°ç»„
      dataObj = [self modelTransformationWithResponseObj:responseObj modelClass:modelClass];
      responseDataBlock(dataObj, nil);
  } failure:^(NSError *error) {
      responseDataBlock(nil, error);
  }];
}
</code></pre>

<p>ï¼ˆå…³é”®ï¼‰ä¸‹é¢è¿™ä¸ªæ–¹æ³•æä¾›ç»™ç»§æ‰¿XLDataServiceçš„å­ç±»é‡å†™ï¼Œå°†è½¬åŒ–ä¸ºæ¨¡å‹çš„ä»£ç å†™åœ¨è¿™é‡Œï¼Œç›¸ä¼¼ä¸šåŠ¡çš„ç½‘ç»œæ•°æ®è¯·æ±‚éƒ½å¯ä»¥ç”¨è¿™ä¸ªå­ç±»å»è¯·æ±‚æ•°æ®ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„æ¨¡å‹æ•°ç»„ã€‚
    /<em>*
    æ•°ç»„ã€å­—å…¸è½¬åŒ–ä¸ºæ¨¡å‹
    </em>/
    + (id)modelTransformationWithResponseObj:(id)responseObj modelClass:(Class)modelClass {
         return nil;
    }
å…³äºç¦»çº¿æ•°æ®ç¼“å­˜</p>

<p>å½“ç”¨æˆ·è¿›å…¥ç¨‹åºçš„å±•ç¤ºé¡µé¢ï¼Œæœ‰ä¸‰ä¸ªæƒ…å†µä¸‹å¯èƒ½æ¶‰åŠåˆ°æ•°æ®åº“å­˜å–æ“ä½œï¼Œç®€å•ç”»äº†ä¸ªå›¾æ¥ç†è§£ï¼Œæ€è·¯æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ä¸€äº›å­˜å–çš„ç»†èŠ‚å¤„ç†ã€‚</p>

<p>è¿›å…¥å±•ç¤ºé¡µé¢</p>

<p><img src="/images/net001.png" title="Caption" ></p>

<p>ä¸‹æ‹‰åˆ·æ–°æœ€æ–°æ•°æ®</p>

<p><img src="/images/net002.png" title="Caption" ></p>

<p>ä¸Šæ‹‰åŠ è½½æ›´å¤šæ•°æ®</p>

<p><img src="/images/net003.png" title="Caption" ></p>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šæ‹‰åŠ è½½æ›´å¤šçš„æ—¶å€™ï¼Œæ¯æ¬¡ä»æ•°æ®åº“è¿”å›ä¸€å®šæ•°é‡çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§å°†æ•°æ®å…¨éƒ¨åŠ è½½ï¼Œå¦åˆ™ä¼šæœ‰å†…å­˜é—®é¢˜ï¼Œç›´åˆ°æ•°æ®åº“ä¸­æ²¡æœ‰æ›´å¤šæ•°æ®æ—¶å†å‘ç”Ÿç½‘ç»œè¯·æ±‚ï¼Œå†æ¬¡å°†æ–°æ•°æ®å­˜å…¥æ•°æ®åº“ã€‚è¿™é‡Œå­˜å‚¨æ•°æ®çš„æ–¹å¼æ˜¯å°†æœåŠ¡å™¨è¿”å›æ¯ç»„æ•°æ®çš„å­—å…¸å½’æ¡£æˆäºŒè¿›åˆ¶ä½œä¸ºæ•°æ®åº“å­—æ®µç›´æ¥å­˜å‚¨ï¼Œè¿™æ ·å­˜å‚¨åœ¨æ¨¡å‹å±æ€§æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹æ›´æœ‰å¥½å¤„ï¼Œé¿å…æ¯ä¸€ä¸ªå±æ€§ä½œä¸ºä¸€ä¸ªå­—æ®µï¼Œå¦å¤–å¢åŠ äº†ä¸€ä¸ªidStrå­—æ®µç”¨æ¥åˆ¤æ–­æ•°æ®çš„å”¯ä¸€æ€§ï¼Œé¿å…é‡å¤å­˜å‚¨ã€‚
é¦–å…ˆå®šä¹‰ä¸€ä¸ªå·¥å…·ç±»XLDataBaseæ¥åšæ•°æ®åº“ç›¸å…³çš„æ“ä½œï¼Œè¿™é‡Œç”¨çš„æ˜¯ç¬¬ä¸‰æ–¹çš„FMDBã€‚</p>

<pre><code>#import "XLDataBase.h"
#import "FMDatabase.h"
#import "Item.h"
#import "MJExtension.h"
@implementation XLDataBase
static FMDatabase *_db;
+ (void)initialize {
    NSString *path = [NSString stringWithFormat:@"%@/Library/Caches/Data.db",NSHomeDirectory()];
    _db = [FMDatabase databaseWithPath:path];
    [_db open];
    [_db executeUpdate:@"CREATE TABLE IF NOT EXISTS t_item (id integer PRIMARY KEY, itemDict blob NOT NULL, idStr text NOT NULL)"];
}
//å­˜å…¥æ•°æ®åº“
+ (void)saveItemDict:(NSDictionary *)itemDict {
    //æ­¤å¤„æŠŠå­—å…¸å½’æ¡£æˆäºŒè¿›åˆ¶æ•°æ®ç›´æ¥å­˜å…¥æ•°æ®åº“ï¼Œé¿å…æ·»åŠ è¿‡å¤šçš„æ•°æ®åº“å­—æ®µ
    NSData *dictData = [NSKeyedArchiver archivedDataWithRootObject:itemDict];
    [_db executeUpdateWithFormat:@"INSERT INTO t_item (itemDict, idStr) VALUES (%@, %@)",dictData, itemDict[@"id"]];
}
//è¿”å›å…¨éƒ¨æ•°æ®
+ (NSArray *)list {
    FMResultSet *set = [_db executeQuery:@"SELECT * FROM t_item"];
    NSMutableArray *list = [NSMutableArray array];
    while (set.next) {
        // è·å¾—å½“å‰æ‰€æŒ‡å‘çš„æ•°æ®
        NSData *dictData = [set objectForColumnName:@"itemDict"];
        NSDictionary *dict = [NSKeyedUnarchiver unarchiveObjectWithData:dictData];
        [list addObject:[Item mj_objectWithKeyValues:dict]];
    }
    return list;
}
//å–å‡ºæŸä¸ªèŒƒå›´å†…çš„æ•°æ®
+ (NSArray *)listWithRange:(NSRange)range {
    NSString *SQL = [NSString stringWithFormat:@"SELECT * FROM t_item LIMIT %lu, %lu",range.location, range.length];
    FMResultSet *set = [_db executeQuery:SQL];
    NSMutableArray *list = [NSMutableArray array];
    while (set.next) {
        NSData *dictData = [set objectForColumnName:@"itemDict"];
        NSDictionary *dict = [NSKeyedUnarchiver unarchiveObjectWithData:dictData];
        [list addObject:[Item mj_objectWithKeyValues:dict]];
    }
    return list;
}
//é€šè¿‡ä¸€ç»„æ•°æ®çš„å”¯ä¸€æ ‡è¯†åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨
+ (BOOL)isExistWithId:(NSString *)idStr
{
    BOOL isExist = NO;
    FMResultSet *resultSet= [_db executeQuery:@"SELECT * FROM t_item where idStr = ?",idStr];
    while ([resultSet next]) {
        if([resultSet stringForColumn:@"idStr"]) {
            isExist = YES;
        }else{
            isExist = NO;
        }
    }
    return isExist;
}
@end
</code></pre>

<p>ä¸€äº›ç»§æ‰¿äºXLDataServiceçš„å­ç±»çš„æ•°æ®åº“å­˜å‚¨å’Œæ¨¡å‹è½¬æ¢çš„é€»è¾‘ä»£ç </p>

<pre><code>#import "GetTableViewData.h"
#import "XLDataBase.h"
@implementation GetTableViewData
//é‡å†™çˆ¶ç±»æ–¹æ³•
+ (id)modelTransformationWithResponseObj:(id)responseObj modelClass:(Class)modelClass {
    NSArray *lists = responseObj[@"data"][@"list"];
    NSMutableArray *array = [NSMutableArray array];
    for (NSDictionary *dict in lists) {
        [modelClass mj_setupReplacedKeyFromPropertyName:^NSDictionary *{
            return @{ @"ID" : @"id" };
        }];
        [array addObject:[modelClass mj_objectWithKeyValues:dict]];
        //é€šè¿‡idStrå…ˆåˆ¤æ–­æ•°æ®æ˜¯å¦å­˜å‚¨è¿‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œç½‘ç»œè¯·æ±‚æ–°æ•°æ®å­˜å…¥æ•°æ®åº“
        if (![XLDataBase isExistWithId:dict[@"id"]]) {
            //å­˜æ•°æ®åº“
            NSLog(@"å­˜å…¥æ•°æ®åº“");
            [XLDataBase saveItemDict:dict];
        }
    }
    return array;
}
</code></pre>

<p>ä¸‹é¢æ˜¯ä¸€äº›æ§åˆ¶å™¨çš„ä»£ç å®ç°ï¼š</p>

<pre><code>#import "ViewController.h"
#import "GetTableViewData.h"
#import "Item.h"
#import "XLDataBase.h"
#import "ItemCell.h"
#import "MJRefresh.h"
#define URL_TABLEVIEW @"https://api.108tian.com/mobile/v3/EventList?cityId=1&amp;step=10&amp;theme=0&amp;page=%lu"
@interface ViewController () {
    NSMutableArray *_dataArray;
    UITableView *_tableView;
    NSInteger _currentPage;//å½“å‰æ•°æ®å¯¹åº”çš„page
}
@end
@implementation ViewController
#pragma mark Life cycle
- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self createTableView];
    _dataArray = [NSMutableArray array];
}
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    NSRange range = NSMakeRange(0, 10);
    //å¦‚æœæ•°æ®åº“æœ‰æ•°æ®åˆ™è¯»å–ï¼Œä¸å‘é€ç½‘ç»œè¯·æ±‚
    if ([[XLDataBase listWithRange:range] count]) {
        [_dataArray addObjectsFromArray:[XLDataBase listWithRange:range]];
        NSLog(@"ä»æ•°æ®åº“åŠ è½½");
    }else{
        [self getTableViewDataWithPage:0];
    }
}
#pragma mark UI
- (void)createTableView {
    _tableView = [[UITableView alloc] initWithFrame:self.view.bounds];
    _tableView.delegate = self;
    _tableView.dataSource = self;
    _tableView.rowHeight = 100.0;
    [self.view addSubview:_tableView];
    _tableView.mj_header = [MJRefreshNormalHeader headerWithRefreshingBlock:^{
        [self loadNewData];
    }];
    _tableView.mj_footer = [MJRefreshAutoNormalFooter footerWithRefreshingBlock:^{
        [self loadMoreData];
    }];
}
#pragma mark GetDataSoure
- (void)getTableViewDataWithPage:(NSInteger)page {
    NSLog(@"å‘é€ç½‘ç»œè¯·æ±‚ï¼");
    NSString *url = [NSString stringWithFormat:URL_TABLEVIEW, page];
    [GetTableViewData getWithUrl:url param:nil modelClass:[Item class] responseBlock:^(id dataObj, NSError *error) {
        [_dataArray addObjectsFromArray:dataObj];
        [_tableView reloadData];
        [_tableView.mj_header endRefreshing];
        [_tableView.mj_footer endRefreshing];
    }];
}
- (void)loadNewData {
    NSLog(@"ä¸‹æ‹‰åˆ·æ–°");
    _currentPage = 0;
    [_dataArray removeAllObjects];
    [self getTableViewDataWithPage:_currentPage];
}
- (void)loadMoreData {
    NSLog(@"ä¸Šæ‹‰åŠ è½½");
    _currentPage ++;
    NSRange range = NSMakeRange(_currentPage * 10, 10);
    if ([[XLDataBase listWithRange:range] count]) {
        [_dataArray addObjectsFromArray:[XLDataBase listWithRange:range]];
        [_tableView reloadData];
        [_tableView.mj_footer endRefreshing];
        NSLog(@"æ•°æ®åº“åŠ è½½%luæ¡æ›´å¤šæ•°æ®",[[XLDataBase listWithRange:range] count]);
    }else{
        //æ•°æ®åº“æ²¡æ›´å¤šæ•°æ®æ—¶å†ç½‘ç»œè¯·æ±‚
        [self getTableViewDataWithPage:_currentPage];
    }
}
#pragma mark UITableViewDataSource
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return _dataArray.count;
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    ItemCell *cell = [ItemCell itemCellWithTableView:tableView];
    cell.item = _dataArray[indexPath.row];
    return cell;
}
@end
</code></pre>

<p>æœ€åé™„ä¸Šä»£ç çš„ä¸‹è½½åœ°å€ï¼Œé‡è¦çš„éƒ¨åˆ†ä»£ç ä¸­éƒ½æœ‰ç›¸åº”çš„æ³¨é‡Šå’Œæ–‡å­—æ‰“å°ï¼Œè¿è¡Œç¨‹åºå¯ä»¥å¾ˆç›´è§‚çš„è¡¨ç°ã€‚</p>

<p><a href="https://github.com/ShelinShelin/OffLineCache.git">Demo</a></p>

<p>å¸Œæœ›å¤§å®¶èƒ½æå‡ºä¸€äº›æ„è§ï¼Œå¾ˆä¹æ„ä¸å¤§å®¶äº’ç›¸äº¤æµã€‚</p>

<!--more-->

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ScrollViewå›åˆ°é¡¶éƒ¨å¤åŸ]]></title>
    <link href="http://al1020119.github.io/blog/2015/08/21/scrollviewhui-dao-ding-bu-fu-yuan/"/>
    <updated>2015-08-21T02:33:00+08:00</updated>
    <id>http://al1020119.github.io/blog/2015/08/21/scrollviewhui-dao-ding-bu-fu-yuan</id>
    <content type="html"><![CDATA[<p>ç›¸ä¿¡ç»†å¿ƒçš„å¼€å‘è€…éƒ½ä¼šå‘ç°scrollViewè‡ªå¸¦ä¸€ä¸ªåŠŸèƒ½,å½“ç”¨æˆ·ç‚¹å‡»é¡¶éƒ¨çš„çŠ¶æ€æ æ—¶,scrollViewçš„ContentOffset.yè½´ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ°åˆå§‹ä½ç½®,æ•ˆæœå¦‚å›¾æ‰€ç¤º:</p>

<!--more-->


<blockquote><p>å•ä¸ªscrollViewå•å‡»é¡¶éƒ¨çŠ¶æ€æ ç³»ç»Ÿè‡ªå¸¦åŠŸèƒ½å±•ç¤º</p></blockquote>

<p>è¿™ä¸ªåŠŸèƒ½å¯¹ç”¨æˆ·æ¥è¯´éå¸¸å®ç”¨,å°¤å…¶æ˜¯åœ¨scrollView(TableView, WebView, CollectionViewä¸€åˆ‡ç»§æ‰¿scrollViewçš„æ§ä»¶)å±•ç¤ºçš„å†…å®¹å¾ˆå¤š,å½“ç”¨æˆ·ç¿»çœ‹å¾ˆä¹…ä»¥å,æƒ³å›åˆ°æœ€é¡¶éƒ¨æ—¶,åªéœ€å•å‡»ä¸€ä¸‹é¡¶éƒ¨çš„çŠ¶æ€æ ä½ç½®å°±å¯ä»¥è½»æ¾è¿”å›åˆ°é¡¶éƒ¨(è¿™é‡Œåæ§½ä¸‹.è²Œä¼¼å¾ˆå¤šç”¨æˆ·éƒ½ä¸çŸ¥é“æœ‰è¿™ä¸ªåŠŸèƒ½),è€Œä¸ç”¨ä½¿åŠ²ç”¨æ‰‹æ»‘åŠ¨åˆ°é¡¶éƒ¨.</p>

<ul>
<li>å¯æ˜¯åŠŸèƒ½åœ¨å½“å‰æ§åˆ¶å™¨æœ‰å¤šä¸ªscrollView(TableView, WebView, CollectionViewä¸€åˆ‡ç»§æ‰¿scrollViewçš„æ§ä»¶)çš„æ—¶å€™å°±ä¼šå¤±æ•ˆ,æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:</li>
</ul>


<p>å½“æ§åˆ¶å™¨å†…æœ‰å¤šä¸ªscrollViewæ—¶,ç³»ç»Ÿè‡ªå¸¦çš„æ»šåŠ¨åˆ°é¡¶çš„åŠŸèƒ½å°±ä¼šå¤±æ•ˆ</p>

<p>å®é™…å¼€å‘ä¸­,æˆ‘ä»¬çš„äº§å“åœ¨åŒä¸€ä¸ªæ§åˆ¶å™¨ç»å¸¸ä¼šæœ‰å¤šä¸ªscrollViewç»„åˆåœ¨ä¸€èµ·çš„æƒ…å†µ,è¿™å°±æ„å‘³ç€ç³»ç»Ÿçš„æ–¹æ³•å·²ç»å¤±æ•ˆäº†,éœ€è¦å¼€å‘äººå‘˜è‡ªå·±æ¥å®ç°è¿™ä¸ªæ•ˆæœ,ä¸‹é¢æˆ‘ä»¬å°±æ¥æå®šè¿™ä¸ªéœ€æ±‚</p>

<blockquote><p>æˆ‘ä»¬åˆ†æä¸‹åŸç”Ÿçš„æ–¹æ³•ä¸ºä»€ä¹ˆä¼šå¤±æ•ˆ,å½“ä¸€ä¸ªæ§åˆ¶å™¨å†…åªæœ‰ä¸€ä¸ªscrollViewæ—¶,ç‚¹å‡»çŠ¶æ€æ ,ç³»ç»Ÿä¼šéå†å½“å‰keyWindowçš„å­æ§ä»¶,å‘ç°å­æ§ä»¶ä¸­åªæœ‰ä¸€ä¸ªscrollViewä¼šè°ƒç”¨è¿™ä¸ªscrollViewçš„setContentOffset: animated:çš„è¿™ä¸ªæ–¹æ³•,å°†scrollViewçš„contentOffset.yå€¼ä¿®æ”¹ä¸ºåˆå§‹å€¼,ä½†æ˜¯å½“å­æ§ä»¶ä¸­åˆå¤šä¸ªscrollViewæ—¶,ç³»ç»Ÿä¼šä¸çŸ¥é“æ‰ç”¨å“ªä¸€ä¸ªscrollViewè€Œå¤±æ•ˆ,çŸ¥é“è¿™ç‚¹æˆ‘ä»¬å°±çŸ¥é“è¯¥å¦‚ä½•æå®šè¿™ä¸ªé—®é¢˜äº†</p></blockquote>

<p>è¿™é‡Œå°±ç›´æ¥å°†è§£å†³æ€è·¯ä¸€ä¸€å†™å‡ºæ¥ä¸å°†ä»£ç åˆ†æ®µå±•ç¤ºäº†,åœ¨ä»£ç ä¸­æˆ‘åŠ äº†è¯¦ç»†çš„æ³¨é‡Šobjective-cçš„å¥—è·¯å’ŒswiftåŸºæœ¬ä¸€æ ·,åœ¨æœ€åä¼šå°†Swiftå’Œobjective-cçš„ä»£ç ä¸€èµ·æ”¾ä¸Š,å¦‚æœéœ€è¦ç›´æ¥è§£å†³é—®é¢˜çš„ç«¥é‹å¯ä»¥ç›´æ¥å°†ä»£ç æ‹·è´åˆ°å·¥ç¨‹é‡Œå³å¯</p>

<ul>
<li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªtopWindowç»§æ‰¿è‡³NSObject,è¿™é‡Œæˆ‘ä»¬è€ƒè™‘å°†è¿™ä¸ªåŠŸèƒ½å®Œå…¨å°è£…èµ·æ¥,æ‰€ä»¥æ‰€æœ‰çš„æ–¹æ³•éƒ½ç”¨çš„ç±»æ–¹æ³•,æ‰€ä»¥ç”¨æœ€åŸºæœ¬çš„ç±»å°±å¯ä»¥</li>
<li>åœ¨initializeæ–¹æ³•ä¸­åˆå§‹åŒ–topWIndow,å°†topWIndowçš„çº§åˆ«æ”¹æˆæœ€é«˜çš„UIWindowLevelAlertçº§åˆ«,è®¾ç½®topWindowä½ç½®,å¹¶ä¸”æ·»åŠ ç‚¹å‡»æ‰‹åŠ¿</li>
<li>åœ¨topWIndowè¢«ç‚¹å‡»è°ƒç”¨çš„æ–¹æ³•ä¸­,æˆ‘ä»¬æ‹¿å‡ºUIApplicationçš„keyWindow,éå†keyWindowçš„æ‰€æœ‰å­æ§ä»¶,å¦‚æœæ»¡è¶³æ˜¯scrollViewåŒæ—¶åˆæ˜¾ç¤ºåœ¨å½“å‰keyWindowæ¡ä»¶æ—¶,å°†subViewçš„contentOffsetçš„yå€¼å›å¤åˆ°åŸå§‹</li>
<li>ç„¶åé‡‡ç”¨é€’å½’çš„å¥—è·¯åœ¨éå†subViewå†…æ—¶å€™æœ‰æ»¡è¶³æ¡ä»¶çš„å­æ§ä»¶,ç›´åˆ°æ²¡æœ‰æ»¡è¶³æ¡ä»¶æ—¶ä¼šåœæ­¢</li>
</ul>


<h4>Swiftçš„ä»£ç </h4>

<pre><code>import UIKit
class TopWindow: UIWindow {
    private static let window_: UIWindow = UIWindow()
    ///  ç±»åˆå§‹åŒ–æ–¹æ³•,ä¿è¯window_åªè¢«åˆ›å»ºä¸€æ¬¡
    override class func initialize() {
        window_.frame = CGRectMake(0, 0, global.appWidth, 20)
        window_.windowLevel = UIWindowLevelAlert
        window_.addGestureRecognizer(UITapGestureRecognizer(target: self, action: "topWindowClick"))
    }
    class func topWindowClick() {
        // éå†å½“å‰ä¸»çª—å£æ‰€æœ‰view,å°†æ»¡è¶³æ¡ä»¶çš„scrollViewæ»šåŠ¨å›åŸä½
        searchAllowScrollViewInView(UIApplication.sharedApplication().keyWindow!)
    }
    private class func searchAllowScrollViewInView(superView: UIView) {
        for subview: UIView in superView.subviews as! [UIView] {
            if subview.isKindOfClass(UIScrollView.self) &amp;&amp; superView.viewIsInKeyWindow() {
                // æ‹¿åˆ°scrollViewçš„contentOffset
                var offest = (subview as! UIScrollView).contentOffset
                // å°†offestçš„yè½´è¿˜åŸæˆæœ€å¼€å§‹çš„å€¼
                offest.y = -(subview as! UIScrollView).contentInset.top
                // é‡æ–°è®¾ç½®scrollViewçš„å†…å®¹
                (subview as! UIScrollView).setContentOffset(offest, animated: true)
            }
            // é€’å½’,è®©å­æ§ä»¶å†æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­æ—¶å€™è¿˜æœ‰æ»¡è¶³æ¡ä»¶çš„view
            searchAllowScrollViewInView(subview)
        }
    }
    ///  æ·»åŠ topWindow,ä½¿æ‰‹åŠ¿ç”Ÿæ•ˆ
    class func showTopWindow() {
        window_.hidden = false
    }
    ///  éšè—topWindow,ç§»é™¤æ‰‹åŠ¿
    class func hiddenTopWindow() {
        window_.hidden = true
    }
}
///  å¯¹UIViewçš„ä¸€ä¸ªæ‰©å±•
extension UIView {
    ///  åˆ¤æ–­è°ƒç”¨æ–¹æ³•çš„viewæ˜¯å¦åœ¨keyWindowä¸­
    func viewIsInKeyWindow() -&gt; Bool {
        let keyWindow = UIApplication.sharedApplication().keyWindow!
        // å°†å½“å‰viewçš„åæ ‡ç³»è½¬æ¢åˆ°window.bounds
        let viewNewFrame = keyWindow.convertRect(self.frame, fromView: self.superview)
        let keyWindowBounds = keyWindow.bounds
        // åˆ¤æ–­å½“å‰viewæ˜¯å¦åœ¨keyWindowçš„èŒƒå›´å†…
        let isIntersects = CGRectIntersectsRect(viewNewFrame, keyWindowBounds)
        // åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ‰€æœ‰æ¡ä»¶
        return !self.hidden &amp;&amp; self.alpha &gt; 0.01 &amp;&amp; self.window == keyWindow &amp;&amp; isIntersects
    }   
}
</code></pre>

<p>åœ¨AppDelegateé‡Œ,ç¨‹åºå¯åŠ¨å®Œæˆæ–¹æ³•æ—¶æ·»åŠ å°±OKäº†</p>

<pre><code>  func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -&gt; Bool {
      // æ·»åŠ é¡¶éƒ¨çš„window
      TopWindow.showTopWindow()
      return true
  }
</code></pre>

<p>éœ€è¦æ³¨æ„æ·»åŠ äº†è‡ªå®šä¹‰çš„windowå,æ§åˆ¶å™¨çš„æ”¹å˜çŠ¶æ€æ çŠ¶æ€æ–¹æ³•ä¼šå¤±æ•ˆ,å¯ä»¥åœ¨info.plistä¸­å°†æ”¹å˜çŠ¶æ€æ çš„ç®¡ç†æƒäº¤ç»™UIApplicationè§£å†³,æˆ–è€…åœ¨éœ€è¦æ”¹å˜çŠ¶æ€æ çš„æ§åˆ¶å™¨ä¸­è°ƒç”¨TopWindow.hiddenTopWindow()å³å¯,æˆ–è€…ç›´æ¥æ”¹info.plist,ç”¨UIApplication.sharedApplication().setStatusBarStyleæ¥ç®¡ç†</p>

<h4>Objective-Cä»£ç </h4>

<p>.hæ–‡ä»¶åªæš´éœ²æ˜¾ç¤ºå’Œéšè—æ–¹æ³•</p>

<pre><code>#import @interface WNXTopWindow : NSObject
+ (void)show;
+ (void)hide;
@end
</code></pre>

<p>.mæ–‡ä»¶</p>

<pre><code>#import "WNXTopWindow.h"
@implementation WNXTopWindow
static UIWindow *window_;
//åˆå§‹åŒ–window
+ (void)initialize {
  window_ = [[UIWindow alloc] init];
  window_.frame = CGRectMake(0, 0, [UIScreen mainScreen].bounds.size.width, 20);
  window_.windowLevel = UIWindowLevelAlert;
  [window_ addGestureRecognizer:[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(windowClick)]];
}  
+ (void)show {
  window_.hidden = NO;
}
+ (void)hide {
  window_.hidden = YES;
}
// ç›‘å¬çª—å£ç‚¹å‡»
+ (void)windowClick {
  UIWindow *window = [UIApplication sharedApplication].keyWindow;
  [self searchScrollViewInView:window];
}
+ (void)searchScrollViewInView:(UIView *)superview {
  for (UIScrollView *subview in superview.subviews) {
      // å¦‚æœæ˜¯scrollview, æ»šåŠ¨æœ€é¡¶éƒ¨
      if ([subview isKindOfClass:[UIScrollView class]] &amp;&amp; [subview isShowingOnKeyWindow]) {
          CGPoint offset = subview.contentOffset;
          offset.y = - subview.contentInset.top;
          [subview setContentOffset:offset animated:YES];
      }
      // é€’å½’ç»§ç»­æŸ¥æ‰¾å­æ§ä»¶
      [self searchScrollViewInView:subview];
  }
}
+ (BOOL)isShowingOnKeyWindow:(UIView *)view {
  // ä¸»çª—å£
  UIWindow *keyWindow = [UIApplication sharedApplication].keyWindow;
  // ä»¥ä¸»çª—å£å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹, è®¡ç®—selfçš„çŸ©å½¢æ¡†
  CGRect newFrame = [keyWindow convertRect:view.frame fromView:view.superview];
  CGRect winBounds = keyWindow.bounds;
  // ä¸»çª—å£çš„bounds å’Œ selfçš„çŸ©å½¢æ¡† æ˜¯å¦æœ‰é‡å 
  BOOL intersects = CGRectIntersectsRect(newFrame, winBounds);
  return !view.isHidden &amp;&amp; view.alpha &gt; 0.01 &amp;&amp; view.window == keyWindow &amp;&amp; intersects;
}
@end
</code></pre>

<p>åŒæ ·,ä¹Ÿæ˜¯åœ¨ç¨‹åºåˆå§‹åŒ–å®ŒæˆAppDelegateæ–‡ä»¶ä¸­æ˜¾ç¤ºtopWindow,æ•´ä¸ªå·¥ç¨‹è¿™ä¸ªé—®é¢˜å°±ç»Ÿç»Ÿè§£å†³äº†</p>

<pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
  // æ·»åŠ ä¸€ä¸ªwindow, ç‚¹å‡»è¿™ä¸ªwindow, å¯ä»¥è®©å±å¹•ä¸Šçš„scrollViewæ»šåˆ°æœ€é¡¶éƒ¨
  [WNXTopWindow show];
  return YES;
}
</code></pre>
]]></content>
  </entry>
  
</feed>
