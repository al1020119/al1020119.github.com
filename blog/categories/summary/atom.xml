<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Summary | iOSæ¢¦å·¥å‚]]></title>
  <link href="http://al1020119.github.io/blog/categories/summary/atom.xml" rel="self"/>
  <link href="http://al1020119.github.io/"/>
  <updated>2016-03-16T11:27:43+08:00</updated>
  <id>http://al1020119.github.io/</id>
  <author>
    <name><![CDATA[iCocos]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[å¾®ä¿¡æœºå™¨äºº]]></title>
    <link href="http://al1020119.github.io/blog/2016/04/20/weixinjiqiren/"/>
    <updated>2016-04-20T13:32:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/04/20/weixinjiqiren</id>
    <content type="html"><![CDATA[<p> åŸºäºiOSé€†å‘å·¥ç¨‹çš„å¾®ä¿¡æœºå™¨äºº</p>

<p>æœ¬æ–‡è½¬è‡ªçŒ«å¤´é¹°å›¢é˜Ÿ</p>

<p>æ¨èåº</p>

<blockquote><p>æœ¬æ–‡çš„ä½œè€…æ²™æ¢“ç¤¾å’Œå´èˆªå…±åŒç¼–å†™äº†ã€Š iOS åº”ç”¨é€†å‘å·¥ç¨‹ã€‹ï¼Œæ–‡ç« ä¸­ä»‹ç»çš„æ˜¯ä¸€äº›åŸºæœ¬çš„ iOS é¢†åŸŸçš„å®‰å…¨çŸ¥è¯†ï¼Œä½†æ˜¯ç”±äºæ™®åŠä¸å¤Ÿï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰è¢«äººä»¬é‡è§†ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½è®©å¤§å®¶é‡è§†åˆ° iOS çš„æºä»£ç å®‰å…¨é—®é¢˜ã€‚</p></blockquote>

<p>å¦å¤–é¢„å‘Šä¸€ä¸‹ï¼Œæˆ‘è®¤è¯†çš„ä¸€ä¸ªåšç§»åŠ¨å®‰å…¨çš„ç™½å¸½å­å³å°†å…¬å¼€ä¸€ä¸ªåœ¨éè¶Šç‹±æ‰‹æœºä¸Šé€šè¿‡ App ç»•è¿‡ sandbox çš„ iOS æ¼æ´è§†é¢‘ï¼Œå¹¶ä¸”è®¡åˆ’å‘å¸ƒä¸€ç³»åˆ— iOS ç³»ç»Ÿå®‰å…¨æ–¹é¢çš„æ–‡ç« ã€‚æˆ‘äº‰å–åˆ°äº†æˆæƒï¼Œå¹¶åœ¨æˆ‘çš„å…¬ä¼—å·ä¸ŠåŒæ­¥å‘è¡¨è¿™äº›æ–‡ç« ï¼Œæ•¬è¯·æœŸå¾…ï¼šï¼‰</p>

<p>ä»¥ä¸‹æ˜¯æ–‡ç« æ­£æ–‡ï¼Œç•¥æœ‰è°ƒæ•´ã€‚</p>

<p>è®²å¸ˆä»‹ç»-æ²™æ¢“ç¤¾</p>

<ul>
<li>æ¹–åŒ—æ­¦æ±‰äººï¼Œã€ŠiOS åº”ç”¨é€†å‘å·¥ç¨‹ã€‹ç³»åˆ—å›¾ä¹¦çš„ä½œè€…ï¼Œåœ¨ Cydiaï¼ˆæœ€å¤§çš„è¶Šç‹± iOS å•†åº—ï¼‰ä¸Šæœ‰ 11 æ¬¾ç‹¬ç«‹ä½œå“ï¼Œæ¥å—è¿‡ CSDN çš„ä¸“è®¿ï¼Œä¹¦çš„è‹±æ–‡ç‰ˆåœ¨ GitHub ä¸Šå¼€æºåæ”¶è·äº† 2600+ starsï¼Œæ˜¯é¦–ä½åœ¨ WWJC ä¸Šå‘è¡¨æ¼”è®²çš„ä¸­å›½äººï¼Œä»¥ã€Œæå‡ä¸­å›½ iOS å¼€å‘è€…åœ¨å›½é™…ä¸Šçš„åœ°ä½ã€ä¸ºå·±ä»»ã€‚</li>
</ul>


<p>åœ¨å¾ˆå¤šæœ‹å‹çš„çœ¼é‡Œï¼ŒiOS é€†å‘å·¥ç¨‹æ˜¯ä¸€ä¸ªå°ä¼—ã€ç¥ç§˜çš„æ–¹å‘ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¼šé€‰æ‹©è¿™ä¸ªå°ä¼—çš„æ–¹å‘å‘¢ï¼Ÿè¿™è¦ä»æˆ‘æœ€å–œæ¬¢çš„ä¸€é¦–è¯—è¯´èµ·ã€‚ç¬¬ä¸€æ¬¡ï¼Œæˆ‘æ˜¯åœ¨æå¼€å¤çš„è‡ªä¼ ã€Šä¸–ç•Œå› ä½ ä¸åŒã€‹é‡Œçœ‹åˆ°è¿™é¦–è¯—ï¼Œå½“æ—¶å°±æ„Ÿè§‰èº«å¿ƒå¾—åˆ°äº†éå¸¸å¼ºçƒˆçš„éœ‡æ’¼ï¼š</p>

<p><img src="/images/nixiangjiqiren001.jpg" title="Caption" ></p>

<p>å› ä¸ºæˆ‘æ„Ÿè§‰åˆ°è‡ªå·±å°±æ˜¯è¿™ç±»äººï¼šå¦‚æœæœ‰ä¸¤æ¡è·¯ç»™æˆ‘é€‰ï¼Œæˆ‘ç¡®å®ä¼šé€‰æ›´å°‘äººèµ°çš„é‚£ä¸€æ¡ã€‚æˆ‘å‘ç°è‡ªå·±æ˜¯ä¸€ä¸ªåˆ»æ„ä¿æŒè‡ªå·±è·Ÿåˆ«äººä¸åŒçš„äººã€‚</p>

<p>åœ¨åˆæ¬¡è¯»åˆ°è¿™é¦–è¯—æ—¶ï¼Œæˆ‘è¿˜æ²¡æœ‰å¼€å§‹å­¦ä¹  iOSã€‚åœ¨ä»äº‹ iOS æ–¹é¢çš„ç ”ç©¶åï¼Œåˆä»ä¹”å¸®ä¸»äº²è‡ªé…éŸ³çš„å¹¿å‘Šä¸­å¯»æ‰¾åˆ°äº†çµæ„Ÿï¼Œå‘ç°è‹¹æœè·Ÿæˆ‘çš„ä»·å€¼è§‚éå¸¸ä¸€è‡´ï¼Œå°±æ˜¯è¦è¿½æ±‚ä¸åŒã€‚å› æ­¤ï¼Œæˆ‘æ›´åŠ è®¤å®š iOS å°±æ˜¯æˆ‘çš„ä¸»æ”»æ–¹å‘ã€‚</p>

<p><img src="/images/nixiangjiqiren002.jpg" title="Caption" ></p>

<p>æˆ‘çš„æˆé•¿ä¹‹è·¯ï¼Œå°±æ˜¯ä¸€æ¡ä¸ä¼—ä¸åŒçš„æœªé€‰ä¹‹è·¯ï¼šåˆ«äººéƒ½åœ¨å­¦ã€Œå¤§ä¼—æƒ…äººã€Windows æ—¶ï¼Œæˆ‘å¼€å§‹å­¦ã€Œå°ä¼—è·¯äººã€iOSï¼›åˆ«äººéƒ½åœ¨å­¦ iOS æ­£å‘å¼€å‘æ—¶ï¼Œæˆ‘å¼€å§‹å­¦ iOS é€†å‘å·¥ç¨‹ã€‚æ­£æ˜¯å› ä¸ºè¿½æ±‚ä¸åŒï¼Œæˆ‘å†™çš„ã€ŠiOS åº”ç”¨é€†å‘å·¥ç¨‹ã€‹æˆä¸ºäº†å…¨çƒå”¯ä¸€ä¸€æœ¬ iOS é€†å‘ç›¸å…³ä¹¦ç±ï¼Œè€Œä¸”æœ‰ç¾å›½å’ŒéŸ©å›½çš„å‡ºç‰ˆç¤¾æƒ³è¦å¼•è¿›æœ¬ä¹¦ï¼Œæ‰“ç ´äº†ä¸­å›½ iOS çŸ¥è¯†äº§æƒé›¶è¾“å‡ºçš„å°´å°¬çºªå½•ã€‚æˆ‘ç”¨è‡ªå·±çš„åŠªåŠ›ä»£è¡¨ä¸­å›½ iOS å¼€å‘è€…åœ¨å›½é™…ä¸Šå‘å£°ï¼Œè€Œä¸”ä¸º iOS ä¸»æµç¤¾åŒºæ‰€è®¤å¯ï¼Œä½œä¸ºä¸­å›½äººæˆ‘æ„Ÿåˆ°éå¸¸è‡ªè±ªã€‚</p>

<p>ç®€å•æ¥è¯´ï¼Œæˆ‘æ‰€ç ”ç©¶çš„ï¼Œä¸»è¦æ˜¯ iOS åº”ç”¨å±‚çš„é€†å‘å·¥ç¨‹ï¼Œå¯¹å†…æ ¸å±‚çš„é€†å‘å·¥ç¨‹åªæ˜¯ç¨æœ‰æ¶‰çŒï¼Œæ²¡æœ‰å…¥é—¨ã€‚åº”ç”¨å±‚çš„é€†å‘å·¥ç¨‹ï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±ç©å¾—å·®ä¸å¤šäº†ï¼Œåº”ç”¨å±‚çš„æ‰€æœ‰é€†å‘å·¥ç¨‹ç›¸å…³é—®é¢˜ï¼Œéƒ½å¯ä»¥ç”¨æˆ‘é‚£æœ¬ä¹¦ä¸Šä»‹ç»è¿‡çš„çŸ¥è¯†å’ŒæŠ€æœ¯å¾—åˆ°è§£å†³ï¼Œæˆ‘è§‰å¾—æ²¡æœ‰å¤ªå¤§æŒ‘æˆ˜æ€§äº†ï¼Œä¸»è¦æ˜¯åŠ³åŠ¨é‡é—®é¢˜ã€‚åˆ°äº†è¿™ä¸ªåœ°æ­¥ï¼Œæˆ‘çš„è§„åˆ’ä¸»è¦åˆ†ä¸º 2 ä¸ªæ–¹å‘ï¼š</p>

<p>ç»§ç»­ä»äº‹å†…æ ¸ç ”ç©¶ï¼Œè¿™ä¸ªæ–¹å‘çš„ç»ˆç‚¹æ˜¯ã€Œè¶Šç‹±ã€ï¼ˆè¶Šç‹±å³é€šè¿‡æ¼æ´åˆ©ç”¨æ‹¿åˆ°iOSçš„rootæƒé™ï¼Œä»£è¡¨äº†iOSæŠ€æœ¯ç ”ç©¶çš„æœ€é«˜å¢ƒç•Œï¼‰ï¼›</p>

<p>æ¢ä¸ªè„‘å­ï¼Œç”¨ä¸€äº›éæŠ€æœ¯èƒ½åŠ›æ­¦è£…è‡ªå·±ï¼Œè®©è‡ªå·±æˆä¸ºä¸€ä¸“å¤šèƒ½çš„äººæ‰ã€‚è¿™ä¸ªæ–¹å‘çš„ç»ˆç‚¹å°±æ˜¯åˆ›ä¸šã€‚</p>

<p>å½“ç„¶ï¼Œå¾ˆå¤šæœ‹å‹ä¼šé—®ï¼ŒIT äººå‘˜åˆ›ä¸šçš„æ™®éåšæ³•ï¼Œéƒ½æ˜¯å» BAT è¿™æ ·çš„äº’è”ç½‘å…¬å¸å¹² 2 å¹´ï¼Œè§‚å¯Ÿä¸€ä¸‹ä»–ä»¬çš„ç©æ³•ï¼Œç„¶åæ‹‰ä¸€ä¸ªå›¢é˜Ÿå‡ºæ¥å¹²ã€‚ä½ é—®å•¥ä¸è¿™ä¹ˆå¹²å‘¢ï¼Ÿä¸»è¦æ˜¯ç¢°åˆ°äº†ä¸€ä¸ªå¾ˆå¥½çš„é¡¹ç›®ã€‚å¤§å…¬å¸ä¸€ç›´éƒ½åœ¨é‚£é‡Œï¼Œæƒ³ä»€ä¹ˆæ—¶å€™å»éƒ½å¯ä»¥ï¼›è€Œå¥½é¡¹ç›®å´ä¸å¸¸æœ‰ï¼Œæœºä¼šè¿‡å»å°±è¿‡å»äº†ï¼Œä¸ç­‰äººï¼Œæ‰€ä»¥æˆ‘åœ¨å‡†å¤‡å¹¶ä¸ç®—å……åˆ†çš„æƒ…å†µä¸‹é€‰æ‹©äº†åˆ›ä¸šè¿™æ¡è·¯ã€‚</p>

<p>äº¤ä»£å®Œäº†æˆ‘çš„èƒŒæ™¯ï¼Œå’±ä»¬å¯ä»¥è¿›å…¥æ­£é¢˜äº†ğŸ˜</p>

<p><img src="/images/nixiangjiqiren003.jpg" title="Caption" ></p>

<p>å¤§æ„æ˜¯ã€Œé€šè¿‡ç ”ç©¶ç°æœ‰åŠŸèƒ½çš„å®ç°åŸç†ï¼Œç†è§£å¹¶èä¼šè´¯é€šï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå®ç°ï¼ˆç”šè‡³å¢å¼ºï¼‰è¿™ä¸ªåŠŸèƒ½ã€‚ã€ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸æ˜¯ç…§çŒ«ç”»è™ï¼Œè€Œæ˜¯å¸ˆå¤·é•¿æŠ€ï¼Œã€Œå€Ÿåˆ€æ€äººã€ã€‚</p>

<p>åœ¨æˆ‘çš„ç†è§£é‡Œï¼Œé€†å‘å·¥ç¨‹æ˜¯ä¸€ç§å·¥ç¨‹å¸ˆå¼çš„é«˜çº§æ€ç»´æ–¹å¼ã€‚ç»™ä½ æ°´ã€é¢ç²‰ã€ç³–ã€èŠéº»ï¼Œè®©ä½ åšçƒ§é¥¼ï¼Œè¿™æ˜¯æ­£å‘å·¥ç¨‹ï¼›ç»™ä½ ä¸€ä¸ªçƒ§é¥¼ï¼Œè®©ä½ åˆ†æå‡ºå®ƒæ˜¯ç”±å¤šå°‘æ°´ã€å¤šå°‘é¢ç²‰ã€å¤šå°‘ç³–ã€å¤šå°‘èŠéº»ç»„æˆçš„ï¼Œè¿™æ˜¯é€†å‘å·¥ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¹æ®å›¾çº¸åˆ¶ä½œå®ç‰©çš„è¿™ä¸ªè¿‡ç¨‹æ˜¯æ­£å‘å·¥ç¨‹ï¼Œè€Œæ ¹æ®å®ç‰©å€’æ¨å›¾çº¸çš„è¿™ä¸ªè¿‡ç¨‹åˆ™æ˜¯é€†å‘å·¥ç¨‹ã€‚ä¹”å¸ƒæ–¯æ›¾è¯´ã€ŒGood artists copy; Great artists steal.ã€é€†å‘å·¥ç¨‹æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p>

<p>ä¸¾å‡ ä¸ªé€šè¿‡é€†å‘å·¥ç¨‹å¸ˆå¤·é•¿æŠ€çš„ä¾‹å­ï¼š</p>

<p><img src="/images/nixiangjiqiren004.jpg" title="Caption" ></p>

<p>é€šè¿‡é€†å‘å·¥ç¨‹åˆ†æinstagramæ»¤é•œç®—æ³•ã€‚ä¸€ä¸ªäººå¯ä»¥â€œstealâ€ä¸€ä¸ªæ»¤é•œç®—æ³•å›¢é˜Ÿçš„å·¥ä½œæˆæœï¼›</p>

<p>ç ”ç©¶å¾®ä¿¡çš„ç½‘ç»œä¼ è¾“åè®®ï¼Œå°±åƒ@58æ²ˆå‰‘ åœ¨åšå®¢é‡Œè¯´åˆ°çš„é‚£æ ·ã€‚å°±æˆ‘ç›®å‰å¯¹å¾®ä¿¡ä¹ç‰›ä¸€æ¯›çš„ç ”ç©¶æ¥è¯´ï¼Œå°±å·²ç»å‘ç°äº†ä¸€å¤„å¯ä»¥è¿›ä¸€æ­¥èŠ‚çœæµé‡çš„åœ°æ–¹ï¼Œä½†æ˜¯ä¼°è®¡æ˜¯å› ä¸ºå†å²é—ç•™é—®é¢˜ï¼Œè¿™å—ä»£ç ä¸å¥½åŠ¨ï¼›</p>

<p>çœ‹çœ‹1Passwordåšäº†å“ªäº›é˜²æŠ¤ã€‚1Passwordæ˜¯ä¸“é—¨ç”¨äºä¿å­˜å¯†ç çš„ï¼Œç±»ä¼¼äºä¿é™©æŸœï¼Œå®‰å…¨ç³»æ•°å¿…é¡»å¾ˆé«˜ï¼Œå®ƒæŠŠæˆ‘ä»¬çš„å¯†ç å­˜åœ¨äº†å“ªé‡Œï¼Œé€šè¿‡ä»€ä¹ˆæ–¹å¼åŠ å¯†ï¼Ÿè¿™äº›éƒ½æ˜¯å€¼å¾—æˆ‘ä»¬å­¦ä¹ å€Ÿé‰´çš„åœ°æ–¹ã€‚</p>

<p>é™¤äº†å»å­¦ä¹ åˆ«äººçš„é•¿å¤„ï¼Œé€†å‘å·¥ç¨‹è¿˜å¯ä»¥å‘ç°è‡ªå·±å’Œåˆ«äººçš„çŸ­å¤„ï¼š</p>

<p><img src="/images/nixiangjiqiren005.jpg" title="Caption" ></p>

<p>è¿™ç§ä½çº§é”™è¯¯ï¼Œæ˜Ÿå·´å…‹å¯ä»¥çŠ¯ï¼Œä½†1Passwordä¸èƒ½çŠ¯ï¼›è¿™å–å†³äºä½ çš„äº§å“å®šä½ã€‚è¿™ä¸ªé”™è¯¯å½“ç„¶æ˜¯é€šè¿‡é€†å‘å·¥ç¨‹å‘ç°çš„ã€‚</p>

<p>è¿™æ˜¯æŸä¸–ç•Œ500å¼ºä¼ä¸šçŠ¯çš„ï¼Œé€šè¿‡HTTPåè®®æ˜æ–‡ä¼ è¾“ç”¨æˆ·æ‰‹æœºå’Œå¯†ç çš„ä½çº§é”™è¯¯ï¼š</p>

<p><img src="/images/nixiangjiqiren006.jpg" title="Caption" ></p>

<p>è¿™æ˜¯æŸçªç ´3äº¿ç”¨æˆ·çš„ç§»åŠ¨Appï¼š</p>

<p><img src="/images/nixiangjiqiren007.jpg" title="Caption" ></p>

<p>æŠŠä¼ è¾“åè®®çš„å¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç é‡Œï¼Œæœ‰é€†å‘å·¥ç¨‹åŸºç¡€çš„æœ‹å‹å¯ä»¥è½»æ¾è¿˜åŸæ•´å¥—ç½‘ç»œä¼ è¾“åè®®ã€‚æ·˜å®ä¸Šä¸€å †å †çš„è¿™ä¸ªåˆ·æ¦œé‚£ä¸ªåˆ·èµï¼Œå°±æ˜¯è¿™ä¸ªåŸç†ã€‚</p>

<p>é˜¿å‡¹(çŒ«å‹ä¼šå‰ç¥¥ç‰©ï¼Œä¸€ä¸ªå¾®ä¿¡æœºå™¨äºº)ï¼Œæ˜¯ã€Œå€Ÿåˆ€æ€äººã€æœ€å…¸å‹çš„è¿ç”¨ä¹‹ä¸€ï¼š</p>

<p><img src="/images/nixiangjiqiren008.jpg" title="Caption" ></p>

<p>é˜¿å‡¹çš„å®ç°åŸç†ï¼Œç®€å•è¯´ï¼Œå°±æ˜¯é€šè¿‡é€†å‘å·¥ç¨‹çš„æ–¹å¼æ‰¾å‡ºå¾®ä¿¡iOSå®¢æˆ·ç«¯çš„æ”¶å‘ä¿¡æ¯ç­‰ç§æœ‰æ¥å£ï¼Œç„¶ååŸºäºè‡ªå·±çš„é€»è¾‘è°ƒç”¨è¿™äº›æ¥å£ï¼Œå®ç°é’ˆå¯¹ç‰¹æ®Šäº‹ä»¶çš„è‡ªåŠ¨åŒ–åº”ç­”åŠŸèƒ½ã€‚</p>

<p>æˆ‘ä¸ªäººæœ€å¸¸ç”¨çš„iOSé€†å‘å·¥ç¨‹å·¥å…·ä¸»è¦æœ‰è¿™äº›ï¼š</p>

<p><img src="/images/nixiangjiqiren009.jpg" title="Caption" ></p>

<ol>
<li><p>dumpdecryptedï¼šå°†è‹¹æœåŠ è¿‡å¯†çš„Appç ¸å£³ã€‚é€šè¿‡AppStoreå¤„ç†çš„Appï¼Œéƒ½æ˜¯åŠ è¿‡å¯†çš„ï¼Œä¸èƒ½ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶åˆ†æï¼Œéœ€è¦å…ˆè§£ç§˜ï¼Œä¸šç•Œç§°ä¸ºã€Œç ¸å£³ã€ã€‚å®ƒçš„åŸç†æ˜¯ç­‰Appå®Œå…¨åŠ è½½è¿›å†…å­˜ï¼Œå¾—åˆ°è§£å¯†åï¼Œå†æŠŠè§£å¯†è¿‡çš„å†…å­˜ç»™dumpå‡ºæ¥ï¼Œå½¢æˆè§£å¯†åçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥åˆ†æã€‚</p></li>
<li><p>class-dumpï¼šå¯¼å‡ºMachOæ–‡ä»¶é‡Œçš„ObjCç±»åŠæ–¹æ³•å®šä¹‰ã€‚å› ä¸ºObjCæ˜¯ä¸€é—¨å¼ºçƒˆä¾èµ–äºè¿è¡Œæ—¶çš„è¯­è¨€ï¼Œå®ƒçš„æ–‡ä»¶ç±»å‹æ˜¯MachOï¼ˆç±»æ¯”äºWindowsé‡Œçš„PEæ–‡ä»¶ç±»å‹ï¼‰ï¼ŒMachOé‡Œå­˜æ”¾äº†å¤§é‡è¿è¡Œæ—¶éœ€è¦ç”¨åˆ°çš„ä¿¡æ¯ï¼Œä»ä¸­å¯ä»¥æ”¶é›†æ•´ç†ï¼Œè¿˜åŸå‡ºä¸€ä¸ªAppæºä»£ç é‡Œçš„ObjCå¤´æ–‡ä»¶ã€‚</p></li>
<li><p>CydiaSubstrateï¼šå°†ç¬¬ä¸‰æ–¹åŠ¨æ€åº“æ³¨å…¥è¿›ç¨‹ã€‚å®ƒæ˜¯è¶Šç‹±æ’ä»¶çš„å­˜åœ¨å‰æã€‚åœ¨iOSå¼€æœºæ—¶ï¼Œä¼šæŠŠç‰¹å®šç›®å½•ä¸‹çš„æ‰€æœ‰åº“ï¼Œç»™åŠ è½½åˆ°æŒ‡å®šçš„è¿›ç¨‹é‡Œï¼Œä¿—ç§°ã€Œhookã€æˆ–ã€Œé’©å­ã€ã€‚</p></li>
<li><p>Cycriptï¼šç”¨JSè¯­æ³•å†™ObjCæ–¹æ³•ã€‚è¿™æ˜¯Cydiaä¹‹çˆ¶Saurikå‘æ˜çš„ä¸€é—¨è¯­è¨€ï¼Œæˆ‘ä¸ªäººä¸»è¦ç”¨å®ƒæ¥æµ‹è¯•ç§æœ‰å‡½æ•°ã€‚</p></li>
<li><p>Theosï¼šè¶Šç‹±æ’ä»¶å¼€å‘å·¥å…·ã€‚æ˜¯æˆ‘çš„ä¹¦åºä½œè€…DHowettå¼€å‘çš„ã€‚iOSæ­£å‘å¼€å‘ç”¨Xcodeï¼Œé€†å‘å¼€å‘ç”¨Theosã€‚</p></li>
<li><p>IDAï¼šå…¨å¹³å°åæ±‡ç¼–ã€åç¼–è¯‘å·¥å…·ã€‚ææŠ€æœ¯çš„ä¸€èˆ¬éƒ½å¬è¯´è¿‡è¿™ä¸ªè½¯ä»¶ï¼Œå°±ä¸å¤šä»‹ç»äº†ã€‚</p></li>
<li><p>Hopperï¼šOSXåæ±‡ç¼–ã€åç¼–è¯‘å·¥å…·ã€‚æ¯”IDAä¾¿å®œäº†1000å€ï¼Œä½†åŠŸèƒ½è·ŸIDAå·®ä¸å¤šï¼›ä¸»æ”»è‹¹æœç³»æ“ä½œç³»ç»Ÿã€‚</p></li>
<li><p>debugserver + LLDBï¼šåŠ¨æ€è°ƒè¯•å™¨ã€‚æ˜¯å¤§åé¼é¼çš„ã€Œè‹¹æœç‰ˆã€GDBã€‚</p></li>
</ol>


<p>class-dumpçš„æ•ˆæœï¼Œå›¾ä¸­æ˜¾ç¤ºçš„æ˜¯æ–°æµªå¾®åšAppçš„æ‰€æœ‰å¤´æ–‡ä»¶ï¼š</p>

<p><img src="/images/nixiangjiqiren010.jpg" title="Caption" ></p>

<p>Cycriptçš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°å¾®ä¿¡æ˜Ÿå·å¯†ç çš„æ˜æ–‡ï¼š</p>

<p><img src="/images/nixiangjiqiren011.jpg" title="Caption" ></p>

<p>Theoså¼€å‘æ’ä»¶çš„è¿è¡Œæ•ˆæœï¼š</p>

<p><img src="/images/nixiangjiqiren012.jpg" title="Caption" ></p>

<p>æ‰€æœ‰è¿›ç¨‹çš„[NSDictionary dictionaryWithContentsOfFile:]æ–¹æ³•å‡è¢«ã€Œhookã€ï¼Œå¯ä»¥éšæ„ç¯¡æ”¹ã€‚</p>

<p>IDAçš„æ•ˆæœï¼š</p>

<p><img src="/images/nixiangjiqiren013.jpg" title="Caption" ></p>

<p>å¯¹äºç†Ÿæ‚‰æ±‡ç¼–è¯­è¨€ï¼ˆå›¾é‡Œæ˜¯ARMæ±‡ç¼–ï¼‰çš„æœ‹å‹æ¥è¯´ï¼Œæ‰€æœ‰æœªåŠ å¯†çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå‡ç­‰åŒäºå¼€æºã€‚è¿™æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼ŒåšæŠ€æœ¯çš„éƒ½æ‡‚ã€‚</p>

<h6>æ¥ä¸‹æ¥æˆ‘ç®€å•ä»‹ç»ä¸‹é˜¿å‡¹çš„åˆ¶ä½œæµç¨‹ï¼š</h6>

<p>æ ¸å¿ƒåœ¨äºæ‰¾åˆ°æ”¶å‘å¾®ä¿¡æ¶ˆæ¯çš„å‡½æ•°ï¼Œç„¶ååŠ ä»¥ä¿®æ”¹åˆ©ç”¨ï¼š</p>

<p><img src="/images/nixiangjiqiren014.jpg" title="Caption" ></p>

<p>ç”¨dumpdecryptedç»™å¾®ä¿¡ç ¸å£³ï¼Œè§£å¯†å‡ºçš„æ–‡ä»¶è¿‘50Mï¼š</p>

<p><img src="/images/nixiangjiqiren015.jpg" title="Caption" ></p>

<p>class-dumpå‡ºå¾®ä¿¡çš„æ‰€æœ‰å¤´æ–‡ä»¶ï¼Œè¿‘7000ä¸ªï¼š</p>

<p><img src="/images/nixiangjiqiren016.jpg" title="Caption" ></p>

<ul>
<li><p>å®šä½åˆ°æ”¶æ¶ˆæ¯çš„Viewï¼Œè¿›è€Œå®šä½åˆ°Vå¯¹åº”çš„Cï¼Œæ‰¾å‡ºé€»è¾‘å±‚çš„æ”¶æ¶ˆæ¯å‡½æ•°ã€‚</p></li>
<li><p>å®šä½åˆ°å‘æ¶ˆæ¯çš„æŒ‰é’®ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªViewï¼‰ï¼Œè¿›è€Œå®šä½åˆ°å¯¹åº”çš„Cï¼Œæ‰¾å‡ºé€»è¾‘å±‚çš„å‘æ¶ˆæ¯å‡½æ•°ï¼ˆè¿™ä¸ªè¿‡ç¨‹æ²¡æ³•ç”¨æˆªå›¾è¡¨ç°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘åªç®€å•æè¿°ä¸‹ï¼‰ã€‚</p></li>
</ul>


<p>ç»„åˆæ”¶å‘å‡½æ•°ï¼Œå®Œæˆé˜¿å‡¹çš„é€»è¾‘ï¼Œæœ€åå†™ä»£ç ï¼š</p>

<p><img src="/images/nixiangjiqiren017.jpg" title="Caption" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[é©±åŠ¨å¼€å‘]]></title>
    <link href="http://al1020119.github.io/blog/2016/04/15/qudongkaifa/"/>
    <updated>2016-04-15T13:32:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/04/15/qudongkaifa</id>
    <content type="html"><![CDATA[<h4>ä¸€ã€ç³»ç»Ÿæ¶æ„</h4>

<p><img src="/images/nixiangqudong001.png" title="Caption" ></p>

<p>æˆ‘ä»¬ç¼–å†™çš„é©±åŠ¨ä¸€èˆ¬è¿è¡Œåœ¨i/o Kitæ¡†æ¶ä¸‹ã€‚</p>

<h4>äºŒã€ä¸€äº›è®°å½•</h4>

<ul>
<li>å¼€å‘å·¥å…· xcode</li>
<li>å¼€å‘è¯­è¨€ï¼šc++, c</li>
</ul>


<p>c++ç”¨çš„æ˜¯åµŒå…¥å¼c++ï¼Œæ˜¯æ ‡å‡†c++çš„å­é›†ã€‚</p>

<p>æ‰€ä»¥ï¼Œstlã€å¼‚å¸¸ã€å¤šé‡ç»§æ‰¿ã€æ¨¡æ¿å’Œruntimeç±»å‹ä¿¡æ¯  éƒ½æ— æ³•ä½¿ç”¨ã€‚</p>

<p>å› ä¸ºè¿™äº›ä¸œè¥¿ä¼šå¯¼è‡´ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶å¾ˆå¤§ï¼Œä¸”å®¹æ˜“å¯¼è‡´é—®é¢˜ã€‚</p>

<p>c++åªèƒ½ç¼–å†™åŸºäºi/o Kitæ¡†æ¶çš„é©±åŠ¨ï¼Œè€Œcè¯­è¨€åˆ™å¯ä»¥ç¼–å†™ä»»æ„çš„é©±åŠ¨ã€‚</p>

<p>å¹¶ä¸”c++çš„é©±åŠ¨åæ±‡ç¼–åå¾ˆéš¾çœ‹ã€‚</p>

<blockquote><p>æ‰€ä»¥å†™é©±åŠ¨è¿˜æ˜¯ç”¨cå§ã€‚è¿™ä¸€ç‚¹å’Œå¾®è½¯é»˜è®¤çš„ä¸€æ ·ã€‚</p></blockquote>

<h4>ä¸‰ã€ç¼–å†™ä¸€ä¸ªé©±åŠ¨ä¾‹å­</h4>

<ol>
<li>åˆ›å»ºå·¥ç¨‹</li>
</ol>


<p><img src="/images/nixiangqudong002.png" title="Caption" ></p>

<p>å› ä¸ºä¸æ˜¯è®¾å¤‡é©±åŠ¨ï¼Œåªèƒ½é€‰æ‹©extensionï¼›å¦‚æœæ˜¯è®¾å¤‡é©±åŠ¨ï¼Œåˆ™é€‰æ‹©IOKit Driverã€‚</p>

<ol>
<li>å†™ä»£ç </li>
</ol>


<p><img src="/images/nixiangqudong003.png" title="Caption" ></p>

<p>è‹¹æœå°†studio.hè¿™æ ·çš„c++åº“æ¢æˆäº†è‡ªå·±çš„libkern.hã€‚</p>

<ol>
<li>æ·»åŠ å¼•ç”¨åº“
å› ä¸ºä»£ç ä¸­ä½¿ç”¨äº†libkern.hï¼Œæ‰€ä»¥è¦ä¿®æ”¹å·¥ç¨‹ã€‚</li>
</ol>


<p><img src="/images/nixiangqudong004.png" title="Caption" ></p>

<ol>
<li>é©±åŠ¨å…¥å£</li>
</ol>


<p><img src="/images/nixiangqudong005.png" title="Caption" ></p>

<ol>
<li><p>ç¼–è¯‘é©±åŠ¨</p></li>
<li><p>åœ¨xcodeçš„productèœå•é‡Œç‚¹å‡»buildå°±å¯ä»¥ç¼–è¯‘é©±åŠ¨äº†ã€‚</p></li>
<li>xcodeåªæ˜¯èƒ½ç¼–è¾‘å’Œç¼–è¯‘é©±åŠ¨ï¼Œæ— æ³•è°ƒè¯•é©±åŠ¨çš„ã€‚</li>
<li>ç¼–è¯‘é©±åŠ¨æ—¶ï¼Œä½ éœ€è¦æœ‰ä¸€ä¸ªå¼€å‘è€…è´¦å·ï¼Œå¦åˆ™ç¼–è¯‘ä¸è¿‡ã€‚</li>
<li>æˆ‘æ²¡æœ‰è´¦å·ï¼Œæ‰€ä»¥åé¢çš„æ“ä½œæ— æ³•è¿›è¡Œï¼Œåªèƒ½æŠŠä¹¦ä¸Šçš„ç¿»è¯‘è¿‡æ¥ã€‚</li>
</ol>


<p>6ã€è¿è¡Œé©±åŠ¨æœ‰2ç§æ–¹å¼ï¼š</p>

<ul>
<li>1ã€æ‹·è´é©±åŠ¨æ–‡ä»¶åˆ°ç›®å½• /system/library/extensionsä¸‹ï¼Œé‡å¯åè‡ªåŠ¨è¿è¡Œï¼›</li>
<li><p>2ã€åœ¨terminalä¸­è¿è¡Œå‘½ä»¤å¯åŠ¨é©±åŠ¨ï¼š</p>

<ul>
<li>sudo chown -R root:wheel é©±åŠ¨å.kext   // è®¾ç½®é©±åŠ¨æ–‡ä»¶çš„æƒé™ï¼Œå¦‚æœæœ‰æƒé™ï¼Œè¿™æ­¥å¯çœç•¥ã€‚
sudo kextload é©±åŠ¨å.kext  // è¿è¡Œé©±åŠ¨</li>
</ul>
</li>
<li><p>å¸è½½é©±åŠ¨ï¼šsudo kextunload é©±åŠ¨å.kext</p></li>
<li><p>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­çš„é©±åŠ¨ï¼škextstat</p></li>
</ul>


<p><img src="/images/nixiangqudong006.png" title="Caption" ></p>

<ol>
<li>æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯
printfè¾“å‡ºçš„ä¿¡æ¯æ˜¯ä¿å­˜åœ¨ç£ç›˜ä¸Šçš„logæ–‡ä»¶ä¸­ã€‚é€šè¿‡tailå’Œcatå‘½ä»¤å°±å¯ä»¥æŸ¥çœ‹ã€‚logæ–‡ä»¶åœ¨/var/log/kernel.logæˆ–è€…/Applications/Utilitiesç›®å½•ä¸‹ã€‚</li>
</ol>


<p><img src="/images/nixiangqudong007.png" title="Caption" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[é€†å‘æ”¯ä»˜å®]]></title>
    <link href="http://al1020119.github.io/blog/2016/04/10/nixiangzhifubao/"/>
    <updated>2016-04-10T13:32:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/04/10/nixiangzhifubao</id>
    <content type="html"><![CDATA[<p>ä¸ºäº†äº†è§£æ”¯ä»˜å®appçš„æºç ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨class-dump-zå·¥å…·æ¥åˆ†ææ”¯ä»˜å®äºŒè¿›åˆ¶ã€‚
1.ä¸‹è½½é…ç½®class_dump_z</p>

<p>å‰å¾€ <a href="https://code.google.com/p/networkpx/wiki/class_dump_z">https://code.google.com/p/networkpx/wiki/class_dump_z</a> ï¼Œä¸‹è½½taråŒ…ï¼Œç„¶åè§£å‹é…ç½®åˆ°æœ¬åœ°ç¯å¢ƒ</p>

<p>$ tar -zxvf class-dump-z_0.2a.tar.gz<br/>
$ sudo cp mac_x86/class-dump-z /usr/bin/
2.class_dumpæ”¯ä»˜å®app
$ class-dump-z Portal > Portal-dump.txt</p>

<p>@protocol XXEncryptedProtocol_10764b0<br/>
-(?)XXEncryptedMethod_d109df;<br/>
-(?)XXEncryptedMethod_d109d3;<br/>
-(?)XXEncryptedMethod_d109c7;<br/>
-(?)XXEncryptedMethod_d109bf;<br/>
-(?)XXEncryptedMethod_d109b8;<br/>
-(?)XXEncryptedMethod_d109a4;<br/>
-(?)XXEncryptedMethod_d10990;<br/>
-(?)XXEncryptedMethod_d1097f;<br/>
-(?)XXEncryptedMethod_d10970;<br/>
-(?)XXEncryptedMethod_d10968;<br/>
-(?)XXEncryptedMethod_d10941;<br/>
-(?)XXEncryptedMethod_d10925;<br/>
-(?)XXEncryptedMethod_d10914;<br/>
-(?)XXEncryptedMethod_d1090f;<br/>
-(?)XXEncryptedMethod_d1090a;<br/>
-(?)XXEncryptedMethod_d10904;<br/>
-(?)XXEncryptedMethod_d108f9;<br/>
-(?)XXEncryptedMethod_d108f4;<br/>
-(?)XXEncryptedMethod_d108eb;<br/>
@optional<br/>
-(?)XXEncryptedMethod_d109eb;<br/>
@end</p>

<p>æŸ¥çœ‹å¾—åˆ°çš„ä¿¡æ¯æ˜¯åŠ è¿‡å¯†çš„ï¼Œè¿™ä¸ªåŠ å¯†æ“ä½œæ˜¯è‹¹æœåœ¨éƒ¨ç½²åˆ°app storeæ—¶åšçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åšä¸€æ­¥è§£å¯†æ“ä½œã€‚
3.ä½¿ç”¨Clutchè§£å¯†æ”¯ä»˜å®app</p>

<p>1ï¼‰ä¸‹è½½Clutch
iOS7è¶Šç‹±åçš„Cydiaæºé‡Œå·²ç»ä¸‹è½½ä¸åˆ°Clutchäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»ç½‘ä¸Šä¸‹è½½å¥½æ¨è¿›iPhone
åœ°å€ï¼šClutchä¼ é€é—¨</p>

<p>2ï¼‰æŸ¥çœ‹å¯è§£å¯†çš„åº”ç”¨åˆ—è¡¨</p>

<p>root</p>

<h1>./Clutch</h1>

<p>Clutch-1.3.2<br/>
usage: ./Clutch [flags] [application name] [&hellip;]<br/>
Applications available: 9P_RetinaWallpapers breadtrip Chiizu CodecademyiPhone FisheyeFree food GirlsCamera IMDb InstaDaily InstaTextFree iOne ItsMe3 linecamera Moldiv MPCamera MYXJ NewsBoard Photo Blur Photo Editor PhotoWonder POCOç›¸æœº Portal QQPicShow smashbandits Spark tripcamera Tuding_vITC_01 wantu WaterMarkCamera WeiBo Weibo</p>

<p>3ï¼‰è§£å¯†æ”¯ä»˜å®app</p>

<p>root# ./Clutch Portal</p>

<p>Clutch-1.3.2<br/>
Cracking Portal&hellip;<br/>
Creating working directory&hellip;<br/>
Performing initial analysis&hellip;<br/>
Performing cracking preflight&hellip;<br/>
dumping binary: analyzing load commands<br/>
dumping binary: obtaining ptrace handle<br/>
dumping binary: forking to begin tracing<br/>
dumping binary: successfully forked<br/>
dumping binary: obtaining mach port<br/>
dumping binary: preparing code resign<br/>
dumping binary: preparing to dump<br/>
dumping binary: ASLR enabled, identifying dump location dynamically<br/>
dumping binary: performing dump<br/>
dumping binary: patched cryptid<br/>
dumping binary: writing new checksum<br/>
Censoring iTunesMetadata.plist&hellip;<br/>
Packaging IPA file&hellip;</p>

<p>compression level: 0<br/>
    /var/root/Documents/Cracked/æ”¯ä»˜å®é’±åŒ…-v8.0.0-(Clutch-1.3.2).ipa</p>

<p>elapsed time: 7473ms</p>

<p>Applications Cracked: <br/>
Portal</p>

<p>Applications that Failed:</p>

<p>Total Success: 1 Total Failed: 0</p>

<p>4ï¼‰å¯¼å‡ºå·²è§£å¯†çš„æ”¯ä»˜å®app</p>

<p>ä»ä¸Šä¸€æ­¥éª¤å¾—çŸ¥ï¼Œå·²è§£å¯†çš„ipaä½ç½®ä¸ºï¼š/var/root/Documents/Cracked/æ”¯ä»˜å®é’±åŒ…-v8.0.0-(Clutch-1.3.2).ipa
å°†å…¶æ‹·è´åˆ°æœ¬åœ°å»åˆ†æ</p>

<p>4.class_dumpå·²è§£å¯†çš„æ”¯ä»˜å®app</p>

<p>è§£å‹.ipaåï¼Œåˆ° æ”¯ä»˜å®é’±åŒ…-v8.0.0-(Clutch-1.3.2)/Payload/Portal.app ç›®å½•ä¸‹ï¼Œclass_dumpå·²è§£å¯†çš„äºŒè¿›åˆ¶æ–‡ä»¶
1</p>

<p>$ class-dump-z Portal > ~/Portal-classdump.txt</p>

<p>è¿™å›å°±å¯ä»¥å¾—åˆ°å¯¹åº”çš„ä¿¡æ¯äº†ï¼š</p>

<p>@protocol ALPNumPwdInputViewDelegate <NSObject><br/>
-(void)onPasswordDidChange:(id)onPassword;<br/>
@end</p>

<p>@protocol ALPContactBaseTableViewCellDelegate <NSObject><br/>
-(void)shareClicked:(id)clicked sender:(id)sender;<br/>
@end</p>

<p>@interface MMPPayWayViewController : XXUnknownSuperclass &lt;SubChannelSelectDelegate, UITableViewDataSource, UITableViewDelegate, CellDelegate, UIAlertViewDelegate> {<br/>
@private<br/>
    Item<em> channelSelected;<br/>
    BOOL <em>bCheck;<br/>
    BOOL </em>bOpenMiniPay;<br/>
    BOOL <em>bNeedPwd;<br/>
    BOOL </em>bSimplePwd;<br/>
    BOOL <em>bAutopayon;<br/>
    BOOL </em>bHasSub;<br/>
    BOOL <em>bFirstChannel;<br/>
    BOOL </em>bChangeSub;<br/>
    BOOL _bClickBack;<br/>
    UITableView</em> <em>channelListTableView;<br/>
    NSMutableArray* </em>channelListArray;<br/>
    NSMutableArray<em> _subChanneSelectedlList;<br/>
    NSMutableArray</em> <em>unCheckArray;<br/>
    UIButton* </em>saveButton;<br/>
    UILabel<em> _tipLabel;<br/>
    MMPPasswordSwichView</em> <em>payWaySwitch;<br/>
    MMPPopupAlertView* </em>alertView;<br/>
    UIView<em> <em>setView;<br/>
    int </em>originalSelectedRow;<br/>
    int _currentSelectedRow;<br/>
    NSString</em> <em>statusCode;<br/>
    ChannelListModel* </em>defaultChannelList;<br/>
}<br/>
@property(assign, nonatomic) BOOL bClickBack;<br/>
@property(retain, nonatomic) ChannelListModel<em> defaultChannelList;<br/>
@property(retain, nonatomic) NSString</em> statusCode;<br/>
@property(assign, nonatomic) int currentSelectedRow;<br/>
@property(assign, nonatomic) int originalSelectedRow;<br/>
@property(retain, nonatomic) UIView<em> setView;<br/>
@property(retain, nonatomic) MMPPopupAlertView</em> alertView;<br/>
@property(retain, nonatomic) MMPPasswordSwichView<em> payWaySwitch;<br/>
@property(assign, nonatomic, getter=isSubChannelChanged) BOOL bChangeSub;<br/>
@property(assign, nonatomic) BOOL bFirstChannel;<br/>
@property(assign, nonatomic) BOOL bHasSub;<br/>
@property(assign, nonatomic) BOOL bAutopayon;<br/>
@property(assign, nonatomic) BOOL bSimplePwd;<br/>
@property(assign, nonatomic) BOOL bNeedPwd;<br/>
@property(assign, nonatomic) BOOL bOpenMiniPay;<br/>
@property(assign, nonatomic) BOOL bCheck;<br/>
@property(retain, nonatomic) UILabel</em> tipLabel;<br/>
@property(retain, nonatomic) UIButton<em> saveButton;<br/>
@property(retain, nonatomic) NSMutableArray</em> unCheckArray;<br/>
@property(retain, nonatomic) NSMutableArray<em> subChanneSelectedlList;<br/>
@property(retain, nonatomic) NSMutableArray</em> channelListArray;<br/>
@property(retain, nonatomic) UITableView* channelListTableView;<br/>
-(void).cxx_destruct;<br/>
-(void)subChannelDidSelected:(id)subChannel;<br/>
-(void)switchCheckButtonClicked:(id)clicked;<br/>
-(void)checkboxButtonClicked:(id)clicked;<br/>
-(void)onCellClick:(id)click;<br/>
-(void)showSubChannels;<br/>
-(void)tableView:(id)view didSelectRowAtIndexPath:(id)indexPath;<br/>
-(id)tableView:(id)view cellForRowAtIndexPath:(id)indexPath;<br/>
-(int)tableView:(id)view numberOfRowsInSection:(int)section;<br/>
-(float)tableView:(id)view heightForRowAtIndexPath:(id)indexPath;<br/>
-(int)numberOfSectionsInTableView:(id)tableView;<br/>
-(void)setTableViewFootView:(id)view;<br/>
-(void)setTableViewHeaderView:(id)view;<br/>
-(id)tableView:(id)view viewForHeaderInSection:(int)section;<br/>
-(id)tableView:(id)view viewForFooterInSection:(int)section;<br/>
-(float)tableView:(id)view heightForHeaderInSection:(int)section;<br/>
-(float)tableView:(id)view heightForFooterInSection:(int)section;<br/>
-(void)alertView:(id)view clickedButtonAtIndex:(int)index;<br/>
-(void)clickSave;<br/>
-(void)netWorkRequestWithPwd:(id)pwd;<br/>
-(void)setPayWaySwitchStates:(id)states;<br/>
-(void)changePayWaySwitch:(id)aSwitch;<br/>
-(void)scrollToSelectedRow;<br/>
-(void)didReceiveMemoryWarning;<br/>
-(void)viewDidLoad;<br/>
-(void)applicationEnterBackground:(id)background;<br/>
-(void)dealloc;<br/>
-(void)goBack;<br/>
-(BOOL)isChannelsSetChanged;<br/>
-(id)subChannelCode:(int)code;<br/>
-(id)subChannelDesc:(int)desc;<br/>
-(id)initWithDefaultData:(id)defaultData;<br/>
-(id)initWithNibName:(id)nibName bundle:(id)bundle;<br/>
-(void)commonInit:(id)init;<br/>
@end
5.åˆ†ææ”¯ä»˜å®æºç ç‰‡æ®µ</p>

<p>1ï¼‰ä½¿ç”¨äº†@privateå…³é”®å­—é™åˆ¶æˆå‘˜è®¿é—®æƒé™
ä½†æ˜¯å®é™…ä¸Šï¼Œåœ¨Objective-Cç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨@privateè¿Keypathè®¿é—®éƒ½æ‹¦ä¸ä½çš„</p>

<p>2ï¼‰æŠ›å‡ºäº†å†—é•¿çš„æˆå‘˜å¯¹è±¡
è¿™éå¸¸æœ‰åˆ©åˆ†æç¨‹åºç»“æ„
6.è¿›ä¸€æ­¥æ€è€ƒ</p>

<p>1ï¼‰å¦‚ä½•åˆ©ç”¨ class-dump ç»“æœï¼Œç»“åˆ cycript è¿›è¡Œæ”»å‡»å‘¢ï¼Ÿ
2ï¼‰class-dump-z å¦‚æ­¤å¼ºå¤§ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥å‡å°‘æš´éœ²çš„ä¿¡æ¯å—ï¼Ÿ</p>

<p>æ¥ä¸‹æ¥çš„åšæ–‡å°†é’ˆå¯¹ä¸Šé¢çš„æ€è€ƒï¼Œç»§ç»­æ€»ç»“ï½</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[é6S-å®ç°3D Touch]]></title>
    <link href="http://al1020119.github.io/blog/2016/04/05/fei6sshixian3dtouch/"/>
    <updated>2016-04-05T13:32:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/04/05/fei6sshixian3dtouch</id>
    <content type="html"><![CDATA[<p>é¦–å…ˆå…ˆç»™æˆ‘è¿™å›°éš¾çš„è¯­è¨€è¡¨è¾¾èƒ½åŠ›é“ä¸ªæ­‰å“ˆï¼ŒçœŸçš„å°½åŠ›äº†ã€‚
æœ¬ç« æ’ç‰ˆæ˜¯å‚ç…§<a href="http://bbs.pediy.com/showthread.php?t=205133%E5%A4%A7%E7%A5%9E%E7%9A%84%E6%9D%A5%E6%8E%92%E7%9A%84%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%86%99%E5%BF%83%E5%BE%97%E6%96%87%EF%BC%8C%E4%B9%9F%E6%8A%8A%E6%89%80%E5%AD%A6%E5%88%B0%E7%9A%84%E5%88%86%E4%BA%AB%E7%BB%99%E5%A4%A7%E5%AE%B6">http://bbs.pediy.com/showthread.php?t=205133%E5%A4%A7%E7%A5%9E%E7%9A%84%E6%9D%A5%E6%8E%92%E7%9A%84%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%86%99%E5%BF%83%E5%BE%97%E6%96%87%EF%BC%8C%E4%B9%9F%E6%8A%8A%E6%89%80%E5%AD%A6%E5%88%B0%E7%9A%84%E5%88%86%E4%BA%AB%E7%BB%99%E5%A4%A7%E5%AE%B6</a></p>

<p>æœ€è¿‘æ‰æ¥è§¦ä¸ä¹…çš„é€†å‘å·¥ç¨‹,åˆ·å¤œ,çˆ†è‚,æŠŠã€ŠiOSåº”ç”¨é€†å‘å·¥ç¨‹ã€‹è¿™æœ¬ä¹¦çš„å·¥å…·ï¼Œå…¨éƒ¨çœ‹äº†ä¸€éï¼Œå¹¶ä¸”å°è¯•äº†ä¸€éï¼Œæ„Ÿè§‰éœ€è¦ç‚¹ä»€ä¹ˆã€‚ é‚£å°±æ˜¯å®è·µï¼  æœ€è¿‘6sæ‰‹æœºå‡ºäº†3DTouchï¼Œæ— å¥ˆæ‰‹ä¸­æ²¡æœ‰è¿™æ¬¾æœºå‹ï¼Œæ°å¥½æœ€è¿‘å¯¹é€†å‘å°æœ‰å¿ƒå¾—ï¼Œåˆå¬è¯´è¿‡å·²ç»æœ‰æ’ä»¶èƒ½å®ç°åŒæ ·çš„éœ€æ±‚ï¼Œè¯æ˜ç¡®å®æœ‰å¯è¡Œæ€§ï¼Œäºæ˜¯å¼€åŠ¨ã€‚æ ¹æ®ç‚¹å‡»çš„åˆ¤æ–­å’Œå‡ºç°ï¼Œåˆæ­¥æ„Ÿè§‰ï¼Œè¿™åº”è¯¥ä¸éœ€è¦å¤šå°‘è¡Œä»£ç å°±èƒ½æå®šï¼Œåº”è¯¥åªè¦æ·»åŠ ä¸€ä¸ªæ‰‹åŠ¿ï¼Œæˆ–è€…æ˜¯æ›´æ”¹ä¸€ä¸ªæ‰‹åŠ¿çš„ç‚¹å‡»äº‹ä»¶ï¼Œè®©ç³»ç»Ÿè®¤ä¸ºå‘ç”Ÿäº†3DTouchç‚¹å‡»äº‹ä»¶ï¼Œå°±å¯ä»¥äº†ã€‚</p>

<ul>
<li>æ‰€éœ€å·¥å…·: cycriptï¼ŒopenSSHï¼Œclass-dump</li>
<li>æµ‹è¯•ç¯å¢ƒï¼šiOS9.0.2ï¼ŒiPhone5s</li>
<li>å¤‡æ³¨ï¼šå› ä¸ºè‡ªèº«æ²¡æœ‰3DTouchï¼Œæ‰€ä»¥éœ€è¦ä¸‹è½½ä¸€ä¸ªæ’ä»¶ï¼Œè®©æœºå™¨æ‹¥æœ‰3DTouchåŠŸèƒ½ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯forcyï¼Œé€šè¿‡è¦†ç›–é•¿æŒ‰æ‰‹åŠ¿ï¼Œå®ç°</li>
</ul>


<p>é€šè¿‡æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œå¾—åˆ°å…³é”®è¯  Shortcut Menu peek pop
è¿™ä¸ªè¯å°†æ¥å°±æ˜¯è¦åœ¨æ‰¾å…³é”®æ–¹æ³•æ—¶åˆ»æ‰€è¦ç”¨åˆ°çš„</p>

<h4>ç°åœ¨å¼€å§‹ï¼</h4>

<p>é€šè¿‡sshè¿æ¥åˆ°æ‰‹æœºï¼Œç„¶åå°†cycriptæ³¨å…¥åˆ°SpringBoard</p>

<pre><code>huangjipingde-iPhone:~ root# cycript -p SpringBoard
</code></pre>

<p>é¦–å…ˆ å…ˆéš†é‡ä»‹ç»1ä¸ªæ–¹æ³•ï¼Œ2ä¸ªå‡½æ•°</p>

<ul>
<li>1æ–¹æ³• [view recursiveDescription]  è¯¥æ–¹æ³•å¯ä»¥å½“åšæ˜¯Revealçš„æ–‡å­—ç‰ˆï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰é¡µé¢çš„å¸ƒå±€</li>
<li><p>2å‡½æ•°ï¼ŒåŸç†å‡æ˜¯runtimeï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæ²¡æœ‰æ€ä¹ˆçœ‹æ‡‚ã€‚ã€‚ã€‚</p></li>
<li><p>printMethods æ‰“å°å‡ºè¯¥ç±»æ‰€æœ‰çš„æ–¹æ³•ï¼Œåè¾¹æ¥çš„æ˜¯å®ç°çš„åœ°å€,åœ¨è¿™å„¿è¡¥å……ä¸€ä¸‹ï¼Œå¦‚æœæƒ³å¯¹æŸä¸ªæ–¹æ³•æ‰“æ–­ç‚¹ï¼Œä½†æ˜¯åˆä¸æƒ³ä½¿ç”¨idaæŸ¥çœ‹æ–¹æ³•åç§»ï¼Œå¯ä»¥ç›´æ¥åœ¨è¿™å®ç°çš„åœ°å€å¤„ï¼Œæ·»åŠ æ–­ç‚¹ï¼Œè™½ç„¶ä¸çŸ¥é“æ–­åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œä½†æ˜¯å¯ä»¥è‚¯å®šä¸€å®šæ˜¯åœ¨æ‰§è¡Œè¯¥æ–¹æ³•çš„æ—¶å€™ã€‚æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p></li>
</ul>


<p>ä»£ç :</p>

<pre><code>function printMethods(className){
var count = new new Type("I");
var methods = class_copyMethodList(objc_getClass(className),count);
var methodsArray = [];
for (var i = 0; i &lt; *count; i++){
var method = methods[i];
methodsArray.push({selector:method_getName(method), implentation:method_getImplementation(method)});
}
free(methods);
free(count);
return methodsArray;
}
</code></pre>

<p><img src="/images/nixiangqudong001.png" title="Caption" ></p>

<ol>
<li><p>tryPrintIvarsæ‰“å°å‡ºå¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š
ä»£ç :</p>

<p>  function tryPrintIvars(a){
  var x={};
  for(i in <em>a){
  try{
  x[i] = (</em>a)[i];
  } catch(e){}
  }
   return x;}</p></li>
</ol>


<p><img src="/images/nixiangqudong002.png" title="Caption" ></p>

<p>å‡†å¤‡å·¥ä½œéƒ½åšå¥½äº†ï¼Œå°†ä¸¤ä¸ªå‡½æ•°éƒ½å…ˆè¾“å…¥è¿›å»</p>

<p><img src="/images/nixiangqudong003.png" title="Caption" ></p>

<p>å› ä¸ºæœ€åçš„ç›®æ ‡æ˜¯åº”ç”¨å›¾æ ‡ï¼Œæ‰€ä»¥ï¼Œç°åœ¨æˆ‘ä»¬ä»ä¸»ç•Œé¢å¼€å§‹ç€æ‰‹æ‰“å°å®ƒçš„UIå¸ƒå±€
ä»£ç :</p>

<pre><code>[[UIApplication sharedApplication].keyWindow.rootViewController.view recursiveDescription]
</code></pre>

<p><img src="/images/nixiangqudong004.png" title="Caption" ></p>

<p>ç„¶åå‡ºæ¥äº†ä¸€å¤§ç‰‡ï¼Œçº¢å‘¦å‘¦çš„ä»£ç ï¼Œçœ‹ç€éƒ½çœ¼ç›ç–¼ï¼Œ4ç‚¹é’Ÿæ—¶çœ‹å¾—çœ¼ç›éƒ½çäº†å•Šã€‚æ­¤æ—¶åº”æƒ³ï¼Œä¸»ç•Œé¢å¯ä»¥æ»šåŠ¨ï¼Œæ˜¯ä¸€ä¸ªscrollViewï¼Œæ˜¯scrollViewå°±å¾—æœ‰contentSizeï¼Œç„¶åä¸€çœ‹æ‰‹æœºçš„é¡µé¢ï¼Œæ€»å…±æœ‰5é¡µï¼Œç”±äº5sæœºå‹çš„å®½åº¦æ˜¯320ï¼Œæ‰€ä»¥è¿™æ—¶å€™å¯ä»¥å¤§èƒ†çŒœæµ‹å®ƒçš„contentSizeçš„æœ€å¤§å®½åº¦æ˜¯1600ï¼Œç„¶åcommond+Få¤§æ³•</p>

<p><img src="/images/nixiangqudong005.png" title="Caption" ></p>

<p>å‡†ç¡®å‘½ä¸­ï¼ŒåŒæ—¶ï¼Œè¿˜æ³¨æ„åˆ°ï¼Œå®ƒçš„contentOffsetæ˜¯960åˆæ­¤æ—¶æˆ‘çš„é¡µé¢æ­£æ˜¯ç¬¬4é¡µï¼ŒåŸºæœ¬é”å®šç›®æ ‡ï¼ŒæŸ¥æ‰¾frameçš„åæ ‡æ˜¯960ï¼Œ0çš„viewï¼Œæ­¤æ—¶å¯ä»¥å¾—åˆ°å¤§é‡ä¿¡æ¯äº†ï¼ŒSBRootIconListViewï¼Œè¿™ä¸ªå°±æ˜¯ç”¨æ¥è£…ä¸€é¡µæ‰€æœ‰å›¾æ ‡çš„Viewï¼ŒSBIconListModelè¿™ä¸ªé‡Œè¾¹ï¼Œæˆ‘çŒœæ˜¯è£…äº†è¯¥viewé‡Œè¾¹çš„æ¨¡å‹ä¿¡æ¯ï¼Œæ³¨æ„ï¼Œ11 iconsï¼Œæ­£å¥½æ˜¯æˆ‘ä»¬é¡µé¢æ‰€æœ‰çš„å›¾æ ‡æ•°ï¼Œæ­¤æ—¶å†çœ‹åè¾¹SBIconViewçš„size 62ï¼Œ62  è¿™å’Œå›¾æ ‡å°ºå¯¸çš„å·®è·åªæœ‰2ä¸ªç‚¹ï¼ŒåŸºæœ¬é”å®šï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç›®æ ‡</p>

<p><img src="/images/nixiangqudong006.png" title="Caption" ></p>

<ul>
<li><p>æ­¤æ—¶ï¼Œè®©æˆ‘ä»¬æ‰¾åˆ°æ˜¯ä»€ä¹ˆåœ¨å¤„ç†SBIconViewçš„äº‹ä»¶ï¼Œæˆ‘ä»¬æ‰€çŸ¥é“çš„ï¼Œviewä¸€èˆ¬æ˜¯ç”¨æ¥å±•ç¤ºçš„ï¼Œäº‹ä»¶çš„å‘ç”Ÿä¸€èˆ¬éƒ½ä¼šäº¤ç»™ä»£ç†æ¥è´Ÿè´£ã€‚è®©æˆ‘ä»¬ä½¿ç”¨nextResponderï¼Œæˆ–è€…å¯»æ‰¾ä»–ä»¬çš„ä»£ç†ï¼Œæ¥å®šä½åˆ°ä¸€ä¸ªcontrolleræ–‡ä»¶ï¼Œå¾ˆå¹¸è¿ï¼Œç›´æ¥ä¸€æ­¥å°±æ‰¾åˆ°äº†ï¼Œå°±æ˜¯å®ƒï¼šSBIconControllerï¼</p></li>
<li><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥class-dumpå‡ºSpringBoardçš„å¤´æ–‡ä»¶äº†ï¼Œå»æŸ¥çœ‹ä¸€ä¸‹å®ƒçš„é‡Œè¾¹éƒ½æœ‰äº›ä»€ä¹ˆæ–¹æ³•å’Œå±æ€§ï¼Œå¦‚æœæƒ³å·æ‡’ï¼Œå»githubç›´æ¥æœç´¢ä¹Ÿè¡Œã€‚ã€‚ã€‚
æ ¹æ®å…³é”®è¯å’Œæ–¹æ³•åè¯‘çš„æ„æ€å¤§è‡´é”å®šå‡ºæ¥ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•</p></li>
</ul>


<p>psï¼š  è¿™å„¿çš„char æ˜¯BOOLç±»å‹
ä»£ç :</p>

<pre><code>-(void)_handleShortcutMenuPeek:(id)arg1 ;
-(SBApplicationShortcutMenu *)presentedShortcutMenu;
-(char)_canRevealShortcutMenu;
-(id)_aggregateLoggingAppKeyForShortcutMenu:(id)arg1 ;
-(void)applicationShortcutMenu:(id)arg1 activateShortcutItem:(id)arg2 index:(int)arg3 ;
-(void)applicationShortcutMenu:(id)arg1 startEditingForIconView:(id)arg2 ;
-(void)applicationShortcutMenu:(id)arg1 launchApplicationWithIconView:(id)arg2 ;
-(void)applicationShortcutMenuDidPresent:(id)arg1 ;
-(void)_revealMenuForIconView:(id)arg1 presentImmediately:(char)arg2 ;
</code></pre>

<p>è‡ªå·±å†™ä¸€ä¸ªtweakï¼Œhookæ‰€æœ‰çš„è¿™äº›å‡½æ•°ï¼Œç»™ä»–ä»¬æ‰€æœ‰çš„å®ç°ä¹‹å‰åŠ ä¸Šä¸€ä¸ªNSLogï¼ˆï¼‰ï¼ŒæŸ¥çœ‹è°ƒç”¨çš„é¡ºåºï¼Œå’Œä¼ è¿›æ¥çš„å€¼çš„ç±»å‹ã€‚ ä»¥åŠä¸€æ¬¡Peekäº‹ä»¶æ‰€å…³è”åˆ°äº†å“ªäº›æ–¹æ³•ã€‚
ä»£ç :</p>

<pre><code>%hook SBIconController

- (void)_revealMenuForIconView:(id)arg1 presentImmediately:(BOOL)arg2 {
NSLog(@"ZZT3D _revealMenuForIconView:arg1:%s,%@--arg2:%c",object_getClassName(arg1), arg1, arg2);
    %orig;
}

- (void)_handleShortcutMenuPeek:(id)arg1
{
NSLog(@"ZZT3D _handleShortcutMenuPeek:%s,%@",object_getClassName(arg1),arg1);
%orig;
}

-(char)_canRevealShortcutMenu
{
NSLog(@"ZZT3D _canRevealShortcutMenu");
  return %orig;
}
-(id)_aggregateLoggingAppKeyForShortcutMenu:(id)arg1{

 NSLog(@"ZZT3D ggregateLoggingAppKeyForShortcutMenu:%s,%@",object_getClassName(arg1),arg1);
    return %orig;
}

-(void)applicationShortcutMenu:(id)arg1 activateShortcutItem:(id)arg2 index:(int)arg3
{
NSLog(@"ZZT3D activateShortcutItem:arg1%s,%@â€”arg2%s,%@--arg3:%d",object_getClassName(arg1),arg1,object_getClassName(arg2),arg2,arg3);
%orig;
}


-(void)applicationShortcutMenu:(id)arg1 startEditingForIconView:(id)arg2 {
NSLog(@"ZZT3D startEditingForIconView:arg1%s,%@â€”arg2%s,%@",object_getClassName(arg1),arg1,object_getClassName(arg2),arg2);
%orig;

}
-(void)applicationShortcutMenu:(id)arg1 launchApplicationWithIconView:(id)arg2{
NSLog(@"ZZT3D launchApplicationWithIconView:arg1%s,%@â€”arg2%s,%@",object_getClassName(arg1),arg1,object_getClassName(arg2),arg2);
%orig;
}

-(void)applicationShortcutMenuDidPresent:(id)arg1{
NSLog(@"ZZT3D applicationShortcutMenuDidPresent:%s,%@",object_getClassName(arg1),arg1);
%orig;
}

%end
</code></pre>

<p>æ­¤æ—¶æˆ‘ä»¬æ‹¿æ‰‹æœºè¿›è¡Œä¸€æ¬¡é•¿æŒ‰æ“ä½œï¼Œä½¿å…¶å¼¹å‡ºShotcutMenuèœå•ï¼Œç„¶ååœ¨openSSHä¸­æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—grep ZZT3D /var/log/syslogæŸ¥çœ‹ä¸€ä¸‹ï¼Œè¯¥äº‹ä»¶å¤„ç†åˆ†åˆ«ä½¿ç”¨äº†é‚£å‡ ä¸ªæ–¹æ³•ã€‚</p>

<p><img src="/images/nixiangqudong007.png" title="Caption" ></p>

<p>å› ä¸ºæ˜¯è¦æ¬ºéª—ç³»ç»Ÿï¼Œæ‰€ä»¥æ–¹æ³•åº”è¯¥æ˜¯åœ¨å‰æ–¹ï¼Œåˆæ­¥å®šä½åˆ°è¿™3ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªé¡¾åæ€ä¹‰è¿”å›å€¼å°±æ˜¯èƒ½ä¸èƒ½æ˜¾ç¤ºshotcutMenuï¼Œç¬¬äºŒä¸ªï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä¼ è¿›æ¥äº†ä¸€ä¸ªæ‰‹åŠ¿ï¼Œé€šè¿‡è¿™æ‰‹åŠ¿çš„ä¿¡æ¯ï¼ŒåŸºæœ¬å¯ä»¥æ¨æ–­ï¼Œè¿™ä¸ªå°±æ˜¯æ’ä»¶ä½œè€…ç”¨æ¥æ¬ºéª—ç³»ç»Ÿçš„æ‰‹åŠ¿ï¼Œè€Œè¯¥æ–¹æ³•ï¼Œå°±æ˜¯æ‰‹åŠ¿çš„targetæ–¹æ³•ï¼Œç¬¬ä¸‰ä¸ªï¼Œæ ¹æ®æ„æ€å¯ä»¥å¾—çŸ¥ï¼Œä»XXiconViewï¼Œæ˜¯å¦ç«‹å³æ˜¾ç¤ºã€‚æ ¸å¿ƒå°±åœ¨äºè¿™å„¿äº†ã€‚æœ€åï¼Œæˆ‘ä»¬å†æ‰“å°ä¸€éSBIconViewçš„æ‰€æœ‰å±æ€§ï¼Œç”¨æ¥ç¡®è®¤ä¸€ä¸‹</p>

<p><img src="/images/nixiangqudong008.png" title="Caption" ></p>

<p>ç»§ç»­æœç´¢å…³é”®è¯ï¼Œæœç„¶åˆæœ‰å¤§æ”¶è·_shortcutMenuPeekGestureæœ‰ä¸€ä¸ªå¦‚æ­¤æ‰‹åŠ¿ï¼Œé‡Œè¾¹çš„ä¸œè¥¿çš„æ‰‹åŠ¿ã€‚</p>

<p><img src="/images/nixiangqudong009.png" title="Caption" ></p>

<p>çŒœæµ‹å¾—åˆ°äº†æå¤§çš„è‚¯å®šï¼Œä¸‹é¢å°±å¼€å§‹ç¼–å†™tweakäº†
ç”±äºæ˜¯è¦ç»™æ¯ä¸€ä¸ªiconViewéƒ½æ·»åŠ æ‰‹åŠ¿ï¼Œå¹¶ä¸”åªæ·»åŠ ä¸€æ¬¡ï¼Œæ‰€ä»¥ç¿»çœ‹äº†iconViewå¤´æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä»–çš„initæ–¹æ³•ï¼Œé€‰æ‹©äº†åœ¨initWithContentTypeä¸­åˆå§‹åŒ–ã€‚
è´´ä¸ŠTweak.xmçš„æºç 
å…³äºä»£ç çš„ç¼–å†™ï¼Œä¸­é—´ä¹Ÿè¸©è¿‡ä¸å°‘å‘ï¼Œæ¯”å¦‚_revealMenuForIconViewä¸­çš„yesï¼Œnoçš„è®¾ç½®ï¼Œè¿˜å¥½ä¸€å¼€å§‹çŒœçš„æ—¶å€™å°±å…¨éƒ¨æ‰‹åŠ¨èµ‹å€¼ã€‚
è‡³äºæ‰‹åŠ¿ä¸ºä»€ä¹ˆä¼ å€¼éœ€è¦å¦‚æ­¤æ€ªå¼‚ï¼Œå› ä¸ºæ£€æµ‹å‘ç°åŸæ–¹æ³•åªè¯†åˆ«é•¿æŒ‰æ‰‹åŠ¿ï¼Œå¹¶ä¸è¯†åˆ«è½»æ‰«æ‰‹åŠ¿ï¼Œä½†æ˜¯å› ä¸ºä¸ªäººä¹ æƒ¯ï¼Œä¸æƒ³è¦†ç›–ç³»ç»Ÿçš„æ‰‹åŠ¿ï¼Œåªæƒ³å•çº¯çš„å¢åŠ ä¸€ä¸ªåŠŸèƒ½ã€‚è€¿ç›´çš„æ¥¼ä¸»å°è¯•å°†ä¸€ä¸ªè½»æ‰«æ‰‹åŠ¿ï¼Œå¼ºè¡Œå˜æˆé•¿æŒ‰æ‰‹åŠ¿ã€‚å¾ˆå¤šå±æ€§éƒ½æ˜¯readonlyï¼Œä½†æ˜¯è¿™ä¸ªä½¿ç”¨kvcè½»æ¾æå®šï¼Œç°åœ¨è½»æ‰«ä¸€ä¸‹æ‰‹æœºï¼å‡ºç°äº†æ„æƒ³ä¹‹ä¸­çš„å¼¹çª—ï¼
ä»£ç :</p>

<pre><code>#import "ZZ3DTouch.h"

%hook SBIconView 

- (id)initWithContentType:(id)arg1{
// è®¾ç½®3Dtouchæ‰‹åŠ¿
  // æ‰‹åŠ¿ä¼ è¿‡å»çš„å°±æ˜¯æ‰‹åŠ¿è‡ªå·±æœ¬èº«,æœ¬èº«æ‹¥æœ‰æ‰€åœ¨çš„view
  self.shortcutMenuPeekGesture = [[%c(UISwipeGestureRecognizer) alloc] initWithTarget:[%c(SBIconController) sharedInstance] action:@selector(_handleShortcutMenuPeek:)];
  self.shortcutMenuPeekGesture.direction = UISwipeGestureRecognizerDirectionUp;

  return %orig;
}

%end

%hook SBIconController

- (void)_revealMenuForIconView:(id)arg1 presentImmediately:(BOOL)arg2 {

  // yes æ”¹ä¸ºnoä¹‹åæ²¡æœ‰æ˜¾ç¤ºï¼Œæˆ–è€…æ²¡æœ‰è®¾ç½®ä¹Ÿä¼šä¸æ˜¾ç¤º

  %orig(iconView, YES);

}

- (void)_handleShortcutMenuPeek:(id)arg1

{
  UISwipeGestureRecognizer *swipe = arg1;
  UILongPressGestureRecognizer *press = [[UILongPressGestureRecognizer alloc] init];
  [press setValue:@(UIGestureRecognizerStateBegan) forKey:@"state"];
  [press setValue:swipe.view forKey:@"view"];

%orig(press);

}
%end
</code></pre>

<p><img src="/images/nixiangqudong010.png" title="Caption" ></p>

<p><img src="/images/nixiangqudong011.png" title="Caption" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[æ¸¸æˆåç¼–è¯‘]]></title>
    <link href="http://al1020119.github.io/blog/2016/03/30/youxifanbianyi/"/>
    <updated>2016-03-30T13:32:08+08:00</updated>
    <id>http://al1020119.github.io/blog/2016/03/30/youxifanbianyi</id>
    <content type="html"><![CDATA[<p> ipaæ¸¸æˆåç¼–è¯‘
çœ‹ä¸æ‡‚çš„è¯·é£˜è¿‡ï¼Œä¸è¦ç»§ç»­ã€‚
è¿™ä¸æ˜¯ç»™æ–°æ‰‹çœ‹çš„ï¼Œä¹Ÿä»£è¡¨ä½ ä¸éœ€è¦è§£å†³ç¨‹åºçš„ä¿®æ”¹é—®é¢˜ã€‚
è¿™äº›æŠ€å·§ä¸åªç”¨äºæ¸¸æˆçš„ä¿®æ”¹ã€‚</p>

<p>ä¸‹è¼‰ Windows å·¥å…·</p>

<p>Windows :
winscp <a href="http://winscp.net/eng/download.php">http://winscp.net/eng/download.php</a>
PuTTY <a href="http://putty.very.rulez.org/latest/x86/putty.exe">http://putty.very.rulez.org/latest/x86/putty.exe</a></p>

<p>Mac / Linux :
ç”¨å…§ç½®çš„ Terminal ä¾¿å¯</p>

<p>æ²¡ wifi ç”¨ iPhone Tunnel Suite 3.0
<a href="http://bbs.weiphone.com/read-htm-tid-597149.html">http://bbs.weiphone.com/read-htm-tid-597149.html</a></p>

<p>è‹¹æœç”µè„‘ç”¨ iPhoneSSH
<a href="http://bbs.weiphone.com/read-htm-tid-720564.html">http://bbs.weiphone.com/read-htm-tid-720564.html</a></p>

<p>iPhone/iPod Touch åœ¨ cydia å…§å®‰è£ deb åŒ…
å®‰è£…è¿™äº› deb åŒ…æœ€æ–¹ä¾¿çš„æ–¹æ³•æ˜¯åœ¨ Cydia å†…æœç´¢åŠç›´æ¥å®‰è£…ï¼Œè¿™é‡Œæä¾›çš„ä¸‹è½½åŒ…åŠä¾èµ–åŒ…çš„é“¾æ¥ä¸‹è½½ç‚¹æ˜¯æ–¹ä¾¿æ‰‹å·¥å®‰è£…æ—¶ç”¨</p>

<p>OpenSSH (openssh) åŠ OpenSSL(openssl) ï¼ˆä¸iPhone/iPod Touch ç»ˆç«¯æ“ä½œï¼‰
<a href="http://apt.saurik.com/debs/openssh_5.2p1-8_iphoneos-arm.deb">http://apt.saurik.com/debs/openssh_5.2p1-8_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/openssl_0.9.8k-9_iphoneos-arm.deb">http://apt.saurik.com/debs/openssl_0.9.8k-9_iphoneos-arm.deb</a></p>

<p>unzip åŠ zip ï¼ˆè§£å‹ç¼©åŠå‹ç¼©æ‰“åŒ…å·¥å…·ï¼‰
<a href="http://apt.saurik.com/debs/unzip_5.52-5_iphoneos-arm.deb">http://apt.saurik.com/debs/unzip_5.52-5_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/zip_2.32-5_iphoneos-arm.deb">http://apt.saurik.com/debs/zip_2.32-5_iphoneos-arm.deb</a></p>

<p>vbindiff (iPhone ä¸Šçš„åå…­è¿›åˆ¶æŸ¥çœ‹å·®å¼‚åŠä¿®æ”¹å™¨)
<a href="http://apt.saurik.com/debs/vbindiff_3.0b1-3_iphoneos-arm.deb">http://apt.saurik.com/debs/vbindiff_3.0b1-3_iphoneos-arm.deb</a></p>

<p>Link Identity Editor (ldid) åŠ Darwin CC Tools (odcctools)ï¼ˆä¿®æ”¹åç”¨ ldid ç­¾å, odcctools åŒ…æ‹¬ otool, linker , assembleræ±‡ç¼–)
<a href="http://apt.saurik.com/debs/ldid_610-5_iphoneos-arm.deb">http://apt.saurik.com/debs/ldid_610-5_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/odcctools_286-8_iphoneos-arm.deb">http://apt.saurik.com/debs/odcctools_286-8_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/uuid_1.6.0-2_iphoneos-arm.deb">http://apt.saurik.com/debs/uuid_1.6.0-2_iphoneos-arm.deb</a></p>

<p>Diff Utilities (diffutils) (æ–‡æœ¬å·®å¼‚å·¥å…· diff)
<a href="http://apt.saurik.com/debs/diffutils_2.8.1-6_iphoneos-arm.deb">http://apt.saurik.com/debs/diffutils_2.8.1-6_iphoneos-arm.deb</a></p>

<p>less (æ–‡æœ¬æŸ¥çœ‹å·¥å…·)
<a href="http://apt.saurik.com/debs/less_418-3_iphoneos-arm.deb">http://apt.saurik.com/debs/less_418-3_iphoneos-arm.deb</a></p>

<p>Vi IMproved (vim) æˆ– nano (æ–‡æœ¬ç¼–è¾‘å·¥å…·)
<a href="http://apt.saurik.com/debs/vim_7.1-3_iphoneos-arm.deb">http://apt.saurik.com/debs/vim_7.1-3_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb">http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb</a>
æˆ–
<a href="http://apt.saurik.com/debs/nano_2.0.7-5_iphoneos-arm.deb">http://apt.saurik.com/debs/nano_2.0.7-5_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb">http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb</a></p>

<p>GNU Debugger (gdb) (ç¨‹åºè°ƒè¯•å·¥å…·) iOS 4.3.x æ›´æ–°
<a href="http://apt.saurik.com/debs/gdb_1518-11_iphoneos-arm.deb">http://apt.saurik.com/debs/gdb_1518-11_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb">http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/readline_6.0-7_iphoneos-arm.deb">http://apt.saurik.com/debs/readline_6.0-7_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3_3.5.9-12_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3_3.5.9-12_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3-lib_3.5.9-2_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3-lib_3.5.9-2_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3-dylib_3.5.9-1_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3-dylib_3.5.9-1_iphoneos-arm.deb</a></p>

<p>GNU Debugger (gdb) (ç¨‹åºè°ƒè¯•å·¥å…·)
<a href="http://apt.saurik.com/debs/gdb_962-5_iphoneos-arm.deb">http://apt.saurik.com/debs/gdb_962-5_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb">http://apt.saurik.com/debs/ncurses_5.7-9_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/readline_6.0-7_iphoneos-arm.deb">http://apt.saurik.com/debs/readline_6.0-7_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3_3.5.9-12_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3_3.5.9-12_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3-lib_3.5.9-1_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3-lib_3.5.9-1_iphoneos-arm.deb</a>
<a href="http://apt.saurik.com/debs/sqlite3-dylib_3.5.9-1_iphoneos-arm.deb">http://apt.saurik.com/debs/sqlite3-dylib_3.5.9-1_iphoneos-arm.deb</a></p>

<p>adv-cmds (ps å·¥å…·)
<a href="http://apt.saurik.com/debs/adv-cmds_119-5_iphoneos-arm.deb">http://apt.saurik.com/debs/adv-cmds_119-5_iphoneos-arm.deb</a></p>

<p>grep (grep æ–‡æœ¬æœç´¢å·¥å…·)
<a href="http://apt.saurik.com/debs/grep_2.5.4-3_iphoneos-arm.deb">http://apt.saurik.com/debs/grep_2.5.4-3_iphoneos-arm.deb</a></p>

<p>ARM å‚è€ƒä¹¦ç±</p>

<p><a href="http://bbs.weiphone.com/read-htm-tid-363306.html">http://bbs.weiphone.com/read-htm-tid-363306.html</a></p>

<p>ARMæŒ‡ä»¤é›†åŠä½¿ç”¨æ–¹æ³•</p>

<p>ARM System Developer&rsquo;s Guide (ä¸»è¦æ˜¯çœ‹ç¬¬ä¸‰ç«  Chapter 3)</p>

<p>ARM Assembly Language Programming</p>

<p>ä¿®æ”¹åŠç”¨ gdb è°ƒè¯•æ¸¸æˆæµç¨‹</p>

<p>(1) å®‰è£…åŠè¯•ç©æ¸¸æˆï¼Œæ¯ä¸ªæ¸¸æˆçš„ä¿®æ”¹æ–¹æ³•éƒ½ä¸åŒï¼Œæ²¡æœ‰ç©è¿‡è¿™æ¸¸æˆï¼Œæ€æ ·çŸ¥é“è¦ä¿®æ”¹ä»€ä¹ˆå‘¢ï¼Ÿ
è¿™æ•™ç¨‹ç”¨äº† Final Fantasy 2 ä½œä¾‹å­</p>

<p>(2) ç”¨ iTunes å®‰è£… Final Fantasy 2 ç ´è§£ç‰ˆæœ¬ (æœªç ´è§£çš„ä¸èƒ½åæ±‡ç¼–)</p>

<p>(3) ç”¨putty / ssh è¿æ¥iPhone / iPod Touchï¼Œå‡è®¾ä½ çš„iPhone / iPod Touch çš„IPåœ°å€æ˜¯192.168.1.104</p>

<p>Connection type: é€‰ SSH
Port é€‰ 22
æŒ‰ Open</p>

<p>PuTTY è¿æ¥ 192.168.1.104 å</p>

<p>Login æ‰“ root
Password(å‡è®¾ä½ æ²¡æœ‰æ›´æ”¹å¯†ç ) æ‰“ alpine</p>

<p>Mac / Linux Terminal å†…æ‰“
ssh <a href="&#109;&#x61;&#105;&#108;&#116;&#x6f;&#58;&#114;&#111;&#x6f;&#116;&#64;&#49;&#57;&#x32;&#46;&#49;&#54;&#x38;&#46;&#49;&#x2e;&#49;&#x30;&#52;">&#114;&#x6f;&#111;&#116;&#x40;&#x31;&#57;&#50;&#x2e;&#49;&#54;&#56;&#46;&#49;&#46;&#x31;&#x30;&#52;</a></p>

<p>(4) è¿›å…¥æ¸¸æˆè·¯å¾„ç›®å½•å†…(å…ˆå†³æ¡ä»¶æ˜¯å·²ç”¨ PuTTy / Terminal è¿æ¥iPhone / iPod Touch)
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cd /var/mobile/Applications/*/FinalFantasy2.app
</code></pre>

<p>(5) åˆ°ä¸Šä¸€å±‚è·¯å¾„ç›®å½•å»ºç«‹ cheat ä¸´æ—¶å·¥ä½œè·¯å¾„ç›®å½•åŠæ¸¸æˆç¨‹å¼ä¸´æ—¶ä¿®æ”¹æ¡£
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cd ..
mkdir -p cheat
cd cheat
cp -p ../FinalFantasy2.app/FinalFantasy2 FinalFantasy2.original
</code></pre>

<p>(6) åæ±‡ç¼–åŸæ¸¸æˆç¨‹å¼
å¤åˆ¶ä»£ç </p>

<pre><code>otool -tv FinalFantasy2.original &gt; FinalFantasy2.original.txt
</code></pre>

<p>(7) æŸ¥çœ‹åæ±‡ç¼–ä»£ç åˆ†æå¹¶æ‰¾å‡ºè¦ä¿®æ”¹çš„åœ°æ–¹(æ¯ä¸ªæ¸¸æˆçš„ä¿®æ”¹åœ°æ–¹éƒ½ä¸åŒ, è¿™ç‚¹æœ€éš¾)
è¦ä¿®æ”¹æ¸¸æˆï¼Œä½ ä¼šæœ‰ä»¥ä¸‹çš„å›°éš¾æˆ–é—®é¢˜ï¼š</p>

<p>(i) æ²¡æœ‰é«˜é˜¶æºä»£ç ï¼Œåªæœ‰åæ±‡ç¼–ä»£ç 
åæ±‡ç¼–ä»£ç åˆ†ææ˜¯å›°éš¾çš„ä½†ç»å¯¹ä¸æ˜¯ä¸å¯èƒ½ä½œåˆ†æï¼Œä½ å¯ä»¥æ‰¾åˆ°äº›ä¸é”™çš„ARM Assemblyçš„å‚è€ƒä¹¦
åœ¨ä¸Šé¢äº¦å·²æä¾›äº†ä¸€äº›å¾ˆå¥½çš„ ARM æŒ‡ä»¤å‚è€ƒ
å¸¸è§çš„æ˜¯ä»¥ä¸‹è¿™äº›åŸºæœ¬çš„æŒ‡ä»¤åŠå…¶æ‰§è¡Œæ¡ä»¶ç ï¼š</p>

<p>MOV æˆ– MVN å¯„å­˜å™¨æ•°å€¼çš„ä¼ é€æ“ä½œ
ADD æˆ– SUB åŠ å‡çš„ç®—æœ¯æ“ä½œ
CMP æˆ– CMN æ¯”è¾ƒæ“ä½œ
ANDã€ORRã€EOR é€»è¾‘æ“ä½œ
Bã€BLã€BNEã€BGE åˆ†æ”¯/è·³è½¬æŒ‡ä»¤
MUL ä¹˜æ³•æ“ä½œ æˆ– LSL æ˜¯ äºŒè¿›åˆ¶å·¦ç§»ï¼Œå·¦ç§»ä¸€ä½ï¼Œå³åè¿›åˆ¶ä¹˜2å€
LDR æˆ– STR åŠ è½½åŠå­˜å‚¨æ•°æ®</p>

<p>æ¯ä¸ªæŒ‡ä»¤éƒ½å¯åŠ ä¸Šæ‰§è¡Œæ¡ä»¶ç æ ¹æ®ä¸Šä¸€ä¸ªè¿ç®—ã€é€»è¾‘æˆ–æ¯”è¾ƒæŒ‡ä»¤çš„ç»“æœå†³å®šæ˜¯å¦æ‰§è¡ŒæŒ‡ä»¤</p>

<p>æ‰§è¡Œæ¡ä»¶ç  (Condition Codes)ï¼š
â‘  CS åŠ CCï¼ˆCarryï¼‰è¿›ä½æ¡ä»¶ç ï¼ŒCSï¼è¿›ä½ï¼Œå¦åˆ™ï¼CC(ä¸è¿›ä½).
â‘¡ EQ åŠ NE ï¼ˆEqual æˆ– Zeroï¼‰ç›¸ç­‰æˆ–é›¶æ¡ä»¶ç ï¼ŒEQï¼è¿ç®—ç»“æœä¸ºç›¸ç­‰æˆ–é›¶æ—¶ï¼Œå¦åˆ™ï¼NE(ä¸ç›¸ç­‰).
â‘¢ VS åŠ VCï¼ˆOverflowï¼‰æº¢å‡ºæ¡ä»¶ç ã€‚ VS=æº¢å‡ºï¼Œå¦åˆ™ï¼VC(ä¸æº¢å‡º)ã€‚
â‘£ PL åŠ MI æ¡ä»¶ç ã€‚ PLï¼ˆPlus/Positiveï¼‰ï¼ç»“æœä¸ºæ­£ï¼ŒMIï¼ˆMinus/Negativeï¼‰ï¼ç»“æœä¸ºè´Ÿã€‚</p>

<p>â‘¤ GT åŠ LT æ¡ä»¶ç ã€‚ GTï¼ˆGreater Thanï¼‰ï¼å¤§äº(PL+VC+NE / MI+VS+NE)ï¼ŒLTï¼ˆLess Thanï¼‰ï¼å°äº(MI+VC / PL+VS)ã€‚
â‘¥ GE åŠ LE æ¡ä»¶ç ã€‚ GEï¼ˆGreater Than or Equalï¼‰ï¼å¤§æˆ–ç­‰äº(PL+VC / MI+VS)ï¼ŒLEï¼ˆLess Than or Equalï¼‰ï¼å°æˆ–ç­‰äº(MI+VC / PL+VS / EQ)ã€‚
â‘¦ HI åŠ LO æ¡ä»¶ç ã€‚ HIï¼ˆHigher Thanï¼‰ï¼æ— ç¬¦å·æ•°(unsigned)é«˜äº(CS+NE)ï¼ŒLOï¼ˆLower Thanï¼‰ï¼æ— ç¬¦å·æ•°(unsigned)ä½äº(CC)ã€‚
â‘§ HS åŠ LS æ¡ä»¶ç ã€‚ HSï¼ˆHigher or Sameï¼‰ï¼æ— ç¬¦å·æ•°(unsigned)é«˜äºæˆ–ç›¸ç­‰(CS/EQ)ï¼ŒLSï¼ˆLower or Sameï¼‰ï¼æ— ç¬¦å·æ•°(unsigned)ä½äºæˆ–ç›¸ç­‰(CC/EQ)ã€‚
â‘¨ AL åŠ NV æ¡ä»¶ç ã€‚ æ¡ä»¶ç é»˜è®¤ä¸ºALï¼ˆAlwaysï¼‰ï¼æ— æ¡ä»¶æ‰§è¡Œï¼ŒNVï¼ˆNeverï¼‰æ˜¯ALçš„ç›¸åï¼ä¸æ‰§è¡Œã€‚</p>

<p>ä¾‹å­åŠå…¶æ³¨è§£æ„æ€
å¤åˆ¶ä»£ç </p>

<p>CMP R0, R1       @å¯„å­˜å™¨æ•°å€¼ R0 åŠ R1 çš„æ¯”è¾ƒ
MOVGT R2, R0     @å¦‚æœç»“æœ R0 >(å¤§äº) R1ï¼Œåˆ™æ‰§è¡ŒMOV R2, R0å³ R2ï¼R0
MOVLE R2, R1     @å¦‚æœç»“æœ R0 &lt;=(å°æˆ–ç­‰äº) R1ï¼Œåˆ™æ‰§è¡ŒMOV R2, R1å³ R2ï¼R1</p>

<p>å¤åˆ¶ä»£ç </p>

<p>LDR R1, [R0]     @æ„æ€æ˜¯ R1 = <em>R0ï¼Œä»R0æŒ‡å‘çš„åœ°å€å¤„çš„æ•°æ®è½½å…¥åˆ°å¯„å­˜å™¨ R1
STR R1, [R0]     @æ„æ€æ˜¯ </em>R0 = R1ï¼ŒæŠŠå¯„å­˜å™¨ R1å†…çš„æ•°æ®å†™åˆ° R0 å†…æŒ‡å‘çš„åœ°å€å¤„</p>

<p>ARM æŒ‡ä»¤é›†åŠä½¿ç”¨æ–¹æ³•</p>

<p>(ii) çœ‹ä¸æ‡‚æ¸¸æˆç¨‹å¼æµç¨‹ï¼Œæ²¡æ³•åˆ†æ
æœ‰å¾ˆå¤šäººéƒ½å–œæ¬¢ç”¨ IDA Pro Advanced å»åšåˆ†æï¼Œ æ— ç–‘è¿™è½¯ä»¶æ˜¯ä¸ªéå¸¸å¥½çš„é™æ€åˆ†æå·¥å…·ï¼Œå®ƒæœ‰å›¾å½¢è§†å›¾æ˜¾ç¤ºä»£ç æµç¨‹ä½œæœç´¢åŠæ·±å±‚åˆ†æã€‚é™¤äº†å¯åˆ†æåæ±‡ç¼–ä»£ç å¤–ï¼Œäº¦å¯åæ±‡ç¼–ä¸€äº› otool ä¸èƒ½å¤„ç†çš„å·¥ä½œã€‚ ä½† IDA Pro Advanced åœ¨iPhone çš„ç¨‹å¼åªé€‚åˆåšé™æ€çš„åˆ†æã€‚</p>

<p>ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ IDA Pro Advanced 5.2 åŠå…¶å‚è€ƒä¹¦ï¼Œå»ºè®®ä½ ä½¿ç”¨åŠŸèƒ½åŠè§†å›¾æ¯”è¾ƒå¼ºå¤§çš„ Windows ç‰ˆæœ¬ã€‚
<a href="http://bbs.weiphone.com/read-htm-tid-363306.html">http://bbs.weiphone.com/read-htm-tid-363306.html</a></p>

<p>åªçœ‹ä»£ç æ˜¯ä¸èƒ½ä½œåˆ†æï¼Œè¦é…åˆåŠ¨æ€è°ƒè¯•å»äº†è§£ç¨‹å¼çš„ç»†èŠ‚åœ¨å®é™…è¿è¡Œæ—¶å‘ç”Ÿçš„æ•°æ®åŠå˜åŒ–ã€‚åœ¨ç¬¬15æ­¥å°±æœ‰ç”¨ gdb ä½œåŠ¨æ€è°ƒè¯•çš„ä¾‹å­å»è®¾ç½®æ–­ç‚¹ã€ç»§ç»­ã€è·Ÿè¸ªåŠåˆ†æä»£ç ã€‚gdb çš„å‚è€ƒä¹¦å¯åœ¨ä¸Šé¢çš„é“¾æ¥ä¸‹è½½ã€‚</p>

<p>(iii) æ‰¾ä¸åˆ°æ¸¸æˆçš„æ•°æ®ä¾‹å¦‚é‡‘é’±ï¼Œç»éªŒå€¼ï¼Œè£…å¤‡ï¼Œç­‰çº§æš‚å­˜åœ¨é‚£ï¼Ÿ</p>

<p>å¼•ç”¨</p>

<p>æ–¹æ³•ä¸€ï¼šåœ¨ gdb è®¾ç½®æ–­ç‚¹åˆ†æ
ARM CPU æœ‰ä¸ªç‰¹æ€§ä¾¿æ˜¯ä¸€äº›åŠ å‡è®¡ç®—è¦ä¼ é€åˆ°CPUå¯„å­˜å™¨(register) è¿›è¡Œï¼Œå› æ­¤ä½ ä¼šç»å¸¸çœ‹åˆ°è¿™äº›è¦æ‰¾çš„æ•°æ®ä¼šå…ˆä»å†…å­˜ç”¨LDR æŒ‡ä»¤è½½å…¥åˆ°å¯„å­˜å™¨, ç»è¿‡ä¸€äº›è®¡ç®—(åŠ æˆ–å‡)ååŠé˜²æº¢ä½åˆ¤æ–­åä¾¿ç”¨STR æŒ‡ä»¤å­˜å‚¨è¿™å¯„å­˜å™¨å›å†…å­˜åœ°å€ã€‚</p>

<p>å¦å¤–ç”±äºè¿™äº›ç¨‹å¼å¤§å¤šæ˜¯ç”¨ Objective C æˆ– C++ è¯­è¨€å†™æˆï¼Œè¿™äº›ç¨‹åºå‘˜ä¼šç”¨ä¸€äº›æè¿°æ€§çš„å‡½æ•°åï¼Œä¾‹å¦‚å¸¦æœ‰ Money, Price, Gold, Exp, Item, Life, Level å­—æ®µç­‰ã€‚</p>

<p>åˆ©ç”¨è¿™ä¸¤ç‚¹ä¾¿å¯ä»¥å°†ç¨‹åºé”å®šåœ¨æŸäº›å‡½æ•°ä¸Šï¼Œå†åˆ©ç”¨ gdb è°ƒè¯•å·¥å…·æš‚åœåœ¨æŸäº›ç‚¹ä¸€æ­¥ä¸€æ­¥åœ°å•æ­¥æ‰§è¡ŒåŠæŸ¥çœ‹ä¸€äº›å¯„å­˜å™¨ï¼Œå°è¯æ˜¯å¦ä¸ä½ è¦æ‰¾çš„æ•°æ®æ˜¯å¦æœ‰å…³ã€‚</p>

<pre><code>åœ¨FinalFantasy2 çš„è¿™å®ä¾‹ä¸­, æ˜¯ç”¨è¿™æ–¹æ³•æ‰¾åˆ°ä¿®æ”¹ç‚¹
ç”¨ less å·¥å…·å»æ‰¾å¯» Money
putty / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>less FinalFantasy2.original.txt



åœ¨ less å·¥å…·å…§æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>/Money


å»å¼€å§‹æ‰¾å¯»(æŒ‰ N é”®å»ç»§ç»­æ‰¾å¯»)ï¼Œä¾¿ä¼šæ‰¾åˆ°è¿™æ®µä»£ç åƒæ˜¯è¦å­˜å‚¨é‡‘é’±æ•°æ®(SetMoney)ï¼Œ0007b218æ˜¯è¿›å…¥è¿™æ®µä»£ç çš„å¼€å§‹åœ°å€
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>__ZN14cFF2GlobalWork19sysGAMEPrm_SetMoneyEj:
0007b218 e59f300c ldr r3, [pc, #12] ; 0x7b22c
0007b21c e580120c str r1, [r0, #524]
0007b220 e1510003 cmp r1, r3
0007b224 8580320c strhi r3, [r0, #524]
0007b228 e12fff1e bx lr



é¦–å…ˆåœ¨iPhoneæˆ–iPod Touch å¼€å§‹Final Fantasy 2 ç›´è‡³æ¸¸æˆå·² ResumeåŠè¿›å…¥æ¸¸æˆã€‚


â‘  åœ¨PuTTY / Terminal æ‰¾FinalFantasy2 çš„è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å·(process id)

PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>ps ax



å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>1115   ??  Ss     1:30.86 /var/mobile/Applications/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/FinalFantasy2.app/FinalFantasy2



æ‰¾åˆ°FinalFantasy2 æ¸¸æˆç°æ—¶è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å·æ˜¯ 1115

â‘¡ ç”¨gdb è¿›å…¥è°ƒè¯•è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å·1115
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>gdb -p 1115



æ­¤æ—¶æ¸¸æˆä¼šæš‚åœï¼ŒéŸ³ä¹ä¹Ÿæš‚åœ

â‘¢ ç”¨gdb è®¾å®šæ–­ç‚¹breakpointåœ¨åå…­è¿›åˆ¶åœ°å€0x7b218

PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>break *0x7b218



â‘£ ç»§ç»­ continue æ¸¸æˆ
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>c



â‘¤ å°†Final Fantasy 2 æ¸¸æˆè¿›å…¥æˆ˜æ–—ï¼Œæˆ˜èƒœåæ¸¸æˆä¼šåœ¨åå…­è¿›åˆ¶åœ°å€0x7b218å¤„åœæ­¢

â‘¥ æš‚åœåï¼Œç¦»å¼€è¿™åˆ†æ”¯__ZN14cFF2GlobalWork19sysGAMEPrm_SetMoneyEj
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>finish



â‘¦ åæ±‡ç¼–ç°æ—¶åœ°å€ä¸Šé¢çš„ä»£ç 
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>disassem $pc-28 $pc


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x0003baac &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 180&gt;: bl 0x78e30 &lt;_ZN14cFF2GlobalWork8InstanceEv&gt;
0x0003bab0 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 184&gt;: mov r4, r0
0x0003bab4 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 188&gt;: bl 0x78e30 &lt;_ZN14cFF2GlobalWork8InstanceEv&gt;
0x0003bab8 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 192&gt;: bl 0x7b230 &lt;_ZN14cFF2GlobalWork19sysGAMEPrm_GetMoneyEv&gt;
0x0003babc &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 196&gt;: add r1, r0, r5
0x0003bac0 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 200&gt;: mov r0, r4
0x0003bac4 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG 204&gt;: bl 0x7b218 &lt;_ZN14cFF2GlobalWork19sysGAMEPrm_SetMoneyEj&gt;



è¿™æ—¶ä¼šå‘ç°åœ¨_ZN14cFF2GlobalWork19sysGAMEPrm_GetMoneyEv
</code></pre>

<p>åŠ_ZN14cFF2GlobalWork19sysGAMEPrm_SetMoneyEj
ä¸­é—´0x0003babc åœ°å€çš„ä»£ç add r1, r0, r5 æ˜¯æœ€å¯ç–‘çš„</p>

<pre><code>â‘§ å–æ¶ˆæ–­ç‚¹1åŠè®¾å®šæ–°æ–­ç‚¹breakpointåœ¨åå…­è¿›åˆ¶åœ°å€0x0003babc åŠé‡æ–°ç»§ç»­continue æ¸¸æˆ
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>disable 1
break *0x3babc
c



åœ¨iPhoneæˆ–iPod TouchæŸ¥çœ‹ç°æ—¶æ¸¸æˆçš„é‡‘é’±ä¾‹å¦‚æ˜¯4888ï¼Œå°†Final Fantasy 2 æ¸¸æˆè¿›å…¥æˆ˜æ–—ï¼Œæˆ˜èƒœåæ¸¸æˆä¼šæ–°æ–­ç‚¹2åœ°å€0x3babcå¤„åœæ­¢

â‘¨ å½“æ¸¸æˆåœ¨æ–°æ–­ç‚¹2æš‚åœæ—¶æŸ¥çœ‹å¯„å­˜å™¨å°±å‘ç° r0 æ˜¯å½“æ—¶çš„é‡‘é’±ä½™é¢åŠ r5 æ˜¯æˆ˜èƒœåå¾—åˆ°çš„é‡‘é’±
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>i r $r0 $r1 $r5 $pc



â‘© å‡è®¾å·²æ‰¾åˆ°åº”ä¿®æ”¹çš„åœ°å€æ˜¯ 0003babcï¼Œä¾¿å¯ç»§ç»­ä¸‹é¢ç¬¬(8)æ­¥
</code></pre>

<p>å¼•ç”¨</p>

<p>æ–¹æ³•äºŒï¼šåœ¨ gdb æœç´¢å†…å­˜æ•°æ®å€¼åŠè®¾ç½®è§‚å¯Ÿç‚¹(watchpoint)</p>

<pre><code>æ¸¸æˆçš„æ•°æ®éƒ½ä¼šæš‚å­˜åœ¨å †(heap)å†…å­˜, äºæ¸¸æˆé€€å‡ºå‰å‚¨å­˜åœ¨ iPhone æˆ– iPod Touchçš„é—ªå­˜è®°å¿†ä½“å†…, ä¸€äº›ç»éªŒå€¼æˆ–é‡‘é’±çš„æ•°å­—æ˜¯æ¯”è¾ƒç‹¬ç‰¹ï¼Œåœ¨å†…å­˜é‡å¤å‡ºç°çš„æœºä¼šä¸å¤šï¼Œè¿™äº›å”¯ä¸€çš„æ•°å­—ä¾¿å¯ç”¨è¿™æ–¹æ³•å»è¿›è¡Œæœç´¢ã€‚

è¿™é‡Œç”¨äº† Zenonia 2 v1.0 ä½œä¾‹å­ï¼Œä¸‹é¢çš„æ¸¸æˆæˆªå›¾ä¾¿çœ‹åˆ°ç”¨ä¸€ä¸ªç‹¬ç‰¹çš„ç»éªŒå€¼æ•°å­— 672 å»å¼€å§‹è¿™æ–¹æ³•



â‘  åœ¨ PuTTY / Terminal ç”¨  ps ax  çš„æŒ‡ä»¤æ‰¾åˆ° ZENONIA2 æ¸¸æˆç°æ—¶è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å·æ˜¯ 1123

â‘¡ ä½¿ç”¨ gdb è¿›å…¥è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å· 1123
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>gdb -p 1123



æ­¤æ—¶æ¸¸æˆä¼šæš‚åœï¼ŒéŸ³ä¹ä¹Ÿæš‚åœ

â‘¢ ç”¨ gdb è¾“å…¥è¿™äº›æŒ‡ä»¤åŒ…æ‹¬ï¼Œå†…å­˜å¼€å§‹åœ°å€(0x800000)ã€ç»“æŸåœ°å€(0x880000)åŠè¦æœç´¢çš„æ•°å­—672å¦‚ä¸‹:

PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>set $x=0x800000
while(*++$x!=672 &amp;&amp; $x&lt;0x880000)
end



â‘£ è¾“å…¥ end ä¹‹åç­‰å€™æ•°åç§’ ....ï¼Œå¾…gdbå»æœç´¢è¿™æ®µå†…å­˜åœ°å€

â‘¤ gdb æœç´¢å®Œæ¯•å
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>p/x $x


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>$1 = 0x85e28c
</code></pre>

<p>è¿™ä»£è¡¨ gdb å·²æ‰¾åˆ°åœ¨ 0x85e28c çš„å†…å­˜åœ°å€çš„å­˜å‚¨æ•°å­—æ˜¯ 672</p>

<pre><code>PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>x/dw 0x85e28c


å¾—åˆ°ç¡®è®¤ 0x85e28c çš„å†…å­˜åœ°å€çš„å­˜å‚¨æ•°å­—æ˜¯ 672
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x85e28c:    672



 â‘¥ ç”¨ gdb ç»§ç»­æœç´¢
PuTTY / Terminal æ‰“ (æˆ–æŒ‰æ–¹å‘é”® â†‘ 4æ¬¡ï¼Œç„¶åå›è½¦ï¼Œå…é‡å¤è¾“å…¥)
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>while(*++$x!=672 &amp;&amp; $x&lt;0x880000)
end


å†ç­‰åå¤šç§’ï¼Œgdb æœç´¢å®Œæ¯•å
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>p/x $x


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>$2 = 0x880000
</code></pre>

<p>è¿™ä»£è¡¨ gdb å·²åˆ°ç»“æŸçš„åœ°å€ 0x880000ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°ã€‚è¿™ä¹Ÿè¡¨ç¤ºæ•°å­— 672 æ˜¯å”¯ä¸€å‡ºç°åœ¨ 0x85e28c è¦æ‰¾çš„å†…å­˜èŒƒå›´å†…ã€‚</p>

<pre><code>â‘¦ ç”¨ gdb æ›´æ”¹å†…å­˜åœ°å€ 0x85e28c çš„å­˜å‚¨æ•°å­—ä¸º 1000
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>set {int}0x85e28c=1000



PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>x/dw 0x85e28c



å¾—åˆ°ç¡®è®¤å·²æˆåŠŸæ›´æ”¹æ•°å­—
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x85e28c:    1000



â‘§ ç»§ç»­ continue æ¸¸æˆ
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>c



â‘¨ åœ¨å›åˆ°æ¸¸æˆé‡Œé€€å‡º STATUS ç”»é¢å†è¿›å…¥ STATUSï¼Œç”»é¢å†…æ•°æ®é‡åˆ·åï¼Œç¡®è®¤å·²æˆåŠŸæ›´æ”¹ç»éªŒå€¼æ•°å­—ä¸º1000


ç•™æ„:ç”±äºæ¸¸æˆæ•°æ®åœ¨å †(heap)å†…å­˜çš„åœ°å€ä¸æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ¯æ¬¡è¿è¡Œçš„è¿›ç¨‹éƒ½è¦å†æœç´¢æ–°çš„å†…å­˜åœ°å€ã€‚å¦å¤–ï¼Œæœç´¢çš„å†…å­˜åœ°å€èŒƒå›´ä¹Ÿä¼šæ”¹å˜ï¼Œå¦‚æœåœ¨ 0x800000 è‡³ 0x880000 èŒƒå›´å†…æ‰¾ä¸åˆ°çš„è¯ï¼Œå°±è¦å¾€åè¯• 0x880000 è‡³ 0x900000 æ–°çš„èŒƒå›´ã€‚

     å¦å¤–ï¼šç”¨ç›¸åŒæœç´¢æ–¹æ³•ä¹Ÿå¯ä»¥æ‰¾åˆ°é‡‘é’±æ•°å­—åœ¨è¿™æ¬¡è¿è¡Œè¿›ç¨‹æ˜¯åœ¨å†…å­˜åœ°å€ 0x874c04

â‘© æ‰¾åˆ°ç»éªŒå€¼åœ°å€åä¾¿å¯è®¾ç½®è§‚å¯Ÿç‚¹(watchpoint)äºå†…å­˜åœ°å€ 0x85e28c

è®¾ç½®è§‚å¯Ÿç‚¹çš„ç›®çš„æ˜¯å½“å†…å­˜åœ°å€å€¼è¢«è¯»æˆ–è¢«å†™æ—¶ï¼Œä¼šæ˜¾ç¤ºæ•°æ®åŠæš‚åœç¨‹åº

PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>watch *0x85e28c


åŠç»§ç»­æ¸¸æˆ
PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>c
</code></pre>

<p>ç•™æ„:æ¸¸æˆåœ¨è§‚å¯Ÿç‚¹(watchpoint) ç”Ÿæ•ˆä¸‹è¿è¡Œæ˜¯éå¸¸çš„æ…¢ï¼Œæœ‰äº›æ¸¸æˆæ˜¯ä¸èƒ½æ­£å¸¸è¿ä½œï¼Œæœ‰æ—¶å€™æ‰‹æœºä¹Ÿè¦é‡å¯ï¼Œæ‰€ä»¥ä¸‹é¢çš„æ­¥éª¤æ˜¯ä¸ä¸€å®šå¯ä»¥è¿›è¡Œçš„</p>

<pre><code>â‘ª å°†æ¸¸æˆè¿›å…¥æˆ˜æ–—æ‰“æ€ªåç¨‹åºä¾¿ä¼šæš‚åœåœ¨ 0x9f508 åœ°å€ï¼Œgdb ä¼šæ˜¾ç¤º
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>Hardware watchpoint 1: *8774284
Old value = 1000
New value = 1086
0x0009f508 in CMvPlayer::CheckLevelUp ()



PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>x/14i $pc-16


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x9f4f8 &lt;_ZN9CMvPlayer12CheckLevelUpEj+60&gt;:    b.n    0x9f508 &lt;_ZN9CMvPlayer12CheckLevelUpEj+76&gt;
0x9f4fa &lt;_ZN9CMvPlayer12CheckLevelUpEj+62&gt;:    adds    r0, r4, #0
0x9f4fc &lt;_ZN9CMvPlayer12CheckLevelUpEj+64&gt;:    movs    r1, #1
0x9f4fe &lt;_ZN9CMvPlayer12CheckLevelUpEj+66&gt;:    movs    r2, #0
0x9f500 &lt;_ZN9CMvPlayer12CheckLevelUpEj+68&gt;:    subs    r5, r5, r3
0x9f502 &lt;_ZN9CMvPlayer12CheckLevelUpEj+70&gt;:    bl    0x9f338 &lt;_ZN9CMvPlayer9OnLevelUpEii&gt;
0x9f506 &lt;_ZN9CMvPlayer12CheckLevelUpEj+74&gt;:    movs    r3, #1
0x9f508 &lt;_ZN9CMvPlayer12CheckLevelUpEj+76&gt;:    str    r5, [r4, r6]
0x9f50a &lt;_ZN9CMvPlayer12CheckLevelUpEj+78&gt;:    cmp    r3, #0
0x9f50c &lt;_ZN9CMvPlayer12CheckLevelUpEj+80&gt;:    beq.n    0x9f516 &lt;_ZN9CMvPlayer12CheckLevelUpEj+90&gt;
0x9f50e &lt;_ZN9CMvPlayer12CheckLevelUpEj+82&gt;:    cmp    r5, #0
0x9f510 &lt;_ZN9CMvPlayer12CheckLevelUpEj+84&gt;:    beq.n    0x9f516 &lt;_ZN9CMvPlayer12CheckLevelUpEj+90&gt;
0x9f512 &lt;_ZN9CMvPlayer12CheckLevelUpEj+86&gt;:    movs    r5, #0
0x9f514 &lt;_ZN9CMvPlayer12CheckLevelUpEj+88&gt;:    b.n    0x9f4c6 &lt;_ZN9CMvPlayer12CheckLevelUpEj+10&gt;



PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>i r $r5 $r4 $r6 $pc
p/x $r4+$r6


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>r5             0x43E    1086
r4             0x85DC00    8772608
r6             0x68c    1676
pc             0x9f508    652552
$5 = 0x85e28c



è¿™æ—¶ç¡®è®¤äº† 0x9f508 åœ°å€è¿™å¥ä»£ç 
str    r5, [r4, r6]
çš„æ„æ€æ˜¯ï¼Œr4 + r6 = 0x85e28c ï¼ŒæŠŠå¯„å­˜å™¨ r5 å†…çš„æ•°å­—(1086) å†™åˆ° 0x85e28c çš„åœ°å€
</code></pre>

<p>ã€€
    ç¨‹åºå› è¦å†™è¿›è¿™0x85e28c çš„åœ°å€ï¼Œæ‰€ä»¥æš‚åœäº†ï¼Œè¿™å°±æ˜¯è§‚å¯Ÿç‚¹(watchpoint) çš„å¼ºå¤§åŠŸèƒ½ã€‚</p>

<pre><code>PuTTY / Terminal æ‰“
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>bt


å¾—åˆ°
</code></pre>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>#0  0x0009f508 in CMvPlayer::CheckLevelUp ()
#1  0x0009ff2e in CMvPlayer::DoUpdate ()
#2  0x00094744 in CMvObject::Update ()
#3  0x000969cc in CMvObjectMgr::Update ()
#4  0x000662e6 in CMvGameState::UpdateGame ()



è¿™æ—¶å°±å¯æ ¹æ®ä¸Šé¢å¾—åˆ°çš„ä¿¡æ¯åœ¨è¿™æ®µä»£ç çš„å‰åèŒƒå›´è¿›è¡Œè·Ÿè¸ªã€è®¾ç½®æ–­ç‚¹åŠè¿›ä¸€æ­¥çš„åˆ†æ
</code></pre>

<p>æœ‰æ–°çš„æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­æ›´æ–° &hellip;&hellip;&hellip;&hellip;</p>

<p>(iv) ä¸çŸ¥é“ä¿®æ”¹ç‚¹åœ¨é‚£åŠæ”¹ä¸ºä»€ä¹ˆï¼Ÿ</p>

<p>ä¿®æ”¹ç¨‹åºæ˜¯ä¸èƒ½æ’å…¥ç¨‹åºä»£ç ï¼Œä¸»è¦åŸå› æ˜¯ç§»ä½åçš„ç¨‹åºæ˜¯ä¸èƒ½è¿è¡Œçš„ã€‚ä¸€èˆ¬çš„åšæ³•æ˜¯æ‰¾åˆ°è¦ä¿®æ”¹çš„ä½ç½®åœ¨åŸæ¡£æ¡ˆä½ç½®ä¿®æ”¹ä»£ç æ”¹ä¸ºä½ éœ€è¦çš„æŒ‡ä»¤ã€‚ ä¿®æ”¹ç‚¹ä¸€å®šè¦ç»è¿‡åˆ†æä»£ç åå†ä¸æ–­åœ°ç”¨åŠ¨æ€åˆ†æç¡®å®šåï¼Œåœ¨é€‚å½“çš„åœ°æ–¹é‡è¦†è¯•éªŒåŠè°ƒè¯•éªŒè¯ä¿®æ”¹åçš„ç»“æœ ã€‚</p>

<ul>
<li>ä¸€äº›RPGæ¸¸æˆçš„ç‰¹æ€§ï¼Œä¾‹å¦‚æ˜¯é‡‘é’±æˆ–ç»éªŒå€¼æ˜¯ä¼šåœ¨æˆ˜æ–—åé‡ç®—åŠæ›´æ–°ï¼Œä¸€èˆ¬éƒ½æ˜¯è¦æ‰¾åˆ°åŠä¿®æ”¹æ›´æ–°æ•°æ®å‰çš„æŒ‡ä»¤ã€‚é‡‘é’±çš„ä¿®æ”¹ç‚¹ä¹Ÿå¯ä»¥ä¿®æ”¹åœ¨ä¹°å–è£…å¤‡æ—¶çš„æŒ‡ä»¤ã€‚è¿ç»­å‡çº§çš„ä¿®æ”¹ä¸»è¦æ˜¯çœ‹è¯¥æ¸¸æˆæ˜¯æ€æ ·å‡çº§ï¼Œä¾‹å¦‚ Inotia 2æ˜¯æ ¹æ®ç»éªŒå€¼å»å‡çº§ï¼Œåªè¦æ‰¾åˆ°åˆ¤æ–­ç»éªŒå€¼çš„æŒ‡ä»¤ä»£ç åœ°å€ï¼Œä¿®æ”¹å…¶åˆ¤æ–­çš„æŒ‡ä»¤ä¾¿å¯ã€‚</li>
</ul>


<p>å¯¹äºæ¸¸æˆæ¥è¯´ï¼Œä¸€èˆ¬çš„æŒ‡ä»¤ä¿®æ”¹ä¾‹å­å¦‚ä¸‹ï¼š</p>

<p>â‘  ä¿®æ”¹å¯„å­˜å™¨çš„å¢åŠ æ•°å­—ä¾‹å¦‚
    Final Fantasy II å¢åŠ æˆ˜èƒœåæ‰€å¾—é‡‘é’±
    åœ°å€ 0003babc
    add r1, r0, r5
    æ”¹ä¸º
    add r1, r0, r5, lsl #5</p>

<p>â‘¡ ä¿®æ”¹å¯„å­˜å™¨å‡å°‘çš„æ•°å­—ä¸ºé›¶ä¾‹å¦‚
    Inotia 2 v 1.1.0 ä¸æ‰£æŠ€èƒ½ç‚¹
    åœ°å€ 00021b9c
    sub r3, #1
    æ”¹ä¸º
    sub r3, #0</p>

<pre><code>åœ°å€ 00037b46 
sub r1, #1 
æ”¹ä¸º 
sub r1, #0 
</code></pre>

<p>â‘¢ ä¿®æ”¹æ¯”è¾ƒçš„å¯„å­˜å™¨ä¾‹å¦‚
    èŠ±å„¿æœµæœµå¼€-v1.0 ä¸æ­»ä½œå¼Šç‰ˆ (è¿™é‡Œ r2 å¯„å­˜å™¨æ˜¯èŠ±æœµå·²ç»½æ”¾çš„æ•°é‡)
    åœ°å€ 00004ee8
    cmp r2, r3
    æ”¹ä¸º
    cmp r2, #1 ; 0x1</p>

<p>â‘£ ä¿®æ”¹arm 32 ä½ä¸ºä¸¤ä¸ªarm thumb 16 ä½ä»£ç ä¾‹å¦‚
    Inotia 2 v 1.1.0 rollç‚¹å…¨18
    åœ°å€ 0005c404
    bl 0x9914
    æ”¹ä¸º
    mov r0, #9
    mov r0, #9</p>

<pre><code>åœ°å€ 0005c404, 0005c40e, 0005c41c, 0005c426 
bl 0x9914 
æ”¹ä¸º 
mov r0, #9 
mov r0, #9 
</code></pre>

<p>â‘¤ è¦åˆ é™¤ä»£ç ä¾¿è¦ç”¨ nop (no operation) å–ä»£
    thumb 16 bits nop æ˜¯ 46c0<br/>
    arm 32 bits nop æ˜¯ e1a00000</p>

<p>(8) åœ¨FinalFantasy2 çš„è¿™å®ä¾‹ä¸­ï¼Œå‡è®¾å·²æ‰¾åˆ°åº”ä¿®æ”¹çš„åœ°å€æ˜¯ 0003babcï¼Œä»£ç æ˜¯ e0801005
å¤åˆ¶ä»£ç </p>

<pre><code>0003bab8        eb00fddc        bl 0x7b230
0003babc        e0801005        add r1, r0, r5   @æ„æ€æ˜¯ r1 = r0 +r5 ; r0 æ˜¯å½“æ—¶çš„é‡‘é’±ä½™é¢; r5 æ˜¯æˆ˜èƒœåå¾—åˆ°çš„é‡‘é’±
0003bac0        e1a00004        mov r0, r4
0003bac4        eb00fdd3        bl 0x7b218     @åˆ†æ”¯åˆ°å‡½æ•°å __ZN14cFF2GlobalWork19sysGAMEPrm_SetMoneyEj å»æ›´æ–°é‡‘éŒ¢ä½™é¢
</code></pre>

<p>(9) ä¿®æ”¹ç›®æ ‡ : å°†æ‰€å¾—é‡‘é’±ä¹˜å¤§32å€
0003babcçš„åº”ä¿®æ”¹ç›®æ ‡ä»£ç æ˜¯
å¤åˆ¶ä»£ç </p>

<pre><code>add r1, r0, r5, lsl#5 @æ„æ€æ˜¯ r1 = r0 +( r5 äºŒè¿›åˆ¶å·¦ç§»äº”ä½,å³åè¿›åˆ¶ä¹˜å¤§32å€)
</code></pre>

<p>(10) æ‰¾æ–°ARMæŒ‡ä»¤ä»£ç 
add r1, r0, r5 çš„ARMæŒ‡ä»¤ä»£ç æ˜¯ e0801005
ä¿®æ”¹ç›®æ ‡æ˜¯è¦æ‰¾åˆ° add r1, r0, r5, lsl#5 çš„ARMæŒ‡ä»¤ä»£ç  ?</p>

<p>ç”¨ vim æˆ– nano å»ºç«‹ armtest.s å¦‚ä¸‹
å¤åˆ¶ä»£ç </p>

<pre><code>    .file "armtest.s"
    .globl _main
    .code 32
_main:
    add r1, r0, r5
    add r1, r0, r5, lsl #5
</code></pre>

<p>ç•™æ„: ä¸€äº›ç¨‹å¼åæ±‡ç¼–åæ˜¯ARM Thumb, ARM Thumb æ˜¯16 bits è€ŒARM æ˜¯32 bits. ARM 32 bits åŠ ARM Thumb çš„åˆ†åˆ«è¯·æ‰¾ä¸Šé¢ ARM Assembler çš„å‚è€ƒ(ARM Thumb çš„å¯ç”¨æŒ‡ä»¤æ˜¯æ¯” ARM 32 bits å°‘)ã€‚ å¦‚æœè¦æ‰¾ ARM Thumb ä»£ç è¦å°†ä¸Šé¢çš„.code 32æ”¹ä¸º.code 16 åŠåŠ ä¸Š .thumb_func _main å¦‚ä¸‹
å¤åˆ¶ä»£ç </p>

<pre><code>    .code 16
    .thumb_func _main
</code></pre>

<p>æ±‡ç¼– arm æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>as armtest.s -o armtest.o ; otool -tv armtest.o
</code></pre>

<p>ä¾¿çœ‹åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>(__TEXT,__text) section
_main:
00000000    e0801005    add r1, r0, r5
00000004    e0801285    add r1, r0, r5, lsl #5
</code></pre>

<p>åŠå¾—åˆ°add r1, r0, r5, lsl #5 ç›®æ ‡ARMæŒ‡ä»¤ä»£ç ä¸º e0801285</p>

<p>(11) å»ºç«‹ä¿®æ”¹ç¨‹å¼ç¬¬ä¸€ç‰ˆFinalFantasy2.v1åŠç”¨åå…­è¿›åˆ¶ä¿®æ”¹å™¨ä¿®æ”¹ä»£ç </p>

<p>æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cp -p FinalFantasy2.original FinalFantasy2.v1      
vbindiff FinalFantasy2.v1
</code></pre>

<p>è¿›å…¥vibindiff åæŒ‰GåŠè¾“å…¥åœ°å€3AABCè·³åˆ°è¦ä¿®æ”¹çš„ä½ç½®å¦‚ä¸‹</p>

<p>ç•™æ„: åœ¨ç¬¬8æ­¥æ—¶æ‰¾åˆ°çš„ä½ç½®æ˜¯0003Babcï¼Œä½†ä¿®æ”¹ç¨‹å¼çš„ä½ç½®è¦å‡å»åå…­è¿›åˆ¶0x1000å¾—åˆ°3Aabc
(0x3babc å‡ 0x1000 ç­‰äº 0x3aabc)</p>

<p>æŒ‰Eé”®å¼€å§‹ä¿®æ”¹ï¼Œå°†
05 10 80 E0
æ”¹ä¸º
85 12 80 E0</p>

<p>ç„¶åæŒ‰Escé”®åŠYé”®ç¡®è®¤ä¿®æ”¹</p>

<p>æœ€åæŒ‰Qé”®ç¦»å¼€ vbindiff ä¿®æ”¹å™¨</p>

<p>å¦‚ä¸‹</p>

<p>ç•™æ„: ä¿®æ”¹å™¨æ˜¾ç¤ºçš„05 10 80 E0ä¸åæ±‡ç¼–çš„ä»£ç e0801005çš„ä½ç½®é¡ºåºæ˜¯å€’çš„</p>

<p>(12) åæ±‡ç¼–ä¿®æ”¹ç¨‹å¼ç¬¬ä¸€ç‰ˆ v1 åŠæ¯”è¾ƒåŸç‰ˆæœ¬ original
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>otool -tv FinalFantasy2.v1 &gt; FinalFantasy2.v1.txt
diff FinalFantasy2.original.txt FinalFantasy2.v1.txt
</code></pre>

<p>ä¹Ÿå¯ä»¥ç”¨ otool -otV</p>

<p>å¾—åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>&lt; FinalFantasy2.original:
---
&gt; FinalFantasy2.v1:
59597c59597
&lt; 0003babc    e0801005    add    r1, r0, r5
---
&gt; 0003babc    e0801285    add    r1, r0, r5, lsl #5
</code></pre>

<p>(13) å¯¹ä¿®æ”¹ç¨‹å¼ç¬¬ä¸€ç‰ˆé‡æ–°ç­¾å
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>ldid -s FinalFantasy2.v1
</code></pre>

<p>(14) å°†ç­¾ååçš„ç¨‹å¼æ”¾å›ç¨‹å¼è·¯å¾„è¿›è¡Œæµ‹è¯•
é¦–å…ˆå¤‡ä»½åŸç¨‹å¼(ç•™æ„:è¦ç”¨mvç§»åŠ¨ä¸è¦ç”¨cp)
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>mv ../FinalFantasy2.app/FinalFantasy2 ../FinalFantasy2.app/FinalFantasy2.bak
</code></pre>

<p>å®‰è£…ä¿®æ”¹åçš„ç¨‹å¼åŠæ›´æ–°æƒé™
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cp -p FinalFantasy2.v1 ../FinalFantasy2.app/FinalFantasy2
chown mobile:mobile ../FinalFantasy2.app/FinalFantasy2
chmod 0755 ../FinalFantasy2.app/FinalFantasy2
</code></pre>

<p>(15) ç”¨ gdb è°ƒè¯•æ¸¸æˆ</p>

<p>è°ƒè¯•æ˜¯ç”¨ gdbï¼Œåœ¨è¿™é‡Œçš„ç›®çš„æ˜¯è®¾ç½®æ–­ç‚¹ä½¿æ¸¸æˆæš‚åœï¼ŒæŸ¥çœ‹CPUçš„å¯„å­˜å™¨ï¼Œå°è¯ä¿®æ”¹æ˜¯å¦æˆåŠŸã€‚ç”±äºæ¸¸æˆå ç”¨å¾ˆå¤šå†…å­˜ï¼Œåœ¨æ¸¸æˆè¿è¡Œæ—¶è°ƒè¯•å†åŠ ssh è¿æ¥å¾ˆå¤šæ—¶å€™éƒ½ä¼šå´©æºƒã€‚æ‰€ä»¥ç”¨ iPod Touch 3ä»£ æˆ– iPhone 3GS åšè¿™é¡¹å·¥ä½œä¼šæœ‰ä¼˜åŠ¿ã€‚</p>

<p>é¦–å…ˆåœ¨iPhoneæˆ–iPod Touch å¼€å§‹Final Fantasy 2 ç›´è‡³æ¸¸æˆå·²ResumeåŠè¿›å…¥æ¸¸æˆã€‚</p>

<p>åœ¨iPhoneæˆ–iPod TouchæŸ¥çœ‹ç°æ—¶æ¸¸æˆçš„é‡‘é’±ä¾‹å¦‚æ˜¯ 7223</p>

<p>â‘  åœ¨putty / Terminal æ‰¾ FinalFantasy2 çš„è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å· (process id)</p>

<p>PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>ps ax
</code></pre>

<p>å¾—åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>1115   ??  Ss     1:30.86 /var/mobile/Applications/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/FinalFantasy2.app/FinalFantasy2
</code></pre>

<p>æ‰¾åˆ° FinalFantasy2 æ¸¸æˆç°æ—¶è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å·æ˜¯ 1115</p>

<p>â‘¡ ç”¨ gdb è¿›å…¥è°ƒè¯•è¿è¡Œä¸­çš„è¿›ç¨‹ç¼–å· 1115
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>gdb -p 1115
</code></pre>

<p>æ­¤æ—¶æ¸¸æˆä¼šæš‚åœï¼ŒéŸ³ä¹ä¹Ÿæš‚åœ</p>

<p>â‘¢ ç”¨ gdb è®¾å®šæ–­ç‚¹breakpointåœ¨åå…­è¿›åˆ¶åœ°å€ 0x3babc (å³åœ¨ç¬¬8æ­¥æ—¶æ‰¾åˆ°çš„ä½ç½®0003babc)
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>break *0x3babc
</code></pre>

<p>â‘£ ç»§ç»­ continue æ¸¸æˆ
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>c
</code></pre>

<p>â‘¤ å°†Final Fantasy 2 æ¸¸æˆè¿›å…¥æˆ˜æ–—ï¼Œæˆ˜èƒœåæ¸¸æˆä¼šåœ¨åå…­è¿›åˆ¶åœ°å€ 0x3babcå¤„åœæ­¢</p>

<p>â‘¥ æš‚åœåï¼ŒæŸ¥çœ‹ CPU å¯„å­˜å™¨ register (info register æŒ‡ä»¤)
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>i r $r0 $r1 $r5 $pc
</code></pre>

<p>å¾—åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>r0             0x1c37    7223
r1             0x25    37
r5             0x25    37
pc             0x3babc    244412
</code></pre>

<p>å°è¯äº† r0=7223 æ˜¯ç°æ—¶çš„é‡‘é’±
æ¸¸æˆæš‚åœåœ¨ pc=0x3babc</p>

<p>â‘¦ æŸ¥çœ‹ä¸‹ä¸€æ­¥å°†è¦è¿è¡Œçš„åæ±‡ç¼–æŒ‡ä»¤
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>x/i $pc
</code></pre>

<p>å¾—åˆ° add r1, r0, r5, lsl #5ï¼Œå°è¯æˆåŠŸä¿®æ”¹æŒ‡ä»¤</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x3babc &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG+196&gt;:    add    r1, r0, r5, lsl #5
</code></pre>

<p>â‘§ è¿è¡Œä¸‹ä¸€æ­¥ stepi æŒ‡ä»¤
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>si
</code></pre>

<p>æŸ¥çœ‹ CPU å¯„å­˜å™¨ register (info register æŒ‡ä»¤)
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>i r $r0 $r1 $r5 $pc
</code></pre>

<p>å¾—åˆ°
å¤åˆ¶ä»£ç </p>

<pre><code>r0             0x1c37    7223
r1             0x20d7    8407
r5             0x25    37
pc             0x3bac0    244416
</code></pre>

<p>æ­¤æ—¶å°è¯äº† r1 = r0 +( r5 x 32)
            = 7223 + (27 x 32)
            = 8407</p>

<p>æŸ¥çœ‹ä¸‹ä¸€æ­¥å°†è¦è¿è¡Œçš„åæ±‡ç¼–æŒ‡ä»¤
putty / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>x/i $pc
</code></pre>

<p>å¾—åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>0x3bac0 &lt;_ZN10FF2cBattle12SENRIHIN_CHKEP12thBATMonsterP6X86REG+200&gt;:    mov    r0, r4
</code></pre>

<p>â‘¨ ç»§ç»­ continue æ¸¸æˆ
PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>c
</code></pre>

<p>â‘© Final Fantasy 2 æ¸¸æˆæ˜¾ç¤ºæˆ˜èƒœåå¾—åˆ°37çš„é‡‘é’±ï¼Œä½†å®é™…é‡‘é’±ä½™é¢æ˜¯ 8407ï¼Œå°è¯ä¿®æ”¹æ¸¸æˆå·²æˆåŠŸã€‚</p>

<p>â‘ª ç¦»å¼€ gdb</p>

<p>æŒ‰ä¸‹Ctrl+C ç»„åˆé”®åœæ­¢æ‰§è¡Œè¿›ç¨‹</p>

<p>PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>quit
</code></pre>

<p>åŠæŒ‰ y é”®ç¡®è®¤ç¦»å¼€ gdb</p>

<p>ç•™æ„:åœ¨ä¸Šé¢ç¬¬â‘¥æ­¥æš‚åœæ—¶ï¼Œä½ å¯ä»¥è¾“å…¥æŒ‡ä»¤å»æ›´æ”¹CPU å¯„å­˜å™¨ register
ä¾‹å¦‚æ‰“
set $r5=1000
å»è¯•è¯•å¢åŠ é‡‘é’±æ•°ç›®</p>

<p>(16) å‡è®¾å·²è°ƒè¯•å®Œæˆï¼Œä¾¿å¯å°†ä¿®æ”¹åçš„ç¨‹å¼æ‰“åŒ…å‘å¸ƒ</p>

<p>è¿›å…¥æ¸¸æˆè·¯å¾„ç›®å½•å†…ï¼Œæ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cd /var/mobile/Applications/*/FinalFantasy2.app
</code></pre>

<p>åˆ°ä¸Šä¸€å±‚è·¯å¾„ç›®å½•
å¤åˆ¶ä»£ç </p>

<pre><code>cd ..
</code></pre>

<p>å»ºç«‹ IPA æ‰€è¦çš„è·¯å¾„åŠæ¡£æ¡ˆåŠåˆ é™¤ä¸éœ€è¦çš„å¤‡ä»½æ¡£æ¡ˆ</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>rm -fr Payload
mkdir -p Payload
cp -pr FinalFantasy2.app Payload/
rm -fr Payload/FinalFantasy2.app/FinalFantasy2*.bak
</code></pre>

<p>æ‰“åŒ… ipa ä¸º FinalFantasy2_v1.ipod4g.ipa
å¤åˆ¶ä»£ç </p>

<pre><code>zip -r FinalFantasy2_v1.ipod4g.ipa Payload iTunesArtwork
</code></pre>

<p>æ‰¾ç°æ—¶çš„è·¯å¾„
å¤åˆ¶ä»£ç </p>

<pre><code>pwd
</code></pre>

<p>å¾—åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>/var/mobile/Applications/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
</code></pre>

<p>ç”¨ winscp æˆ–Terminal çš„ scp æŒ‡ä»¤ä¼ é€è¿™æ¡£ä½œå‘å¸ƒ</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>/var/mobile/Applications/XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX/FinalFantasy2_v1.ipod4g.ipa
</code></pre>

<p>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX æ˜¯éšæœºè·¯å¾„</p>

<p>(17) å…¶ä»–æœ‰ç”¨çš„æŠ€å·§</p>

<p>â‘  ç”±äºä¿®æ”¹æ¸¸æˆçš„ç¨‹å¼ä»£ç æ˜¯å¾ˆå°‘é‡, ç›¸å¯¹é‡è¦†è°ƒè¯•åŠåŠ¨æ€åˆ†æå·¥ä½œæ¯”è¾ƒå¤šï¼Œæ­¤æ•™ç¨‹ä¾¿ä»‹ç»äº†ç”¨iPhone çš„å·¥å…·ç›´æ¥åšä¿®æ”¹åŠåæ±‡ç¼–ã€‚è¿™æ ·å¯¹äºå°‘é‡ä¿®æ”¹ç¨‹å¼ä»£ç åŠé‡è¦†åœ¨iPhoneè°ƒè¯•æ˜¯æ¯”è¾ƒè¦ä¼ å›PCåšä¿®æ”¹æ˜¯æ›´æœ‰æ•ˆç‡çš„ã€‚</p>

<p>â‘¡ è°ƒè¯•çš„å·¥å…· gdb æ˜¯æ¯”è¾ƒéš¾ç”¨ï¼Œä½†æœ‰äº›æ–¹æ³•æ˜¯å¯æé«˜ä½¿ç”¨ gdb çš„æ•ˆç‡ã€‚</p>

<p>ä¾‹å¦‚ï¼šåœ¨ gdb å»ºç«‹å® macro define
åœ¨ iphone å»ºç«‹è¿™æ¡£æ¡ˆ(~/.gdbinit) å†…å®¹ä¸º
å¤åˆ¶ä»£ç </p>

<pre><code>define ascii_char
set $_c=*(unsigned char *)($arg0)
if ( $_c &lt; 0x20 || $_c &gt; 0x7E )
printf "."
else
printf "%c", $_c
end
end
document ascii_char
Print the ASCII value of arg0 or '.' if value is unprintable
end
define hex_quad
printf "%02X %02X %02X %02X  %02X %02X %02X %02X",  \
*(unsigned char*)($arg0), *(unsigned char*)($arg0 + 1),  \
*(unsigned char*)($arg0 + 2), *(unsigned char*)($arg0 + 3), \
*(unsigned char*)($arg0 + 4), *(unsigned char*)($arg0 + 5), \
*(unsigned char*)($arg0 + 6), *(unsigned char*)($arg0 + 7)
end
document hex_quad
Print eight hexadecimal bytes starting at arg0
end
define hexdump
printf "%08X : ", $arg0
hex_quad $arg0
printf " - "
hex_quad ($arg0+8)
printf " "
ascii_char ($arg0)
ascii_char ($arg0+1)
ascii_char ($arg0+2)
ascii_char ($arg0+3)
ascii_char ($arg0+4)
ascii_char ($arg0+5)
ascii_char ($arg0+6)
ascii_char ($arg0+7)
ascii_char ($arg0+8)
ascii_char ($arg0+9)
ascii_char ($arg0+0xA)
ascii_char ($arg0+0xB)
ascii_char ($arg0+0xC)
ascii_char ($arg0+0xD)
ascii_char ($arg0+0xE)
ascii_char ($arg0+0xF)
printf "\n"
end
document hexdump
Display a 16-byte hex/ASCII dump of arg0
end
define hexdump1
hexdump $arg0
x/8h $arg0
printf "\n"
disassem $arg0 $arg0+16
printf "\n"
end
document hexdump1
Display a 16-byte hex/ASCII dump and disassembly of arg0
end
</code></pre>

<p>åœ¨ç”¨ gdb è°ƒè¯•æ—¶æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>hexdump1 $pc
</code></pre>

<p>ä¾¿å¯åˆ—å‡º$pcä½ç½®ååå…­ä½çš„å†…å®¹åŠåæ±‡ç¼–çš„ä»£ç </p>

<p>â‘¢ åœ¨æ–­ç‚¹è®¾å®šä¸€äº›è¦è‡ªåŠ¨è¿è¡Œçš„æŒ‡ä»¤</p>

<p>ä¸‹é¢çš„æ„æ€æ˜¯å»ºç«‹æ–­ç‚¹ï¼‘
åŠåœ¨æ–­ç‚¹ï¼‘åœæ­¢æ—¶è¿è¡ŒæŸ¥çœ‹ä¸€äº›æš‚å­˜å™¨(i r $r0 $r1 $r5 $pc)åŠåæ±‡ç¼–ä¸‹å››ä¸ªæŒ‡ä»¤ä»£ç (x/4i $pc)</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>break *0x3babc
commands 1
i r $r0 $r1 $r5 $pc
x/4i $pc
end
</code></pre>

<p>â‘£ åœ¨ gdb æ–­ç‚¹æš‚åœæ—¶ï¼Œæ˜¯å¯æ”¹å˜å†…å­˜åŠæŒ‡ä»¤
FinalFantasy2 çš„ä¾‹å­ï¼Œ0x0003babcåœ°å€çš„æŒ‡ä»¤æ˜¯
æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>x/i 0x0003babc
</code></pre>

<p>å¾—åˆ°ä»£ç æ˜¯
å¤åˆ¶ä»£ç </p>

<pre><code>add r1, r0, r5
</code></pre>

<p>æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>x/xw 0x0003babc
</code></pre>

<p>å¾—åˆ°ä»£ç æ•°å€¼æ˜¯
å¤åˆ¶ä»£ç </p>

<pre><code>0xe0801005
</code></pre>

<p>æ”¹å˜æŒ‡ä»¤ä»£ç æ•°å€¼æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>set {int}0x0003babc = 0xe0801285
</code></pre>

<p>æ£€æŸ¥æ”¹å˜åçš„æŒ‡ä»¤æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>x/i 0x0003babc
</code></pre>

<p>å¾—åˆ°æ”¹å˜åçš„æŒ‡ä»¤ä»£ç æ˜¯
å¤åˆ¶ä»£ç </p>

<pre><code>add r1, r0, r5, lsl #5
</code></pre>

<p>è¿™æ ·å°±ä¸ç”¨ç¦»å¼€ gdb å³æ—¶çœ‹åˆ°ä¿®æ”¹ä»£ç åçš„æ•ˆæœ</p>

<p>â‘¤ gdb æ‰§è¡Œåˆ°ç¨‹åºä¸­å…¶ä»–åœ°å€çš„å‘½ä»¤</p>

<pre><code>ä¾‹å­ï¼š
stepi                           å•æ­¥æ‰§è¡Œä¸€ä¸ªæœºå™¨æŒ‡ä»¤(å‘½ä»¤æ­¥å…¥å‡½æ•°)
nexti                           å•æ­¥æ‰§è¡Œä¸€ä¸ªæœºå™¨æŒ‡ä»¤(å‘½ä»¤æ­¥è¿‡å‡½æ•°)
nexti 2                        ç»§ç»­æ‰§è¡Œæœºå™¨æŒ‡ä»¤çš„æ•°ç›®ä¸º 2 ä¸ªæŒ‡ä»¤
finish                          ç»§ç»­æ‰§è¡Œè‡³å½“å‰å‡½æ•°ç»“æŸåï¼Œåœæ­¢äºå…¶è°ƒç”¨ç‚¹
until *0x7b224            ç»§ç»­æ‰§è¡Œè‡³ç‰¹å®šåœ°å€*0x7b224
jump *0x3baac           è·³è½¬è‡³ç‰¹å®šåœ°å€*0x3baac æ‰§è¡Œ
</code></pre>

<p>â‘¥ gdb è°ƒè¯•è®°å½•çš„å‘½ä»¤</p>

<pre><code>ä¾‹å­ï¼š
set logging file ./log1.txt      è®¾å®šè®°å½•æ¡£
set logging on                     å¼€å§‹è®°å½•
set logging off                     åœæ­¢è®°å½•
</code></pre>

<p>â‘¦ å­¦ä¹ åˆ«äººä¿®æ”¹ç¨‹åºçš„æ–¹æ³•
çœ‹åˆ«äººä¿®æ”¹ç¨‹åºæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹æ³•ï¼Œåªè¦ä½ æœ‰åŸç‰ˆæœ¬åŠä¿®æ”¹åçš„ç‰ˆæœ¬ï¼Œå°±å¯ä»¥çŸ¥é“ä¿®æ”¹çš„åœ°å€åŠæ–¹æ³•
ä¾‹å¦‚ï¼š
ä¸‹è½½èŠ±å„¿æœµæœµå¼€-v1.0.rar åŸç‰ˆæœ¬</p>

<p>ä¸‹è½½èŠ±å„¿æœµæœµå¼€-v1.0.rar ä¸æ­»ä½œå¼Šä¿®æ”¹ç‰ˆ</p>

<p>è§£å‹åå°†ä¸¤ä¸ª ipa æ–‡ä»¶ï¼Œç”¨ winscp ä¼ åˆ°iPhone è·¯å¾„ /var/root/flower å†…</p>

<p>åœ¨ PuTTY / Terminal è¿æ¥iPhone / iPod Touchå</p>

<p>æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>cd /var/root/flower
</code></pre>

<p>è§£å‹åŸæ¸¸æˆç‰ˆæœ¬ç¨‹åº
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>unzip *-v1.0.ipa
mv Payload/FlowerChainCN.app/FlowerChainCN FlowerChainCN.original
</code></pre>

<p>åˆ é™¤ä¸éœ€è¦çš„çš„è·¯å¾„åŠæ¡£æ¡ˆ
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>rm -fr Payload/ iTunesArtwork *.ipa
</code></pre>

<p>è§£å‹ä¸æ­»ä½œå¼Šä¿®æ”¹ç‰ˆç¨‹åº
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>unzip *-v1.0.ipod4g.ipa
mv Payload/FlowerChainCN.app/FlowerChainCN FlowerChainCN.patched
</code></pre>

<p>åˆ é™¤ä¸éœ€è¦çš„çš„è·¯å¾„åŠæ¡£æ¡ˆ
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>rm -fr Payload/ iTunesArtwork *.ipa
</code></pre>

<p>åæ±‡ç¼–åŸæ¸¸æˆç¨‹å¼åŠä¿å­˜åæ±‡ç¼–æ–‡æœ¬æ–‡ä»¶ä¸º FlowerChainCN.original.txt
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>otool -tv FlowerChainCN.original &gt; FlowerChainCN.original.txt
</code></pre>

<p>åæ±‡ç¼–ä¸æ­»ä½œå¼Šä¿®æ”¹ç‰ˆç¨‹å¼åŠä¿å­˜åæ±‡ç¼–æ–‡æœ¬æ–‡ä»¶ä¸º FlowerChainCN.patched.txt
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>otool -tv FlowerChainCN.patched &gt; FlowerChainCN.patched.txt
</code></pre>

<p>æ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬åŠæ‰¾å‡ºå·®å¼‚
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>diff FlowerChainCN.original.txt FlowerChainCN.patched.txt
</code></pre>

<p>å¾—åˆ°
å¤åˆ¶ä»£ç </p>

<pre><code>&lt; FlowerChainCN.original:
---
&gt; FlowerChainCN.patched:
3060c3060
&lt; 00004ee8 e1520003 cmp r2, r3
---
&gt; 00004ee8 e3520001 cmp r2, #1 ; 0x1
</code></pre>

<p>åŸç‰ˆæœ¬åˆ—åœ¨å·¦è¾¹åŠæŠŠå·®å¼‚åˆ—åœ¨å³è¾¹å¹¶è¾“å‡ºå·®å¼‚æ–‡æœ¬ä¿å­˜ä¸º FlowerChainCN.diff.txt
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>diff -y --left-column FlowerChainCN.original.txt FlowerChainCN.patched.txt &gt; FlowerChainCN.diff.txt
</code></pre>

<p>ç”¨ less å·¥å…·æ‰“å¼€å·®å¼‚æ–‡æœ¬ FlowerChainCN.diff.txt
åœ¨ PuTTY / Terminal æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>less FlowerChainCN.diff.txt
</code></pre>

<p>åœ¨ less å·¥å…·å†…æœå¯»å·®å¼‚åˆ†éš”å­—ç¬¦ |
åœ¨ less å·¥å…·å†…æ‰“
å¤åˆ¶ä»£ç </p>

<pre><code>/\|
</code></pre>

<p>å¾—åˆ°ä¸‹é¢å·®å¼‚çš„æ˜¾ç¤ºå»åšè¿›ä¸€æ­¥åˆ†æ
å¤åˆ¶ä»£ç </p>

<pre><code>00004ee8 e1520003 cmp r2, r3 | 00004ee8 e3520001 cmp r2, #1 ; 0x1
</code></pre>

<p>åœ¨ PuTTY / Terminal æ‰“è¿™å¥ä¹Ÿå¯çœ‹åˆ°åŸç‰ˆæœ¬ä¸Šä¸‹çš„ä»£ç 
å¤åˆ¶ä»£ç </p>

<pre><code>grep -C5 '|' FlowerChainCN.diff.txt
</code></pre>

<p>æˆ–
å¤åˆ¶ä»£ç </p>

<pre><code>grep -C5 00004ee8  FlowerChainCN.original.txt
</code></pre>

<p>â‘§ æœ€åé€ä¸Šæˆ‘è‡ªè´­ç ´è§£çš„ä¸€ä¸ªå¾ˆå®ç”¨çš„iPhoneå°å·¥å…· - 64ä½è®¡ç®—å™¨
è¿™å°å·¥å…·é™¤äº†å¯ä»¥åš64ä½çš„è®¡ç®—å¤–ï¼Œè¿˜å¯ä»¥è¾“å…¥æ–‡å­—åŠæ˜¾ç¤ºUnicodeçš„ä»£ç </p>

<pre><code>64 Bit Calculator

 64_Bit_Calc-v1.2.ipod4g.ipa (788 K) ä¸‹è½½æ¬¡æ•°:233 




64 Bit Calculator (iPad)   64_Bit_Calc_iPad-v1.2.ipa (1521 K) ä¸‹è½½æ¬¡æ•°:116 
</code></pre>

<p>å…³äº FinalFantasy2 1.0.4 ç‰ˆæœ¬ ldid ç­¾åæ—¶å‡ºç°é”™è¯¯ä¿¡æ¯ Segmentation fault</p>

<p>åˆä»£ iPhone ä½¿ç”¨ARMv6 æŒ‡ä»¤é›†, ç›´åˆ°3GS, iPad, IPhone 4è®¾å¤‡è‹¹æœå¼€å§‹é‡‡ç”¨äº† ARMv7 æŒ‡ä»¤é›†</p>

<p>å¦‚æœä½ æ‰“æŒ‡ä»¤</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>otool -f FinalFantasy2
</code></pre>

<p>å°±ä¼šçœ‹åˆ°</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>architecture 0
    cputype 12
    cpusubtype 6
architecture 1
    cputype 12
    cpusubtype 9
</code></pre>

<p>ä½ å¯ä»¥æŠŠ FinalFantasy2 åˆ‡å¼€ä¸º FinalFantasy2V6</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>lipo -thin armv6  FinalFantasy2 -output FinalFantasy2V6
chmod +x FinalFantasy2V6
chown mobile:mobile FinalFantasy2V6
</code></pre>

<p>åŠåˆ‡å¼€ä¸º FinalFantasy2V7</p>

<p>å¤åˆ¶ä»£ç </p>

<pre><code>cp -p FinalFantasy2 FinalFantasy2tmp
echo -ne "\x09" | dd bs=1 seek=15 conv=notrunc status=noxfer of=FinalFantasy2tmp
echo -ne "\x06" | dd bs=1 seek=35 conv=notrunc status=noxfer of=FinalFantasy2tmp
lipo -thin armv6 FinalFantasy2tmp -output FinalFantasy2V7
rm FinalFantasy2tmp
chmod +x FinalFantasy2V7
chown mobile:mobile FinalFantasy2V7
</code></pre>

<p>ä½† iPhone çš„ otool ä¸æ”¯æŒåæ±‡ç¼– ARMv7 æŒ‡ä»¤é›†, ä½ è¦ç”¨æ–°ç‰ˆæœ¬çš„ IDA Pro åæ±‡ç¼–</p>

<p>åœ¨ iPhone ä½ åªå¯ä»¥åæ±‡ç¼– FinalFantasy2V6, ä¿®æ”¹åŠç”¨ ldid å»ç­¾å</p>

<p>FinalFantasy2V6 ç­¾ååä¾¿å¯æ›¿ä»£åŸç‰ˆæœ¬ä½¿ç”¨, æ¸¸æˆæ¥è¯´ARMv6 æŒ‡ä»¤é›†ä¹Ÿå¯ä»¥, åªä¸è¿‡åœ¨æ–°çš„è®¾å¤‡ä¸Šä½¿ç”¨æ—¶ä¸æ˜¯æœ€ä¼˜åŒ–.</p>

<p>.</p>
]]></content>
  </entry>
  
</feed>
