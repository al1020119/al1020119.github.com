
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ä¸å¹³çš„æ¡çº¦ï¼ˆåè®®ï¼‰ - iOSæ¢¦å·¥å‚</title>
  <meta name="author" content="iCocos">

  
  <meta name="description" content="iCocosåšå®¢">
  <meta name="keywords" content="iCocos, iOSå¼€å‘, åšå®¢, æŠ€æœ¯åˆ†æ, æ–‡ç« , å­¦ä¹ , æ›¹é», æ›¹ç†é¹">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://al1020119.github.io/blog/2014/08/28/protocol/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iOSæ¢¦å·¥å‚" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

<!--<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">iOSæ¢¦å·¥å‚</a></h1>
  
    <h2>iCocosâ€”â€”ä¸æˆ˜èƒœè‡ªå·±ï¼Œä½•ä»¥æ”¹å˜æœªæ¥ï¼</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="al1020119.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">åšæ–‡</a></li>
  <li><a href="/blog/archives">å½’æ¡£</a></li>
  <li><a href="/icocos">iCocos</a></li>
  <li><a href="/about">æ–‡ç« </a></li>
  <li><a href="/other">å…¶ä»–</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">ä¸å¹³çš„æ¡çº¦ï¼ˆåè®®ï¼‰</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-08-28T13:53:19+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:53 pm</span></time>
        
        
        |   <a href="#comments">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>åè®®å£°æ˜ç±»éœ€è¦å®ç°çš„çš„æ–¹æ³•ï¼Œä¸ºä¸åŒçš„ç±»æä¾›å…¬ç”¨æ–¹æ³•ï¼Œä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªåè®®ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œå³å•ç»§æ‰¿ã€‚å®ƒç±»ä¼¼javaä¸­çš„æ¥å£ã€‚</p>

<h2>æ­£å¼åè®®ï¼ˆformal protocolï¼‰</h2>

<p>å£°æ˜æ­£å¼åè®®ä½¿ç”¨@protocolæŒ‡ä»¤ï¼Œä»¥@endç»“å°¾ã€‚</p>

<!--more-->


<pre><code>@protocol MyXMLSupport
- initFromXMLRepresentation:(NSXMLElement *)XMLElement;
- (NSXMLElement *)XMLRepresentation;
@end
</code></pre>

<p>å¯ä»¥åœ¨åè®®å£°æ˜ä¸­ä½¿ç”¨@optionalå’Œ@requiredæŒ‡ä»¤æ¥æŒ‡å®šåè®®ä¸­çš„æ–¹æ³•æ˜¯å¦å¿…é¡»è¦å®ç°ã€‚å¦‚æœæ²¡æœ‰ä¸ºæ–¹æ³•æŒ‡å®šä»»ä½•æŒ‡ä»¤ï¼Œ@requiredæ˜¯åè®®ä¸­é»˜è®¤çš„æŒ‡ä»¤ã€‚</p>

<pre><code>@protocol MyProtocol
- (void)requiredMethod;
@optional
- (void)anOptionalMethod;
- (void)anotherOptionalMethod;
@required
- (void)anotherRequiredMethod; 
@end
</code></pre>

<h2>éæ­£å¼åè®®ï¼ˆinformal protocolï¼‰</h2>

<p>éæ­£å¼åè®®é€šè¿‡åˆ†ç±»ï¼ˆcategoryï¼‰æ¥å®ç°ï¼Œä¸è¿‡åœ¨Mac OS X v10.6+ä¸­å¯ä»¥åœ¨åè®®ä¸­é€šè¿‡@optionalæŒ‡ä»¤æ¥å–ä»£è¿™ä¸ªåˆ«æ‰­çš„æ–¹æ¡ˆã€‚</p>

<pre><code>@interface NSObject ( MyXMLSupport )
- initFromXMLRepresentation:(NSXMLElement *)XMLElement;
- (NSXMLElement *)XMLRepresentation;
@end
</code></pre>

<h2>åè®®å¯¹è±¡ï¼ˆprotocol objectsï¼‰</h2>

<p>Objective Cä¸­å®šä¹‰äº†åè®®å¯¹è±¡ï¼Œé€šè¿‡@protocolæŒ‡ä»¤å¯ä»¥è·å–protocolå®ä¾‹ã€‚</p>

<pre><code>Protocol *myXMLSupportProtocol = @protocol(MyXMLSupport);
</code></pre>

<p>å½“ç±»é‡‡ç”¨ï¼ˆadoptï¼‰æ¥å£æˆ–åœ¨ä»£ç ä¸­é€šè¿‡@protocolï¼ˆXXï¼‰æŒ‡ä»¤æ—¶ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºprotocolå®ä¾‹ã€‚</p>

<h2>åè®®çš„ä½¿ç”¨</h2>

<p>åè®®çš„é‡‡ç”¨ï¼ˆadoptï¼‰å’Œå£°æ˜çˆ¶ç±»ç±»ä¼¼ï¼Œå¯ä»¥åœ¨çˆ¶ç±»åé¢ç”¨å°–æ‹¬å·å°†è¦é‡‡ç”¨çš„åè®®æ‹¬èµ·æ¥ï¼Œå¤šä¸ªåè®®ç”¨é€—å·ï¼ˆcommaï¼‰éš”å¼€ã€‚
ç±»å’Œåˆ†ç±»éƒ½å¯ä»¥é‡‡ç”¨åè®®ã€‚</p>

<pre><code>@interface ClassName : ItsSuperclass &lt; protocol list &gt;
@interface ClassName ( CategoryName ) &lt; protocol list &gt;
</code></pre>

<p>åœ¨æ¥å£éƒ¨åˆ†ä¸éœ€è¦é‡æ–°å£°æ˜åè®®ä¸­çš„æ–¹æ³•ã€‚ä½†åœ¨ç±»çš„å®ç°éƒ¨åˆ†éœ€è¦å®ç°åè®®ä¸­çš„@requiredæ–¹æ³•ã€‚</p>

<h2>æ˜¯å¦éµå¾ªæŸåè®®</h2>

<p>æ£€æŸ¥ä¸€ä¸ªç±»æˆ–å®ä¾‹å¯¹è±¡æ˜¯å¦éµå¾ªæŸåè®®å¯ä»¥ç”¨NSObjectç±»çš„ç±»æ–¹æ³•conformsToProtocolå’Œå®ä¾‹æ–¹æ³•conformsToProtocol</p>

<pre><code>if ( ! [receiver conformsToProtocol:@protocol(MyXMLSupport)]  ) {
    // Object does not conform to MyXMLSupport protocol
    // If you are expecting receiver to implement methods declared in the
    //  MyXMLSupport protocol, this is probably an error
}
</code></pre>

<h2>ä½¿ç”¨åè®®è¿›è¡Œç±»å‹å£°æ˜</h2>

<p>å£°æ˜å¯¹è±¡ç±»å‹æ—¶å¯ä»¥åœ¨å£°æ˜ä¸­æŒ‡å®šåè®®ï¼Œè¿™æ ·å¯ä»¥è®©ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µå¼ºåˆ¶å¯¹è±¡éµå¾ªæŸåè®®ã€‚</p>

<pre><code>- (id &lt;Formatting&gt;)formattingService;
id &lt;MyXMLSupport&gt; anObject;
</code></pre>

<h2>åè®®çš„ç»§æ‰¿</h2>

<p>åè®®ä¹Ÿå¯ä»¥ç»§æ‰¿æˆ–é‡‡ç”¨å…¶ä»–çš„åè®®ï¼Œéœ€è¦é‡‡ç”¨æŸåè®®çš„ç±»å¿…é¡»å®ç°è¯¥åè®®çš„requiredæ–¹æ³•å’Œè¯¥åè®®ç»§æ‰¿çš„åè®®ä¸­çš„requiredæ–¹æ³•ã€‚
    @protocol ProtocolName &lt; protocol list ></p>

<h2>åœ¨åè®®ä¸­ä½¿ç”¨å…¶å®ƒçš„åè®®</h2>

<p>åœ¨ä¸€ä¸ªå¤§å‹çš„åº”ç”¨ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>

<pre><code>#import "B.h"
@protocol A
- foo:(id &lt;B&gt;)anObject;
@end


#import "A.h"
@protocol B
- bar:(id &lt;A&gt;)anObject;
@end
</code></pre>

<p>Aã€Båè®®åœ¨äº’ç›¸å¼•ç”¨ï¼Œå¦‚æœè¿™é‡Œéƒ½ç”¨importæ¥å¼•å…¥åè®®æ–‡ä»¶ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚éœ€è¦æ”¹ä¸ºå¦‚ä¸‹æ–¹å¼ï¼š</p>

<pre><code>@protocol B;
@protocol A
- foo:(id &lt;B&gt;)anObject;
@end
</code></pre>

<p>@protocol Båªæ˜¯ç®€å•å‘Šè¯‰ç¼–è¯‘å™¨Bæ˜¯ä¸€ä¸ªåè®®ï¼Œä¸ä¼šå¼•å…¥Bçš„æ–‡ä»¶ã€‚
NScoder  å’Œ NScoding æœ‰å°†è‡ªå·±å®šä¹‰çš„ç±»çš„å¯¹è±¡å†™å…¥ç£ç›˜çš„ä½œç”¨
NScoding æ˜¯ä¸€ä¸ªåè®®ï¼Œä¸»è¦æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•</p>

<pre><code>-(id)initWithCoder:(NSCoder *)coder;//ä»coderä¸­è¯»å–æ•°æ®ï¼Œä¿å­˜åˆ°ç›¸åº”çš„å˜é‡ä¸­ï¼Œå³ååºåˆ—åŒ–æ•°æ®
-(void)encodeWithCoder:(NSCoder *)coder;// è¯»å–å®ä¾‹å˜é‡ï¼Œå¹¶æŠŠè¿™äº›æ•°æ®å†™åˆ°coderä¸­å»ã€‚åºåˆ—åŒ–æ•°æ®
</code></pre>

<p>NSCoder æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹è¯ï¼Œåªèƒ½æä¾›ä¸€äº›æƒ³è®©å­ç±»ç»§æ‰¿çš„æ–¹æ³•ã€‚</p>

<p>NSKeyedUnarchiver   ä»äºŒè¿›åˆ¶æµè¯»å–å¯¹è±¡ã€‚
NSKeyedArchiver       æŠŠå¯¹è±¡å†™åˆ°äºŒè¿›åˆ¶æµä¸­å»ã€‚
4ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>

<p>ä¸€èˆ¬æ˜¯åœ¨è‡ªå·±å®šä¹‰çš„ç±»ä¸­éœ€è¦åœ¨.h æ–‡ä»¶ä¸­åŠ å…¥<NScoding></p>

<p>åœ¨.m æ–‡ä»¶ä¼—å®ç°ä»–çš„çš„ä¸¤ä¸ªä»£ç†æ–¹æ³•ï¼Œè¿™ä¸ªä»£ç†æ–¹æ³•å°†ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</p>

<pre><code>1 - (void)encodeWithCoder:(NSCoder *)aCoder 
2 {
3     [aCoder encodeObject:self.InsureSolutionID forKey:@"personName"];
4     [aCoder encodeObject:self.InsureSolutionName forKey:@"personAge"];
5 }
</code></pre>

<p>encodeWithCoder å¯ä»¥è°ƒç”¨çš„æ–¹æ³•ï¼š</p>

<p>1ï¼‰ã€å¦‚æœæ˜¯ç±» å°±ç”¨encodeObject: forKeyï¼š</p>

<p>2ï¼‰ã€å¦‚æœæ˜¯æ™®é€šçš„æ•°æ®ç±»å‹å°±ç”¨   egã€encodeIntï¼š forKeyï¼š</p>

<pre><code>- (id)initWithCoder:(NSCoder *)aDecoder 

{
    self = [super init];
    if (self) 
    {
        self.InsureSolutionID = [aDecoder decodeObjectForKey:@"personName"];
        self.InsureSolutionName = [aDecoder decodeObjectForKey:@"personAge"];
    }
    return self;
}
</code></pre>

<p>initWithCoder å¯ä»¥è°ƒç”¨çš„æ–¹æ³•ï¼š</p>

<p>1ï¼‰ã€å¦‚æœæ˜¯ç±» å°±ç”¨decodeObjectForKeyï¼š</p>

<p>2ï¼‰ã€å¦‚æœæ˜¯æ™®é€šçš„æ•°æ®ç±»å‹å°±ç”¨   egã€decodeIntForKeyï¼š</p>

<p>ä»¥ä¸‹æ˜¯å¯¹è¯¥ç±»åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p>

<pre><code>1 NSData *archiveCarPriceData = [NSKeyedArchiver archivedDataWithRootObject:self.DataArray];
2     [[NSUserDefaults standardUserDefaults] setObject:archiveCarPriceData forKey:@"DataArray"];
3  
4 
5  NSData *myEncodedObject = [[NSUserDefaults standardUserDefaults] objectForKey:@"DataArray"];
6      self.dataList = [NSKeyedUnarchiver unarchiveObjectWithData: myEncodedObject];
</code></pre>

<p>nscopyingåè®®è›®å¥½ç”¨çš„ã€‚</p>

<p>ä¸€ä¸ªæ–¹æ³•ï¼š
zoneæ˜¯ä¸€ä¸ªå†…å­˜åŒºåŸŸï¼Œé€šå¸¸objectï¼ŒæŒ‡å‘æŒ‡é’ˆï¼Œæ‰€ä»¥copywithzoneé‡è¦ã€‚</p>

<pre><code>- (id)copyWithZone:(NSZone *)zone

{

    FourLines *copy = [[[self class] allocWithZone:zone] init];

    copy.field1 = [self.field1 copyWithZone:zone];

    copy.field2 = [self.field2 copyWithZone:zone];

    copy.field3 = [self.field3 copyWithZone:zone];

    copy.field4 = [self.field4 copyWithZone:zone];

    return copy;

}
</code></pre>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">iCocos</span></span>

      




<time class='entry-date' datetime='2014-08-28T13:53:19+08:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:53 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/foundation/'>foundation</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/08/15/uiview%20calayer/" title="Previous Post: UIView&CALayeræ˜¯æ’’ï¼Ÿ">&laquo; UIView&CALayeræ˜¯æ’’ï¼Ÿ</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/09/02/an-quan-ji-zhi/" title="Next Post: å®‰å…¨æœºåˆ¶">å®‰å…¨æœºåˆ¶ &raquo;</a>
      
    </p>
  </footer>
</article>



  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-title="ä¸å¹³çš„æ¡çº¦ï¼ˆåè®®ï¼‰"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"icocoscao"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
    <h1>æ–‡ç« åˆ†ç±»</h1>
    <ul id="categories">
        <li class='category'><a href='/blog/categories/apples/'>apples (2)</a></li>
<li class='category'><a href='/blog/categories/audio-video/'>audio-video (1)</a></li>
<li class='category'><a href='/blog/categories/developer/'>developer (16)</a></li>
<li class='category'><a href='/blog/categories/foundation/'>foundation (32)</a></li>
<li class='category'><a href='/blog/categories/full/'>full (13)</a></li>
<li class='category'><a href='/blog/categories/low-level/'>low-level (4)</a></li>
<li class='category'><a href='/blog/categories/news/'>news (4)</a></li>
<li class='category'><a href='/blog/categories/others/'>others (1)</a></li>
<li class='category'><a href='/blog/categories/performance/'>performance (12)</a></li>
<li class='category'><a href='/blog/categories/reverse/'>reverse (25)</a></li>
<li class='category'><a href='/blog/categories/senior/'>senior (40)</a></li>
<li class='category'><a href='/blog/categories/stack/'>stack (13)</a></li>
<li class='category'><a href='/blog/categories/summarize/'>summarize (5)</a></li>
<li class='category'><a href='/blog/categories/tools/'>tools (5)</a></li>

    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/08/08/oneday/">ä¿®è¡Œç¯‡-æ¢ç¨‹åºä¹‹ç²¾å</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/01/gezhongdicenshixian/">iOSå¼€å‘å„ç§åº•å±‚å®ç°--åŒ…ä½ æ»¡æ„ğŸ˜˜ï¼</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/01/weixinhongbao/">ç¦åˆ©ï¼šæŠ¢çº¢åŒ…ç¥å™¨å°±æ˜¯è¿™ä¹ˆæ¥çš„</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/26/chongzhengzhidao/">é‡æ•´ä¹‹é“ï¼ˆé¢è¯•+æŠ€æœ¯+åº•å±‚+é«˜çº§ï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/10/duoxianc/">å¤šçº¿ç¨‹ä¹‹è‘µèŠ±å®å…¸</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/al1020119">@al1020119</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'al1020119',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
<h1>æ‰«ä¸€æ‰«<abbr title="The word 'æ‰«ä¸€æ‰«' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'æ‰«ä¸€æ‰«', not for image.">&trade;</abbr></h1>
<a href="http://al1020119.github.io/blog/2014/08/28/protocol/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://al1020119.github.io/blog/2014/08/28/protocol/" alt="post-qrcode"></a></section>
<section>
    <h1>è®¿å®¢ç»Ÿè®¡</h1>
    <br/>
    <a href="http://s07.flagcounter.com/more/2SH"><img src="http://s07.flagcounter.com/count/2SH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/" alt="Flag Counter" border="0"></a>
</section><section>
    <h1>æ–°æµªå¾®åš</h1>
    <ul id="weibo">
        <li>
            
            <!-- åœ¨æ­¤æ’å…¥è·å¾—çš„å¾®åšç§€ä»£ç  -->
            <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3288975567&verifier=20ffcedd&dpc=1"></iframe>
            
        </li>
    </ul>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - iCocos -
<span class="credit">welcome to <a href="http://al1020119.github.io">æ›¹#é»</a></span>
</p>

</footer>
  






<!--
-->



</body>
</html>
