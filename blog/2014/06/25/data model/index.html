
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>æ•°æ®ä¸æ¨¡å‹ - iOSæ¢¦å·¥å‚</title>
  <meta name="author" content="iCocos">

  
  <meta name="description" content="iCocosåšå®¢">
  <meta name="keywords" content="iCocos, iOSå¼€å‘, åšå®¢, æŠ€æœ¯åˆ†æ, æ–‡ç« , å­¦ä¹ , æ›¹é», æ›¹ç†é¹">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://al1020119.github.io/blog/2014/06/25/data%20model/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iOSæ¢¦å·¥å‚" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

<!--<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">iOSæ¢¦å·¥å‚</a></h1>
  
    <h2>iCocosâ€”â€”ä¸æˆ˜èƒœè‡ªå·±ï¼Œä½•ä»¥æ”¹å˜æœªæ¥ï¼</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="al1020119.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">åšæ–‡</a></li>
  <li><a href="/blog/archives">å½’æ¡£</a></li>
  <li><a href="/icocos">iCocos</a></li>
  <li><a href="/about">æ–‡ç« </a></li>
  <li><a href="/other">å…¶ä»–</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">æ•°æ®ä¸æ¨¡å‹</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-25T13:53:19+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:53 pm</span></time>
        
        
        |   <a href="#comments">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>/******************************************************************************/</p>

<h3>ä¸€:ç®€å•plistè¯»å–</h3>

<p>1:å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥ä¿å­˜è¯»å–å‡ºæ¥çš„plistæ•°æ®</p>

<pre><code> 1 @property (nonatomic, strong) NSArray *shops; 
</code></pre>

<!--more-->


<p>2:ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼åŠ è½½plistæ–‡ä»¶ï¼Œå¹¶ä¸”æ”¾åˆ°æ•°ç»„ä¸­</p>

<pre><code>// æ‡’åŠ è½½

// 1.ç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶å†å»åŠ è½½

// 2.åªä¼šåŠ è½½ä¸€æ¬¡

- (NSArray *)shops

{

    if (_shops == nil) {

        // è·å¾—plistæ–‡ä»¶çš„å…¨è·¯å¾„

        NSString *file = [[NSBundle mainBundle] pathForResource:@"shops.plist" ofType:nil];



        // ä»plistæ–‡ä»¶ä¸­åŠ è½½ä¸€ä¸ªæ•°ç»„å¯¹è±¡

        _shops = [NSArray arrayWithContentsOfFile:file];

    }

    return _shops;

}
</code></pre>

<p>3:ä½¿ç”¨æ•°ç»„ä¸­çš„æ•°æ®</p>

<pre><code>// è®¾ç½®æ•°æ®

1 NSDictionary *shop = self.shops[index];
2 
3 iconView.image = [UIImage imageNamed:shop[@"icon"]];
4 
5 nameLabel.text = shop[@"name"];
</code></pre>

<p>/******************************************************************************/</p>

<h3>äºŒï¼šå­—å…¸è½¬æ¨¡å‹</h3>

<h6>1:åˆ›å»ºä¸€ä¸ªmodelç±»å¹¶ä¸”åœ¨é‡Œé¢åˆ›å»ºå¯¹åº”çš„æ¨¡å‹å±æ€§</h6>

<pre><code>/** åå­— */

 1 @property (nonatomic, strong) NSString *name; 

/** å›¾æ ‡ */

 1 @property (nonatomic, strong) NSString *icon; 
</code></pre>

<h6>2:å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥ä¿å­˜è¯»å–å‡ºæ¥çš„plistæ•°æ®</h6>

<pre><code> 1 @property (nonatomic, strong) NSMutableArray *shops; 
</code></pre>

<h6>3:ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼åŠ è½½plistæ–‡ä»¶ï¼Œå¹¶ä¸”æ”¾åˆ°æ¨¡å‹ä¸­</h6>

<pre><code>// æ‡’åŠ è½½

// 1.ç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶å†å»åŠ è½½

// 2.åªä¼šåŠ è½½ä¸€æ¬¡

- (NSMutableArray *)shops

{

    if (_shops == nil) {

        // åˆ›å»º"æ¨¡å‹æ•°ç»„"

        _shops = [NSMutableArray array];



        // è·å¾—plistæ–‡ä»¶çš„å…¨è·¯å¾„

        NSString *file = [[NSBundle mainBundle] pathForResource:@"shops.plist" ofType:nil];



        // ä»plistæ–‡ä»¶ä¸­åŠ è½½ä¸€ä¸ªæ•°ç»„å¯¹è±¡(è¿™ä¸ªæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯NSDictionaryå¯¹è±¡)

        NSArray *dictArray = [NSArray arrayWithContentsOfFile:file];



        // å°† â€œå­—å…¸æ•°ç»„â€ è½¬æ¢ä¸º â€œæ¨¡å‹æ•°æ®â€

        for (NSDictionary *dict in dictArray) { // éå†æ¯ä¸€ä¸ªå­—å…¸

            // å°† â€œå­—å…¸â€ è½¬æ¢ä¸º â€œæ¨¡å‹â€

            Shop *shop = [[Shop alloc] init];

            shop.name = dict[@"name"];

            shop.icon = dict[@"icon"];



            // å°† â€œæ¨¡å‹â€ æ·»åŠ åˆ° â€œæ¨¡å‹æ•°ç»„ä¸­â€

            [_shops addObject:shop];

        }

    }

    return _shops;

}
</code></pre>

<p>4:ä½¿ç”¨æ¨¡å‹ä¸­çš„æ•°æ®</p>

<pre><code>// è®¾ç½®æ•°æ® 
Shop *shop = self.shops[index];

iconView.image = [UIImage imageNamed:shop.icon];

nameLabel.text = shop.name;
</code></pre>

<p>/******************************************************************************/</p>

<h3>ä¸‰ï¼šå­—å…¸è½¬æ¨¡å‹å°è£…</h3>

<h6>1:åˆ›å»ºä¸€ä¸ªmodelç±»å¹¶ä¸”åœ¨é‡Œé¢åˆ›å»ºå¯¹åº”çš„æ¨¡å‹å±æ€§ï¼Œå®šä¹‰ä¸¤ä¸ªæ¨¡å‹æ–¹æ³•</h6>

<pre><code>/** åå­— */

@property (nonatomic, copy) NSString *name;

/** å›¾æ ‡ */

@property (nonatomic, copy) NSString *icon;



/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆå§‹åŒ–æ¨¡å‹å¯¹è±¡ */

- (instancetype)initWithDict:(NSDictionary *)dict;



/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆ›å»ºæ¨¡å‹å¯¹è±¡ */

+ (instancetype)shopWithDict:(NSDictionary *)dict;
</code></pre>

<h6>2:æ¨¡å‹æ–¹æ³•çš„å®ç°</h6>

<pre><code>- (instancetype)initWithDict:(NSDictionary *)dict

{

    if (self = [super init]) {

        self.name = dict[@"name"];

        self.icon = dict[@"icon"];

    }

    return self;

}



+ (instancetype)shopWithDict:(NSDictionary *)dict

{

    // è¿™é‡Œè¦ç”¨self

    return [[self alloc] initWithDict:dict];

} 
</code></pre>

<h6>3:å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥ä¿å­˜è¯»å–å‡ºæ¥çš„plistæ•°æ®</h6>

<pre><code> 1 @property (nonatomic, strong) NSMutableArray *shops; 
</code></pre>

<h6>4:ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼åŠ è½½plistæ–‡ä»¶ï¼Œå¹¶ä¸”æ”¾åˆ°æ¨¡å‹ä¸­</h6>

<pre><code>// æ‡’åŠ è½½

// 1.ç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶å†å»åŠ è½½

// 2.åªä¼šåŠ è½½ä¸€æ¬¡
- (NSMutableArray *)shops

{

    if (_shops == nil) {

        // åˆ›å»º"æ¨¡å‹æ•°ç»„"

        _shops = [NSMutableArray array];



        // è·å¾—plistæ–‡ä»¶çš„å…¨è·¯å¾„

        NSString *file = [[NSBundle mainBundle] pathForResource:@"shops.plist" ofType:nil];



        // ä»plistæ–‡ä»¶ä¸­åŠ è½½ä¸€ä¸ªæ•°ç»„å¯¹è±¡(è¿™ä¸ªæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯NSDictionaryå¯¹è±¡)

        NSArray *dictArray = [NSArray arrayWithContentsOfFile:file];



        // å°† â€œå­—å…¸æ•°ç»„â€ è½¬æ¢ä¸º â€œæ¨¡å‹æ•°æ®â€

        for (NSDictionary *dict in dictArray) { // éå†æ¯ä¸€ä¸ªå­—å…¸

            // å°† â€œå­—å…¸â€ è½¬æ¢ä¸º â€œæ¨¡å‹â€

            XMGShop *shop = [XMGShop shopWithDict:dict];



            // å°† â€œæ¨¡å‹â€ æ·»åŠ åˆ° â€œæ¨¡å‹æ•°ç»„ä¸­â€

            [_shops addObject:shop];

        }

    }

    return _shops;

}
</code></pre>

<h6>5:ä½¿ç”¨æ¨¡å‹ä¸­çš„æ•°æ®</h6>

<pre><code>// è®¾ç½®æ•°æ®

XMGShop *shop = self.shops[index];

iconView.image = [UIImage imageNamed:shop.icon];

nameLabel.text = shop.name;
</code></pre>

<p>/******************************************************************************/</p>

<h3>å››ï¼šè‡ªå®šä¹‰View</h3>

<h6>1:åˆ›å»ºä¸€ä¸ªmodelç±»å¹¶ä¸”åœ¨é‡Œé¢åˆ›å»ºå¯¹åº”çš„æ¨¡å‹å±æ€§ï¼Œå®šä¹‰ä¸¤ä¸ªæ¨¡å‹æ–¹æ³•</h6>

<pre><code>/** åå­— */

@property (nonatomic, copy) NSString *name;

/** å›¾æ ‡ */

@property (nonatomic, copy) NSString *icon;



/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆå§‹åŒ–æ¨¡å‹å¯¹è±¡ */

- (instancetype)initWithDict:(NSDictionary *)dict;



/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆ›å»ºæ¨¡å‹å¯¹è±¡ */

+ (instancetype)shopWithDict:(NSDictionary *)dict;
</code></pre>

<h6>2:æ¨¡å‹æ–¹æ³•çš„å®ç°</h6>

<pre><code>- (instancetype)initWithDict:(NSDictionary *)dict

{

    if (self = [super init]) {

        self.name = dict[@"name"];

        self.icon = dict[@"icon"];

    }

    return self;

}



+ (instancetype)shopWithDict:(NSDictionary *)dict

{

    // è¿™é‡Œè¦ç”¨self

    return [[self alloc] initWithDict:dict];

}
</code></pre>

<h6>3:è‡ªå®šä¹‰ä¸€ä¸ªViewï¼Œå¼•å…¥æ¨¡å‹ç±»ï¼Œå¹¶ä¸”åˆ›å»ºæ¨¡å‹ç±»çš„å±æ€§</h6>

<pre><code>@class XMGShop;



/** å•†å“æ¨¡å‹ */

@property (nonatomic, strong) XMGShop *shop;
</code></pre>

<h6>4:å®ç°æ–‡ä»¶ä¸­ï¼Œå®šä¹‰ç›¸åº”çš„æ§ä»¶å±æ€§</h6>

<pre><code>/** å›¾ç‰‡ */

@property (nonatomic, weak) UIImageView *iconView;



/** åå­— */

@property (nonatomic, weak) UILabel *nameLabel;
</code></pre>

<h6>5:å®ç°è‡ªå®šä¹‰Viewçš„ç›¸åº”æ–¹æ³•</h6>

<pre><code>- (instancetype)init

{

    if (self = [super init]) {

        // æ·»åŠ ä¸€ä¸ªå›¾ç‰‡

        UIImageView *iconView = [[UIImageView alloc] init];

        [self addSubview:iconView];

        self.iconView = iconView;



        // æ·»åŠ ä¸€ä¸ªæ–‡å­—

        UILabel *nameLabel = [[UILabel alloc] init];

        nameLabel.textAlignment = NSTextAlignmentCenter;

        [self addSubview:nameLabel];

        self.nameLabel = nameLabel;

    }

    return self;

}



/**

 * è¿™ä¸ªæ–¹æ³•ä¸“é—¨ç”¨æ¥å¸ƒå±€å­æ§ä»¶ï¼Œè®¾ç½®å­æ§ä»¶çš„frame

 */

- (void)layoutSubviews

{

    // ä¸€å®šè¦è°ƒç”¨superæ–¹æ³•

    [super layoutSubviews];



    CGFloat shopW = self.frame.size.width;

    CGFloat shopH = self.frame.size.height;



    self.iconView.frame = CGRectMake(0, 0, shopW, shopW);

    self.nameLabel.frame = CGRectMake(0, shopW, shopW, shopH - shopW);

}



-(void)setShop:(XMGShop *)shop

{

    _shop = shop;



    self.iconView.image = [UIImage imageNamed:shop.icon];

    self.nameLabel.text = shop.name;

}
</code></pre>

<h6>6:å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥ä¿å­˜è¯»å–å‡ºæ¥çš„plistæ•°æ®</h6>

<pre><code> 1 @property (nonatomic, strong) NSMutableArray *shops; 
</code></pre>

<h6>7:ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼åŠ è½½plistæ–‡ä»¶ï¼Œå¹¶ä¸”æ”¾åˆ°æ¨¡å‹ä¸­</h6>

<pre><code>// æ‡’åŠ è½½

// 1.ç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶å†å»åŠ è½½

// 2.åªä¼šåŠ è½½ä¸€æ¬¡

- (NSMutableArray *)shops

{

    if (_shops == nil) {

        // åˆ›å»º"æ¨¡å‹æ•°ç»„"

        _shops = [NSMutableArray array];



        // è·å¾—plistæ–‡ä»¶çš„å…¨è·¯å¾„

        NSString *file = [[NSBundle mainBundle] pathForResource:@"shops.plist" ofType:nil];



        // ä»plistæ–‡ä»¶ä¸­åŠ è½½ä¸€ä¸ªæ•°ç»„å¯¹è±¡(è¿™ä¸ªæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯NSDictionaryå¯¹è±¡)

        NSArray *dictArray = [NSArray arrayWithContentsOfFile:file];



        // å°† â€œå­—å…¸æ•°ç»„â€ è½¬æ¢ä¸º â€œæ¨¡å‹æ•°æ®â€

        for (NSDictionary *dict in dictArray) { // éå†æ¯ä¸€ä¸ªå­—å…¸

            // å°† â€œå­—å…¸â€ è½¬æ¢ä¸º â€œæ¨¡å‹â€

            XMGShop *shop = [XMGShop shopWithDict:dict];



            // å°† â€œæ¨¡å‹â€ æ·»åŠ åˆ° â€œæ¨¡å‹æ•°ç»„ä¸­â€

            [_shops addObject:shop];

        }

    }

    return _shops;

} 
</code></pre>

<h6>8:ä½¿ç”¨View</h6>

<pre><code>// åˆ›å»ºä¸€ä¸ªå•†å“çˆ¶æ§ä»¶

XMGShopView *shopView = [[XMGShopView alloc] init];

shopView.frame = CGRectMake(shopX, shopY, shopW, shopH);

// å°†å•†å“çˆ¶æ§ä»¶æ·»åŠ åˆ°shopsViewä¸­

[self.shopsView addSubview:shopView];




/**



NSDictionary *dict = nil; // ä»å…¶ä»–åœ°æ–¹åŠ è½½çš„å­—å…¸



 XMGShop *shop = [XMGShop shopWithDict:dict];



 XMGShopView *shopView = [[XMGShopView alloc] init];

 shopView.shop = shop;

 shopView.frame = CGRectMake(0, 0, 70, 100);

 [self.view addSubview:shopView];






 // æ‰©å±•æ€§å·®

 // æ‰©å±•å¥½çš„ä½“ç°ï¼šå³ä½¿æ”¹å˜äº†éœ€æ±‚ã€‚æˆ‘ä»¬ä¹Ÿä¸éœ€è¦åŠ¨å¤§åˆ€å­

 */
</code></pre>

<p>/******************************************************************************/</p>

<h3>äº”ï¼šinitWithFrame</h3>

<p>1:åœ¨ä¸Šä¸€æ­¥çš„åŸºç¡€ä¸Šåªè¦ä¿®æ”¹initæ–¹æ³•ä¸º</p>

<pre><code>/** initæ–¹æ³•å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨initWithFrame:æ–¹æ³• */

- (instancetype)initWithFrame:(CGRect)frame

{

    if (self = [super initWithFrame:frame]) {

        // æ·»åŠ ä¸€ä¸ªå›¾ç‰‡

        UIImageView *iconView = [[UIImageView alloc] init];

        [self addSubview:iconView];

        self.iconView = iconView;



        // æ·»åŠ ä¸€ä¸ªæ–‡å­—

        UILabel *nameLabel = [[UILabel alloc] init];

        nameLabel.textAlignment = NSTextAlignmentCenter;

        [self addSubview:nameLabel];

        self.nameLabel = nameLabel;

    }

    return self;

}
</code></pre>

<p>2:æœ€åè®¾ç½®æ•°æ®çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•å®ç°Viewçš„åˆ›å»º</p>

<pre><code> 1 XMGShopView *shopView = [[XMGShopView alloc] initWithFrame:CGRectMake(shopX, shopY, shopW, shopH)]; 
</code></pre>

<p>/******************************************************************************/</p>

<h3>å…­ï¼šMVC</h3>

<h6>1:model</h6>

<pre><code>@interface XMGShop : NSObject

/** åå­— */

@property (nonatomic, copy) NSString *name;

/** å›¾æ ‡ */

@property (nonatomic, copy) NSString *icon;

/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆå§‹åŒ–æ¨¡å‹å¯¹è±¡ */

- (instancetype)initWithDict:(NSDictionary *)dict;



/** é€šè¿‡ä¸€ä¸ªå­—å…¸æ¥åˆ›å»ºæ¨¡å‹å¯¹è±¡ */

+ (instancetype)shopWithDict:(NSDictionary *)dict;

@end






@implementation XMGShop



- (instancetype)initWithDict:(NSDictionary *)dict

{

    if (self = [super init]) {

        self.name = dict[@"name"];

        self.icon = dict[@"icon"];

    }

    return self;

}



+ (instancetype)shopWithDict:(NSDictionary *)dict

{

    // è¿™é‡Œè¦ç”¨self

    return [[self alloc] initWithDict:dict];

}



@end
</code></pre>

<h6>2:view</h6>

<pre><code>@class XMGShop;



@interface XMGShopView : UIView

/** å•†å“æ¨¡å‹ */

@property (nonatomic, strong) XMGShop *shop;



- (instancetype)initWithShop:(XMGShop *)shop;

+ (instancetype)shopViewWithShop:(XMGShop *)shop;

+ (instancetype)shopView;

@end






@interface XMGShopView()

/** å›¾ç‰‡ */

@property (nonatomic, weak) UIImageView *iconView;



/** åå­— */

@property (nonatomic, weak) UILabel *nameLabel;

@end



@implementation XMGShopView



- (instancetype)initWithShop:(XMGShop *)shop

{

    if (self = [super init]) {

        self.shop = shop;

    }

    return self;

}



+ (instancetype)shopViewWithShop:(XMGShop *)shop

{

    return [[self alloc] initWithShop:shop];

}



+ (instancetype)shopView

{

    return [[self alloc] init];

}



/** initæ–¹æ³•å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨initWithFrame:æ–¹æ³• */

- (instancetype)initWithFrame:(CGRect)frame

{

    if (self = [super initWithFrame:frame]) {

        // æ·»åŠ ä¸€ä¸ªå›¾ç‰‡

        UIImageView *iconView = [[UIImageView alloc] init];

        [self addSubview:iconView];

        self.iconView = iconView;



        // æ·»åŠ ä¸€ä¸ªæ–‡å­—

        UILabel *nameLabel = [[UILabel alloc] init];

        nameLabel.textAlignment = NSTextAlignmentCenter;

        [self addSubview:nameLabel];

        self.nameLabel = nameLabel;

    }

    return self;

}



/**

 * å½“å‰æ§ä»¶çš„frameå‘ç”Ÿæ”¹å˜çš„æ—¶å€™å°±ä¼šè°ƒç”¨

 * è¿™ä¸ªæ–¹æ³•ä¸“é—¨ç”¨æ¥å¸ƒå±€å­æ§ä»¶ï¼Œè®¾ç½®å­æ§ä»¶çš„frame

 */

- (void)layoutSubviews

{

    // ä¸€å®šè¦è°ƒç”¨superæ–¹æ³•

    [super layoutSubviews];



    CGFloat shopW = self.frame.size.width;

    CGFloat shopH = self.frame.size.height;



    self.iconView.frame = CGRectMake(0, 0, shopW, shopW);

    self.nameLabel.frame = CGRectMake(0, shopW, shopW, shopH - shopW);

}



- (void)setShop:(XMGShop *)shop

{

    _shop = shop;



    self.iconView.image = [UIImage imageNamed:shop.icon];

    self.nameLabel.text = shop.name;

}



@end
</code></pre>

<h6>controller</h6>

<pre><code>@property (nonatomic, strong) NSMutableArray *shops;







// æ‡’åŠ è½½

// 1.ç¬¬ä¸€æ¬¡ç”¨åˆ°æ—¶å†å»åŠ è½½

// 2.åªä¼šåŠ è½½ä¸€æ¬¡

- (NSMutableArray *)shops

{

    if (_shops == nil) {

        // åˆ›å»º"æ¨¡å‹æ•°ç»„"

        _shops = [NSMutableArray array];



        // è·å¾—plistæ–‡ä»¶çš„å…¨è·¯å¾„

        NSString *file = [[NSBundle mainBundle] pathForResource:@"shops.plist" ofType:nil];



        // ä»plistæ–‡ä»¶ä¸­åŠ è½½ä¸€ä¸ªæ•°ç»„å¯¹è±¡(è¿™ä¸ªæ•°ç»„ä¸­å­˜æ”¾çš„éƒ½æ˜¯NSDictionaryå¯¹è±¡)

        NSArray *dictArray = [NSArray arrayWithContentsOfFile:file];



        // å°† â€œå­—å…¸æ•°ç»„â€ è½¬æ¢ä¸º â€œæ¨¡å‹æ•°æ®â€

        for (NSDictionary *dict in dictArray) { // éå†æ¯ä¸€ä¸ªå­—å…¸

            // å°† â€œå­—å…¸â€ è½¬æ¢ä¸º â€œæ¨¡å‹â€

            XMGShop *shop = [XMGShop shopWithDict:dict];



            // å°† â€œæ¨¡å‹â€ æ·»åŠ åˆ° â€œæ¨¡å‹æ•°ç»„ä¸­â€

            [_shops addObject:shop];

        }

    }

    return _shops;

}



// åˆ›å»ºä¸€ä¸ªå•†å“çˆ¶æ§ä»¶

XMGShopView *shopView = [XMGShopView shopViewWithShop:self.shops[index]];

// è®¾ç½®frame

shopView.frame = CGRectMake(shopX, shopY, shopW, shopH);

// å°†å•†å“çˆ¶æ§ä»¶æ·»åŠ åˆ°shopsViewä¸­

[self.shopsView addSubview:shopView];
</code></pre>

<p>/******************************************************************************/</p>

<h3>ä¸ƒï¼šXIB</h3>

<p>1:xibViewä¸­</p>

<pre><code>/** å•†å“æ¨¡å‹ */

@property (nonatomic, strong) XMGShop *shop;

+ (instancetype)shopViewWithShop:(XMGShop *)shop;



+ (instancetype)shopViewWithShop:(XMGShop *)shop

{

    // self == XMGShopView

    // NSStringFromClass(self) == @"XMGShopView"

    XMGShopView *shopView = [[[NSBundle mainBundle] loadNibNamed:NSStringFromClass(self) owner:nil options:nil] lastObject];

    shopView.shop = shop;

    return shopView;

}



- (void)setShop:(XMGShop *)shop

{

    _shop = shop;



    UIImageView *iconView = (UIImageView *)[self viewWithTag:1];

    iconView.image = [UIImage imageNamed:shop.icon];



    UILabel *nameLabel = (UILabel *)[self viewWithTag:2];

    nameLabel.text = shop.name;

}
</code></pre>

<h6>2:æ§åˆ¶å™¨ä¸­è®¾ç½®æ•°æ®</h6>

<pre><code>// ä»xibä¸­åŠ è½½ä¸€ä¸ªå•†å“æ§ä»¶

XMGShopView *shopView = [XMGShopView shopViewWithShop:self.shops[index]];

// è®¾ç½®frame

shopView.frame = CGRectMake(shopX, shopY, shopW, shopH);

// æ·»åŠ å•†å“æ§ä»¶

[self.shopsView addSubview:shopView];
</code></pre>

<p>/******************************************************************************/</p>

<h3>å…«ï¼šMJExtension</h3>

<h6>1:æ˜¯ä¸€å¥—â€œå­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢â€çš„è½»é‡çº§æ¡†æ¶ï¼Œæ¨¡å‹å±æ€§</h6>

<pre><code>/**

 *  å¾®åšæ–‡æœ¬å†…å®¹

 */

@property (copy, nonatomic) NSString *text;



/**

 *  å¾®åšä½œè€…

 */

@property (strong, nonatomic) User *user;



/**

 *  è½¬å‘çš„å¾®åš

 */

@property (strong, nonatomic) Status *retweetedStatus;



/**

 *  å­˜æ”¾ç€æŸä¸€é¡µå¾®åšæ•°æ®ï¼ˆé‡Œé¢éƒ½æ˜¯Statusæ¨¡å‹ï¼‰

 */

@property (strong, nonatomic) NSMutableArray *statuses;



/**

 *  æ€»æ•°

 */

@property (assign, nonatomic) NSNumber *totalNumber;



/**

 *  ä¸Šä¸€é¡µçš„æ¸¸æ ‡

 */

@property (assign, nonatomic) long long previousCursor;



/**

 *  ä¸‹ä¸€é¡µçš„æ¸¸æ ‡

 */

@property (assign, nonatomic) long long nextCursor;





/**

 *  åç§°

 */

@property (copy, nonatomic) NSString *name;



/**

 *  å¤´åƒ

 */

@property (copy, nonatomic) NSString *icon;
</code></pre>

<h6>2:å¯¹åº”æ–¹æ³•çš„å®ç°</h6>

<ul>
<li><p>1.MJExtensionæ˜¯ä¸€å¥—â€œå­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢â€çš„è½»é‡çº§æ¡†æ¶</p></li>
<li><p>2.MJExtensionèƒ½å®Œæˆçš„åŠŸèƒ½</p>

<ul>
<li><p>å­—å…¸ &ndash;> æ¨¡å‹</p></li>
<li><p>æ¨¡å‹ &ndash;> å­—å…¸</p></li>
<li><p>å­—å…¸æ•°ç»„ &ndash;> æ¨¡å‹æ•°ç»„</p></li>
<li><p>æ¨¡å‹æ•°ç»„ &ndash;> å­—å…¸æ•°ç»„</p></li>
</ul>
</li>
<li><p>3.å…·ä½“ç”¨æ³•ä¸»è¦å‚è€ƒ main.mä¸­å„ä¸ªå‡½æ•° ä»¥åŠ &ldquo;NSObject+MJKeyValue.h&rdquo;</p></li>
<li><p>4.å¸Œæœ›å„ä½å¤§ç¥èƒ½ç”¨å¾—çˆ½</p>

<pre><code> #import &lt;Foundation/Foundation.h&gt;

 #import "MJExtension.h"

 #import "User.h"

 #import "Status.h"

 #import "StatusResult.h"



 /**

  *  ç®€å•çš„å­—å…¸ -&gt; æ¨¡å‹

  */

 void keyValues2object()

 {

     // 1.å®šä¹‰ä¸€ä¸ªå­—å…¸

     NSDictionary *dict = @{

                            @"name" : @"Jack",

                            @"icon" : @"lufy.png",

                            };



     // 2.å°†å­—å…¸è½¬ä¸ºUseræ¨¡å‹

     User *user = [User objectWithKeyValues:dict];



     // 3.æ‰“å°Useræ¨¡å‹çš„å±æ€§

     NSLog(@"name=%@, icon=%@", user.name, user.icon);

 }



 /**

  *  å¤æ‚çš„å­—å…¸ -&gt; æ¨¡å‹ (æ¨¡å‹é‡Œé¢åŒ…å«äº†æ¨¡å‹)

  */

 void keyValues2object2()

 {

     // 1.å®šä¹‰ä¸€ä¸ªå­—å…¸

     NSDictionary *dict = @{

                            @"text" : @"æ˜¯å•Šï¼Œä»Šå¤©å¤©æ°”ç¡®å®ä¸é”™ï¼",



                            @"user" : @{

                                    @"name" : @"Jack",

                                    @"icon" : @"lufy.png"

                                    },



                            @"retweetedStatus" : @{

                                    @"text" : @"ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼",



                                    @"user" : @{

                                            @"name" : @"Rose",

                                            @"icon" : @"nami.png"

                                            }

                                    }

                            };



     // 2.å°†å­—å…¸è½¬ä¸ºStatusæ¨¡å‹

     Status *status = [Status objectWithKeyValues:dict];



     // 3.æ‰“å°statusçš„å±æ€§

     NSString *text = status.text;

     NSString *name = status.user.name;

     NSString *icon = status.user.icon;

     NSLog(@"text=%@, name=%@, icon=%@", text, name, icon);



     // 4.æ‰“å°status.retweetedStatusçš„å±æ€§

     NSString *text2 = status.retweetedStatus.text;

     NSString *name2 = status.retweetedStatus.user.name;

     NSString *icon2 = status.retweetedStatus.user.icon;

     NSLog(@"text2=%@, name2=%@, icon2=%@", text2, name2, icon2);

 }



 /**

  *  å¤æ‚çš„å­—å…¸ -&gt; æ¨¡å‹ (æ¨¡å‹çš„æ•°ç»„å±æ€§é‡Œé¢åˆè£…ç€æ¨¡å‹)

  */

 void keyValues2object3()

 {

     // 1.å®šä¹‰ä¸€ä¸ªå­—å…¸

     NSDictionary *dict = @{

                            @"statuses" : @[

                                    @{

                                        @"text" : @"ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼",



                                        @"user" : @{

                                                @"name" : @"Rose",

                                                @"icon" : @"nami.png"

                                                }

                                        },



                                    @{

                                        @"text" : @"æ˜å¤©å»æ—…æ¸¸äº†",



                                        @"user" : @{

                                                @"name" : @"Jack",

                                                @"icon" : @"lufy.png"

                                                }

                                        },



                                    @{

                                        @"text" : @"å˜¿å˜¿ï¼Œè¿™ä¸œè¥¿ä¸é”™å“¦ï¼",



                                        @"user" : @{

                                                @"name" : @"Jim",

                                                @"icon" : @"zero.png"

                                                }

                                        }



                                    ],



                            @"totalNumber" : @"2014",



                            @"previousCursor" : @"13476589",



                            @"nextCursor" : @"13476599"

                            };



     // 2.å°†å­—å…¸è½¬ä¸ºStatusResultæ¨¡å‹

     StatusResult *result = [StatusResult objectWithKeyValues:dict];



     // 3.æ‰“å°StatusResultæ¨¡å‹çš„ç®€å•å±æ€§

     NSLog(@"totalNumber=%d, previousCursor=%lld, nextCursor=%lld", result.totalNumber, result.previousCursor, result.nextCursor);



     // 4.æ‰“å°statusesæ•°ç»„ä¸­çš„æ¨¡å‹å±æ€§

     for (Status *status in result.statuses) {

         NSString *text = status.text;

         NSString *name = status.user.name;

         NSString *icon = status.user.icon;

         NSLog(@"text=%@, name=%@, icon=%@", text, name, icon);

     }

 }



 /**

  *  å­—å…¸æ•°ç»„ -&gt; æ¨¡å‹æ•°ç»„

  */

 void keyValuesArray2objectArray()

 {

     // 1.å®šä¹‰ä¸€ä¸ªå­—å…¸æ•°ç»„

     NSArray *dictArray = @[

                            @{

                                @"name" : @"Jack",

                                @"icon" : @"lufy.png",

                                },



                            @{

                                @"name" : @"Rose",

                                @"icon" : @"nami.png",

                                },



                            @{

                                @"name" : @"Jim",

                                @"icon" : @"zero.png",

                                }

                            ];



     // 2.å°†å­—å…¸æ•°ç»„è½¬ä¸ºUseræ¨¡å‹æ•°ç»„

     NSArray *userArray = [User objectArrayWithKeyValuesArray:dictArray];



     // 3.æ‰“å°userArrayæ•°ç»„ä¸­çš„Useræ¨¡å‹å±æ€§

     for (User *user in userArray) {

         NSLog(@"name=%@, icon=%@", user.name, user.icon);

     }

 }



 /**

  *  æ¨¡å‹ -&gt; å­—å…¸

  */

 void object2keyValues()

 {

     // 1.æ–°å»ºæ¨¡å‹

     User *user = [[User alloc] init];

     user.name = @"Jack";

     user.icon = @"lufy.png";



     Status *status = [[Status alloc] init];

     status.user = user;

     status.text = @"ä»Šå¤©çš„å¿ƒæƒ…ä¸é”™ï¼";



     // 2.å°†æ¨¡å‹è½¬ä¸ºå­—å…¸

     //    NSDictionary *dict = [status keyValues];

     NSDictionary *dict = status.keyValues;

     NSLog(@"%@", dict);

 }



 /**

  *  æ¨¡å‹æ•°ç»„ -&gt; å­—å…¸æ•°ç»„

  */

 void objectArray2keyValuesArray()

 {

     // 1.æ–°å»ºæ¨¡å‹æ•°ç»„

     User *user1 = [[User alloc] init];

     user1.name = @"Jack";

     user1.icon = @"lufy.png";



     User *user2 = [[User alloc] init];

     user2.name = @"Rose";

     user2.icon = @"nami.png";



     User *user3 = [[User alloc] init];

     user3.name = @"Jim";

     user3.icon = @"zero.png";



     NSArray *userArray = @[user1, user2, user3];



     // 2.å°†æ¨¡å‹æ•°ç»„è½¬ä¸ºå­—å…¸æ•°ç»„

     NSArray *dictArray = [User keyValuesArrayWithObjectArray:userArray];

     NSLog(@"%@", dictArray);

 }



 int main(int argc, const char * argv[])

 {

     @autoreleasepool {

         // ç®€å•çš„å­—å…¸ -&gt; æ¨¡å‹

         keyValues2object();



         // å¤æ‚çš„å­—å…¸ -&gt; æ¨¡å‹ (æ¨¡å‹é‡Œé¢åŒ…å«äº†æ¨¡å‹)

         keyValues2object2();



         // å¤æ‚çš„å­—å…¸ -&gt; æ¨¡å‹ (æ¨¡å‹çš„æ•°ç»„å±æ€§é‡Œé¢åˆè£…ç€æ¨¡å‹)

         keyValues2object3();



         // å­—å…¸æ•°ç»„ -&gt; æ¨¡å‹æ•°ç»„

         keyValuesArray2objectArray();



         // æ¨¡å‹è½¬å­—å…¸

         object2keyValues();



         // æ¨¡å‹æ•°ç»„ -&gt; å­—å…¸æ•°ç»„

         objectArray2keyValuesArray();

     }

     return 0;

 }
</code></pre></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">iCocos</span></span>

      




<time class='entry-date' datetime='2014-06-25T13:53:19+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>1:53 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/foundation/'>foundation</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/06/16/runtime/" title="Previous Post: ç©è½¬è¿è¡Œæ—¶">&laquo; ç©è½¬è¿è¡Œæ—¶</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/07/12/popkeyboard/" title="Next Post: ä½ æ˜¯æ€ä¹ˆé€€å‡ºé”®ç›˜çš„ï¼Ÿ">ä½ æ˜¯æ€ä¹ˆé€€å‡ºé”®ç›˜çš„ï¼Ÿ &raquo;</a>
      
    </p>
  </footer>
</article>



  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-title="æ•°æ®ä¸æ¨¡å‹"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"icocoscao"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
    <h1>æ–‡ç« åˆ†ç±»</h1>
    <ul id="categories">
        <li class='category'><a href='/blog/categories/algorithms/'>algorithms (6)</a></li>
<li class='category'><a href='/blog/categories/and/'>and (14)</a></li>
<li class='category'><a href='/blog/categories/apples/'>apples (2)</a></li>
<li class='category'><a href='/blog/categories/application/'>application (1)</a></li>
<li class='category'><a href='/blog/categories/architecture/'>architecture (2)</a></li>
<li class='category'><a href='/blog/categories/audio/'>audio (8)</a></li>
<li class='category'><a href='/blog/categories/audio-video/'>audio-video (1)</a></li>
<li class='category'><a href='/blog/categories/data/'>data (6)</a></li>
<li class='category'><a href='/blog/categories/developer/'>developer (16)</a></li>
<li class='category'><a href='/blog/categories/foundation/'>foundation (31)</a></li>
<li class='category'><a href='/blog/categories/full/'>full (13)</a></li>
<li class='category'><a href='/blog/categories/low-level/'>low-level (4)</a></li>
<li class='category'><a href='/blog/categories/lve/'>lve (8)</a></li>
<li class='category'><a href='/blog/categories/news/'>news (4)</a></li>
<li class='category'><a href='/blog/categories/others/'>others (1)</a></li>
<li class='category'><a href='/blog/categories/performance/'>performance (12)</a></li>
<li class='category'><a href='/blog/categories/practical/'>practical (1)</a></li>
<li class='category'><a href='/blog/categories/radio/'>radio (8)</a></li>
<li class='category'><a href='/blog/categories/reverse/'>reverse (25)</a></li>
<li class='category'><a href='/blog/categories/senior/'>senior (40)</a></li>
<li class='category'><a href='/blog/categories/stack/'>stack (13)</a></li>
<li class='category'><a href='/blog/categories/structures/'>structures (6)</a></li>
<li class='category'><a href='/blog/categories/summarize/'>summarize (5)</a></li>
<li class='category'><a href='/blog/categories/tools/'>tools (5)</a></li>
<li class='category'><a href='/blog/categories/video/'>video (8)</a></li>

    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/09/25/zhi-bo-cai-ji-pian/">ç›´æ’­-é‡‡é›†ç¯‡</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/20/zhi-bo-shi-zhan-pian/">ç›´æ’­-å®æˆ˜ç¯‡</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/15/zhi-bo-yuan-li-pian/">ç›´æ’­-åŸç†ç¯‡</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/10/zhi-bo-ijkplayer/">ç›´æ’­-iJKPlayer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/08/yuan-li-zong-jie-h264-acc-flv/">åŸç†-H264-ACC-FLVğŸ˜‚æ€»ç»“</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/al1020119">@al1020119</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'al1020119',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
<h1>æ‰«ä¸€æ‰«<abbr title="The word 'æ‰«ä¸€æ‰«' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'æ‰«ä¸€æ‰«', not for image.">&trade;</abbr></h1>
<a href="http://al1020119.github.io/blog/2014/06/25/data%20model/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://al1020119.github.io/blog/2014/06/25/data%20model/" alt="post-qrcode"></a></section>
<section>
    <h1>è®¿å®¢ç»Ÿè®¡</h1>
    <br/>
    <a href="http://s07.flagcounter.com/more/2SH"><img src="http://s07.flagcounter.com/count/2SH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/" alt="Flag Counter" border="0"></a>
</section><section>
    <h1>æ–°æµªå¾®åš</h1>
    <ul id="weibo">
        <li>
            
            <!-- åœ¨æ­¤æ’å…¥è·å¾—çš„å¾®åšç§€ä»£ç  -->
            <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3288975567&verifier=20ffcedd&dpc=1"></iframe>
            
        </li>
    </ul>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - iCocos -
<span class="credit">welcome to <a href="http://al1020119.github.io">æ›¹#é»</a></span>
</p>

</footer>
  






<!--
-->



</body>
</html>
