
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>å®Œè™ThinkPHP 5.* è¿œä¸æ­¢è¿™äº›ğŸ˜±ğŸ˜‚ - iOSæ¢¦å·¥å‚</title>
  <meta name="author" content="iCocos">

  
  <meta name="description" content="ç›®å½• ä¸‹è½½å®‰è£…
è§„èŒƒæ•´ç†
ç»“æ„ä»‹ç»
ç®€å•é…ç½®
ç®€å•æ•°æ®æ˜¾ç¤º
æ•°æ®åº“é…ç½®
æ•°æ®åº“åŸºæœ¬ä½¿ç”¨
æ¨¡å‹åŸºæœ¬ä½¿ç”¨
æ€»ç»“ï¼šï¼ˆThinkPhp5.+ ThinkPhp3.+ï¼‰ ä¸‹è½½å®‰è£… ä¸€ã€å®˜ç½‘ä¸‹è½½å®‰è£… è·å–ThinkPHPçš„æ–¹å¼å¾ˆå¤šï¼Œå®˜æ–¹ç½‘ç«™ï¼ˆhttp://thinkphp.cnï¼‰ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://al1020119.github.io/blog/2016/12/01/wan-zhuan-thinkphp-5-dot-star/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iOSæ¢¦å·¥å‚" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

<!--<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">iOSæ¢¦å·¥å‚</a></h1>
  
    <h2>iCocosâ€”â€”ä¸æˆ˜èƒœè‡ªå·±ï¼Œä½•ä»¥æ”¹å˜æœªæ¥ï¼</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="al1020119.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">åšæ–‡</a></li>
  <li><a href="/blog/archives">å½’æ¡£</a></li>
  <li><a href="/icocos">iCocos</a></li>
  <li><a href="/about">æ–‡ç« </a></li>
  <li><a href="/other">å…¶ä»–</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">å®Œè™ThinkPHP 5.* è¿œä¸æ­¢è¿™äº›ğŸ˜±ğŸ˜‚</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-12-01T00:30:20+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>12:30 am</span></time>
        
        
        |   <a href="#comments">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>ç›®å½•</h2>

<ol>
<li>ä¸‹è½½å®‰è£…</li>
<li>è§„èŒƒæ•´ç†</li>
<li>ç»“æ„ä»‹ç»</li>
<li>ç®€å•é…ç½®</li>
<li>ç®€å•æ•°æ®æ˜¾ç¤º</li>
<li>æ•°æ®åº“é…ç½®</li>
<li>æ•°æ®åº“åŸºæœ¬ä½¿ç”¨</li>
<li>æ¨¡å‹åŸºæœ¬ä½¿ç”¨</li>
<li>æ€»ç»“ï¼šï¼ˆThinkPhp5.+ <-->ThinkPhp3.+ï¼‰</li>
</ol>


<!--more-->


<h3>ä¸‹è½½å®‰è£…</h3>

<h6>ä¸€ã€å®˜ç½‘ä¸‹è½½å®‰è£…</h6>

<p>è·å–ThinkPHPçš„æ–¹å¼å¾ˆå¤šï¼Œå®˜æ–¹ç½‘ç«™ï¼ˆ<a href="http://thinkphp.cn">http://thinkphp.cn</a>ï¼‰æä¾›äº†ç¨³å®šç‰ˆæœ¬æˆ–è€…å¸¦æ‰©å±•å®Œæ•´ç‰ˆæœ¬çš„ä¸‹è½½ã€‚</p>

<pre><code>å®˜ç½‘çš„ä¸‹è½½ç‰ˆæœ¬ä¸ä¸€å®šæ˜¯æœ€æ–°ç‰ˆæœ¬ï¼ŒGITç‰ˆæœ¬è·å–çš„æ‰æ˜¯ä¿æŒæ›´æ–°çš„ç‰ˆæœ¬ã€‚
</code></pre>

<h6>äºŒã€Composerå®‰è£…</h6>

<p>ThinkPHP5æ”¯æŒä½¿ç”¨Composerå®‰è£…ï¼Œå¦‚æœè¿˜æ²¡æœ‰å®‰è£… Composerï¼Œä½ å¯ä»¥æŒ‰ Composerå®‰è£… ä¸­çš„æ–¹æ³•å®‰è£…ã€‚åœ¨ Linux å’Œ Mac OS X ä¸­å¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>

<pre><code>curl -sS https://getcomposer.org/installer | php
mv composer.phar /usr/local/bin/composer
</code></pre>

<ul>
<li>åœ¨ Windows ä¸­ï¼Œä½ éœ€è¦ä¸‹è½½å¹¶è¿è¡Œ Composer-Setup.exeã€‚</li>
</ul>


<p>ç„¶ååœ¨å‘½ä»¤è¡Œä¸‹é¢ï¼Œåˆ‡æ¢åˆ°ä½ çš„webæ ¹ç›®å½•ä¸‹é¢å¹¶æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p>

<pre><code>composer create-project topthink/think tp5  --prefer-dist
</code></pre>

<ul>
<li>composeræ›´æ–°æ–¹å¼ï¼šcomposer self-update</li>
</ul>


<h6>ä¸‰ã€Gitå®‰è£…</h6>

<p>å¦‚æœä½ ä¸å¤ªäº†è§£Composeræˆ–è€…è§‰å¾—Composerå¤ªæ…¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨gitç‰ˆæœ¬åº“å®‰è£…å’Œæ›´æ–°ï¼ŒThinkPHP5.0æ‹†åˆ†ä¸ºå¤šä¸ªä»“åº“ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>

<pre><code>åº”ç”¨é¡¹ç›®ï¼šhttps://github.com/top-think/think
æ ¸å¿ƒæ¡†æ¶ï¼šhttps://github.com/top-think/framework 

ä¹‹æ‰€ä»¥è®¾è®¡ä¸ºåº”ç”¨å’Œæ ¸å¿ƒä»“åº“åˆ†ç¦»ï¼Œæ˜¯ä¸ºäº†æ”¯æŒComposerå•ç‹¬æ›´æ–°æ ¸å¿ƒæ¡†æ¶ã€‚
</code></pre>

<p>é¦–å…ˆå…‹éš†ä¸‹è½½åº”ç”¨é¡¹ç›®ä»“åº“</p>

<pre><code>git clone https://github.com/top-think/think tp5
</code></pre>

<p>ç„¶ååˆ‡æ¢åˆ°tp5ç›®å½•ä¸‹é¢ï¼Œå†å…‹éš†æ ¸å¿ƒæ¡†æ¶ä»“åº“ï¼š</p>

<pre><code>git clone https://github.com/top-think/framework thinkphp
</code></pre>

<p>ä¸¤ä¸ªä»“åº“å…‹éš†å®Œæˆåï¼Œå°±å®Œæˆäº†ThinkPHP5.0çš„Gitæ–¹å¼ä¸‹è½½ï¼Œå¦‚æœéœ€è¦æ›´æ–°æ ¸å¿ƒæ¡†æ¶çš„æ—¶å€™ï¼Œåªéœ€è¦åˆ‡æ¢åˆ°thinkphpæ ¸å¿ƒç›®å½•ä¸‹é¢ï¼Œç„¶åæ‰§è¡Œï¼š</p>

<pre><code>git pull https://github.com/top-think/framework
</code></pre>

<blockquote><p>å¦‚æœä¸ç†Ÿæ‚‰gitå‘½ä»¤è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€ä¸ªGITå®¢æˆ·ç«¯è¿›è¡Œæ“ä½œï¼Œåœ¨æ­¤ä¸å†è¯¦ç»†è¯´æ˜ã€‚</p></blockquote>

<p>æ— è®ºä½ é‡‡ç”¨ä»€ä¹ˆæ–¹å¼è·å–çš„ThinkPHPæ¡†æ¶ï¼Œç°åœ¨åªéœ€è¦åšæœ€åä¸€æ­¥æ¥éªŒè¯æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p>

<p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥åœ°å€ï¼š</p>

<pre><code>http://localhost/tp5/public/
</code></pre>

<p>å¦‚æœæµè§ˆå™¨è¾“å‡ºå¦‚å›¾æ‰€ç¤ºï¼Œé‚£ä¹ˆè¯´æ˜ä½ æˆåŠŸäº†ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆè¯·æ£€æµ‹ç›¸å…³é…ç½®æˆ–è€…æ­¥éª¤ï¼š</p>

<p><img src="/images/thinkphp5_0001.png" title="Caption" ></p>

<h3>è§„èŒƒæ•´ç†</h3>

<p>ThinkPHP5éµå¾ªPSR-2å‘½åè§„èŒƒå’ŒPSR-4è‡ªåŠ¨åŠ è½½è§„èŒƒï¼Œå¹¶ä¸”æ³¨æ„å¦‚ä¸‹è§„èŒƒï¼š</p>

<h6>ç›®å½•å’Œæ–‡ä»¶</h6>

<pre><code>ç›®å½•ä¸å¼ºåˆ¶è§„èŒƒï¼Œé©¼å³°åŠå°å†™+ä¸‹åˆ’çº¿æ¨¡å¼å‡æ”¯æŒï¼›
ç±»åº“ã€å‡½æ•°æ–‡ä»¶ç»Ÿä¸€ä»¥.phpä¸ºåç¼€ï¼›
ç±»çš„æ–‡ä»¶åå‡ä»¥å‘½åç©ºé—´å®šä¹‰ï¼Œå¹¶ä¸”å‘½åç©ºé—´çš„è·¯å¾„å’Œç±»åº“æ–‡ä»¶æ‰€åœ¨è·¯å¾„ä¸€è‡´ï¼›
ç±»æ–‡ä»¶é‡‡ç”¨é©¼å³°æ³•å‘½åï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå…¶å®ƒæ–‡ä»¶é‡‡ç”¨å°å†™+ä¸‹åˆ’çº¿å‘½åï¼›
ç±»åå’Œç±»æ–‡ä»¶åä¿æŒä¸€è‡´ï¼Œç»Ÿä¸€é‡‡ç”¨é©¼å³°æ³•å‘½åï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼›
</code></pre>

<h6>å‡½æ•°å’Œç±»ã€å±æ€§å‘½å</h6>

<pre><code>ç±»çš„å‘½åé‡‡ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œä¾‹å¦‚ Userã€UserTypeï¼Œé»˜è®¤ä¸éœ€è¦æ·»åŠ åç¼€ï¼Œä¾‹å¦‚UserControlleråº”è¯¥ç›´æ¥å‘½åä¸ºUserï¼›
å‡½æ•°çš„å‘½åä½¿ç”¨å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿ï¼ˆå°å†™å­—æ¯å¼€å¤´ï¼‰çš„æ–¹å¼ï¼Œä¾‹å¦‚ get_client_ipï¼›
æ–¹æ³•çš„å‘½åä½¿ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å°å†™ï¼‰ï¼Œä¾‹å¦‚ getUserNameï¼›
å±æ€§çš„å‘½åä½¿ç”¨é©¼å³°æ³•ï¼ˆé¦–å­—æ¯å°å†™ï¼‰ï¼Œä¾‹å¦‚ tableNameã€instanceï¼›
ä»¥åŒä¸‹åˆ’çº¿â€œ__â€æ‰“å¤´çš„å‡½æ•°æˆ–æ–¹æ³•ä½œä¸ºé­”æ³•æ–¹æ³•ï¼Œä¾‹å¦‚ __call å’Œ __autoloadï¼›
</code></pre>

<h6>å¸¸é‡å’Œé…ç½®</h6>

<pre><code>å¸¸é‡ä»¥å¤§å†™å­—æ¯å’Œä¸‹åˆ’çº¿å‘½åï¼Œä¾‹å¦‚ APP_PATHå’Œ THINK_PATHï¼›
é…ç½®å‚æ•°ä»¥å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿å‘½åï¼Œä¾‹å¦‚ url_route_on å’Œurl_convertï¼›
</code></pre>

<h6>æ•°æ®è¡¨å’Œå­—æ®µ</h6>

<pre><code>æ•°æ®è¡¨å’Œå­—æ®µé‡‡ç”¨å°å†™åŠ ä¸‹åˆ’çº¿æ–¹å¼å‘½åï¼Œå¹¶æ³¨æ„å­—æ®µåä¸è¦ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œä¾‹å¦‚ think_user è¡¨å’Œ user_nameå­—æ®µï¼Œä¸å»ºè®®ä½¿ç”¨é©¼å³°å’Œä¸­æ–‡ä½œä¸ºæ•°æ®è¡¨å­—æ®µå‘½åã€‚
</code></pre>

<h6>åº”ç”¨ç±»åº“å‘½åç©ºé—´è§„èŒƒ</h6>

<p>åº”ç”¨ç±»åº“çš„æ ¹å‘½åç©ºé—´ç»Ÿä¸€ä¸ºappï¼ˆå¯ä»¥è®¾ç½®app_namespaceé…ç½®å‚æ•°æ›´æ”¹ï¼‰</p>

<pre><code>ä¾‹å¦‚ï¼šapp\index\controller\Indexå’Œapp\index\model\Userã€‚
</code></pre>

<h3>ç»“æ„ä»‹ç»</h3>

<p>ä¸‹è½½æœ€æ–°ç‰ˆæ¡†æ¶åï¼Œè§£å‹ç¼©åˆ°webç›®å½•ä¸‹é¢ï¼Œå¯ä»¥çœ‹åˆ°åˆå§‹çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>

<p><img src="/images/thinkphp5_0002.png" title="Caption" ></p>

<p>5.0çš„éƒ¨ç½²å»ºè®®æ˜¯publicç›®å½•ä½œä¸ºwebç›®å½•è®¿é—®å†…å®¹ï¼Œå…¶å®ƒéƒ½æ˜¯webç›®å½•ä¹‹å¤–ï¼Œå½“ç„¶ï¼Œä½ å¿…é¡»è¦ä¿®æ”¹public/index.phpä¸­çš„ç›¸å…³è·¯å¾„ã€‚å¦‚æœæ²¡æ³•åšåˆ°è¿™ç‚¹ï¼Œè¯·è®°å¾—è®¾ç½®ç›®å½•çš„è®¿é—®æƒé™æˆ–è€…æ·»åŠ ç›®å½•åˆ—è¡¨çš„ä¿æŠ¤æ–‡ä»¶ã€‚</p>

<pre><code>router.phpç”¨äºphpè‡ªå¸¦webserveræ”¯æŒï¼Œå¯ç”¨äºå¿«é€Ÿæµ‹è¯•
å¯åŠ¨å‘½ä»¤ï¼šphp -S localhost:8888 router.php
</code></pre>

<p>5.0ç‰ˆæœ¬è‡ªå¸¦äº†ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç›®å½•ç»“æ„å’Œé»˜è®¤çš„åº”ç”¨å…¥å£æ–‡ä»¶ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šçµæ´»è°ƒæ•´ã€‚</p>

<pre><code>ä¸Šé¢çš„ç›®å½•ç»“æ„å’Œåç§°æ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œå°¤å…¶æ˜¯åº”ç”¨çš„ç›®å½•ç»“æ„ï¼Œè¿™å–å†³äºä½ çš„å…¥å£æ–‡ä»¶å’Œé…ç½®å‚æ•°ã€‚
</code></pre>

<p>è¿™é‡Œæ˜¯æˆ‘ä¸‹è½½è§£å‹åçš„ç›®å½•ç»“æ„</p>

<p><img src="/images/thinkphp5_0003.png" title="Caption" ></p>

<h3>ç®€å•é…ç½®</h3>

<p>ç»†å¿ƒçš„è¯æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒThinkPhp5ä¸­å…¥å£æ–‡ä»¶ç›¸å¯¹ThinkPhp3ä¸­çš„å…¥å£æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼Œåœ¨ThinkPhp5ä¸­çš„å…¥å£æ–‡ä»¶æ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¸­çš„publicé‡Œé¢index.phpæ–‡ä»¶ï¼Œå…¶å®5ç›¸å¯¹3æ¥è¯´ï¼Œå˜åŒ–è¿˜æ˜¯æŒºå¤§çš„ï¼Œå¦‚æœä¹‹å‰æ˜¯ä½¿ç”¨3å†™çš„é¡¹ç›®ã€‚è¦å‡çº§åˆ°5çš„è¯ï¼Œä¼°è®¡ä¹Ÿæ˜¯ä¸€ä¸ªå¤§å·¥ç¨‹ï¼Œéœ€è¦å¾ˆç»†å¿ƒçš„å¤„ç†ã€‚</p>

<ul>
<li>å‰é¢æˆ‘ä»¬è¾“å…¥äº†ï¼š<a href="http://localhost/tp5/public/">http://localhost/tp5/public/</a></li>
</ul>


<p>æŸ¥çœ‹publicä¸­å¯ä»¥çœ‹åˆ°index.phpçš„å†…å®¹å’ŒThinkPhp3ä¸­çš„å…¥å£æœ‰ç‚¹ç›¸ä¼¼ï¼š</p>

<p>ThinkPhp3çš„å…¥å£æ–‡ä»¶</p>

<pre><code>// åº”ç”¨å…¥å£æ–‡ä»¶

// æ£€æµ‹PHPç¯å¢ƒ
if(version_compare(PHP_VERSION,'5.3.0','&lt;'))  die('require PHP &gt; 5.3.0 !');

// å¼€å¯è°ƒè¯•æ¨¡å¼ å»ºè®®å¼€å‘é˜¶æ®µå¼€å¯ éƒ¨ç½²é˜¶æ®µæ³¨é‡Šæˆ–è€…è®¾ä¸ºfalse
define('APP_DEBUG',True);

// å®šä¹‰åº”ç”¨ç›®å½•
define('APP_NAME','App');
// å®šä¹‰åº”ç”¨ç›®å½•
define('APP_PATH','./App/');

// å¼•å…¥ThinkPHPå…¥å£æ–‡ä»¶
require './ThinkPHP/ThinkPHP.php';

// äº²^_^ åé¢ä¸éœ€è¦ä»»ä½•ä»£ç äº† å°±æ˜¯å¦‚æ­¤ç®€å•
</code></pre>

<p>ThinkPhp5çš„å…¥å£æ–‡ä»¶</p>

<pre><code>// [ åº”ç”¨å…¥å£æ–‡ä»¶ ]

// å®šä¹‰åº”ç”¨ç›®å½•
define('APP_PATH', __DIR__ . '/../application/');
// åŠ è½½æ¡†æ¶å¼•å¯¼æ–‡ä»¶
require __DIR__ . '/../thinkphp/start.php';
</code></pre>

<p>æ‰€ä»¥æˆ‘ä»¬ä¼šå‘ç°å…¥å£æ–‡ä»¶æŒ‡å‘çš„æ˜¯Applicationæ–‡ä»¶å¤¹ï¼Œç„¶åè¿›å…¥åˆ°Applicationæ–‡ä»¶å¤¹ï¼Œæœ‰ä¸ªindexæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸ªControlleræ–‡ä»¶å¤¹ï¼Œæ‰“å¼€index.phpæ–‡ä»¶ï¼Œçœ‹åˆ°ï¼š</p>

<pre><code>&lt;?php
namespace app\index\controller;

class Index
{
    public function index()
    {
        return '&lt;style type="text/css"&gt;*{ padding: 0; margin: 0; } .think_default_text{ padding: 4px 48px;} a{color:#2E5CD5;cursor: pointer;text-decoration: none} a:hover{text-decoration:underline; } body{ background: #fff; font-family: "Century Gothic","Microsoft yahei"; color: #333;font-size:18px} h1{ font-size: 100px; font-weight: normal; margin-bottom: 12px; } p{ line-height: 1.6em; font-size: 42px }&lt;/style&gt;&lt;div style="padding: 24px 48px;"&gt; &lt;h1&gt;:)&lt;/h1&gt;&lt;p&gt; ThinkPHP V5&lt;br/&gt;&lt;span style="font-size:30px"&gt;åå¹´ç£¨ä¸€å‰‘ - ä¸ºAPIå¼€å‘è®¾è®¡çš„é«˜æ€§èƒ½æ¡†æ¶&lt;/span&gt;&lt;/p&gt;&lt;span style="font-size:22px;"&gt;[ V5.0 ç‰ˆæœ¬ç”± &lt;a href="http://www.qiniu.com" target="qiniu"&gt;ä¸ƒç‰›äº‘&lt;/a&gt; ç‹¬å®¶èµåŠ©å‘å¸ƒ ]&lt;/span&gt;&lt;/div&gt;&lt;script type="text/javascript" src="http://tajs.qq.com/stats?sId=9347272" charset="UTF-8"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="http://ad.topthink.com/Public/static/client.js"&gt;&lt;/script&gt;&lt;thinkad id="ad_bd568ce7058a1091"&gt;&lt;/thinkad&gt;';
    }
}
</code></pre>

<p>å…¶ä¸­returnè¿”å›çš„æ•°æ®ï¼Œæ­£å¥½æ˜¯æˆ‘ä»¬å‰é¢è¾“å…¥ï¼š<a href="http://localhost/tp5/public/">http://localhost/tp5/public/</a>æ‰€çœ‹åˆ°å¯¹åº”çš„æ•°æ®ã€‚</p>

<p>ä¸‹é¢å¼€å§‹ç®€å•çš„é¡¹ç›®æ–‡ä»¶é…ç½®ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯è€Œå®šï¼‰ã€‚</p>

<h6>æ–‡ä»¶åˆ›å»º</h6>

<p>ä¸€åˆ‡å…ˆä»Applicationæ–‡ä»¶å¤¹å¼€å§‹ã€‚å› ä¸ºæˆ‘ä»¬å¹³æ—¶ä¸€ä¸ªé¡¹ç›®ä¸­éƒ½ä¼šåˆ†å‰åç«¯ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨Applicationä¸­æ–°å»ºä¸€äº›æ–‡ä»¶ä¸ªæ–‡ä»¶å¤¹ï¼Œè‡³äºindexæ–‡ä»¶å¤¹å¯ä»¥ä¸ç”¨ç®¡ï¼Œä¹Ÿå¯ä»¥åœ¨ä»–çš„åŸºç¡€ä¸Šæˆ–è€…ç›´æ¥æŠŠä»–å½“åšå‰æ®µæ–‡ä»¶å¤¹ã€‚</p>

<ul>
<li><p>homeæ–‡ä»¶å¤¹</p>

<ul>
<li>common.phpæ–‡ä»¶</li>
<li>config.phpæ–‡ä»¶</li>
<li>controlleræ–‡ä»¶å¤¹

<ul>
<li>index.phpæ–‡ä»¶</li>
</ul>
</li>
<li>viewæ–‡ä»¶å¤¹

<ul>
<li>indexæ–‡ä»¶å¤¹

<ul>
<li>index.htmlæ–‡ä»¶</li>
</ul>
</li>
</ul>
</li>
<li>modelæ–‡ä»¶å¤¹</li>
</ul>
</li>
<li><p>adminæ–‡ä»¶å¤¹</p>

<ul>
<li>common.phpæ–‡ä»¶</li>
<li>config.phpæ–‡ä»¶</li>
<li>controlleræ–‡ä»¶å¤¹

<ul>
<li>index.phpæ–‡ä»¶</li>
</ul>
</li>
<li>viewæ–‡ä»¶å¤¹

<ul>
<li>indexæ–‡ä»¶å¤¹

<ul>
<li>index.htmlæ–‡ä»¶</li>
</ul>
</li>
</ul>
</li>
<li>modelæ–‡ä»¶å¤¹</li>
</ul>
</li>
<li><p>app_extendæ–‡ä»¶å¤¹</p>

<ul>
<li>common.phpæ–‡ä»¶</li>
<li>config.phpæ–‡ä»¶</li>
<li>controlleræ–‡ä»¶å¤¹

<ul>
<li>miaoshaæ–‡ä»¶å¤¹</li>
<li>weixinæ–‡ä»¶å¤¹</li>
<li>tuangouæ–‡ä»¶å¤¹</li>
</ul>
</li>
<li>viewæ–‡ä»¶å¤¹

<ul>
<li>miaoshaæ–‡ä»¶å¤¹</li>
<li>weixinæ–‡ä»¶å¤¹</li>
<li>tuangouæ–‡ä»¶å¤¹</li>
</ul>
</li>
<li>modelæ–‡ä»¶å¤¹

<ul>
<li>miaoshaæ–‡ä»¶å¤¹</li>
<li>weixinæ–‡ä»¶å¤¹</li>
<li>tuangouæ–‡ä»¶å¤¹</li>
</ul>
</li>
</ul>
</li>
<li><p>commonæ–‡ä»¶å¤¹</p></li>
</ul>


<p>å…³äºå…¶ä»–é…ç½®å’Œç›¸å…³æ–‡ä»¶çš„ä»‹ç»è¿™é‡Œå°±ç•¥è¿‡äº†ã€‚ç›¸ä¿¡æœ‰ä¸€ç‚¹åŸºç¡€ä¸€åº”éƒ½èƒ½çœ‹æ‡‚ã€‚</p>

<h3>æ•°æ®ç®€å•æ˜¾ç¤º</h3>

<ol>
<li>åœ¨adminå’Œhomeä¸­controlleræ–‡ä»¶å¤¹å¯¹åº”çš„index.phpæ–‡ä»¶ä¸­å†™ä¸‹é¢ä»£ç ï¼š</li>
</ol>


<p>index.phpå®ç°</p>

<pre><code>&lt;?php
namespace app\home\controller;

use think\Controller;

class Index extends Controller
{
    public function index()
    {
        return $this-&gt;fetch();
    }
}
</code></pre>

<p>fetch()å’ŒThinkPhp3ä¸­çš„display()æ–¹æ³•çš„åŠŸèƒ½ä¸€åº”ï¼Œå®ç°MVå±‚çš„ä¼ é€’ã€‚</p>

<pre><code>fetch   æ¸²æŸ“æ¨¡æ¿è¾“å‡º
display     æ¸²æŸ“å†…å®¹è¾“å‡º
assign  æ¨¡æ¿å˜é‡èµ‹å€¼
engine  åˆå§‹åŒ–æ¨¡æ¿å¼•æ“
</code></pre>

<ol>
<li>åœ¨adminå’Œhomeä¸­viewæ–‡ä»¶å¤¹å¯¹åº”çš„index.htmlæ–‡ä»¶ä¸­å†™ä¸‹é¢ä»£ç ï¼š</li>
</ol>


<p>index.htmlå®ç°</p>

<pre><code>&lt;html&gt;

&lt;head&gt;
    &lt;meta charset = "utf-8"&gt;
&lt;/head&gt; 

 &lt;body&gt;

æ¬¢è¿æ¥åˆ°iCocos=nameï¼›ï¼›ï¼›ï¼›ï¼›ï¼›ï¼›ï¼›ï¼›ï¼›ï¼›

 &lt;/body&gt;

&lt;/html&gt;
</code></pre>

<p>è‡³äºè§†å›¾çš„å®ä¾‹åŒ–å’Œç›¸å…³é…ç½®ï¼Œä½¿ç”¨å’Œæ¸²æŸ“è¯·æŸ¥çœ‹å®˜æ–¹æ‰‹å†Œï¼š<a href="http://www.kancloud.cn/manual/thinkphp5/118113">è§†å›¾</a></p>

<p>ä½¿ç”¨ï¼šæµè§ˆå™¨åˆ†åˆ«è¾“å…¥ä¸‹é¢çš„è·¯å¾„ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”æˆ‘ä»¬æƒ³è¦çœ‹åˆ°çš„ç•Œé¢</p>

<p>homeï¼š</p>

<pre><code>http://127.0.0.1/ThComp3/public/home/index
</code></pre>

<p>adminï¼š</p>

<pre><code>http://127.0.0.1/ThComp3/public/admin/index
</code></pre>

<p>è¿™é‡Œå°±ç®€å•çš„å®ç°äº†MVCä¸­Må±‚å’ŒVå±‚ä¹‹é—´çš„å¤„ç†ã€‚</p>

<h3>æ•°æ®åº“é…ç½®</h3>

<ol>
<li>å…ˆä½¿ç”¨Navicatæˆ–è€…phpMyAdminåˆ›å»ºå¯¹åº”çš„æ•°æ®åº“å’Œè¡¨ï¼Œå¹¶ä¸”åˆå§‹åŒ–ä¸€äº›å­—æ®µï¼Œç„¶åæ’å…¥ä¸€æ¡ç®€å•çš„æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨Navicatï¼ˆæ”¯æŒå¤šæ•°æ•°æ®åº“ï¼Œæ“ä½œç®€å•ï¼‰ã€‚</li>
</ol>


<p><img src="/images/thinkphp5_0004.png" title="Caption" ></p>

<ol>
<li>é…ç½®æ•°æ®åº“ç›¸å…³å±æ€§</li>
</ol>


<p>åœ¨è¿™ä¹‹å‰å…ˆå›é¡¾ä¸€ä¸‹åŸç”ŸPHPä»€ä¹ˆå®ç°è¿™ä¸ªæ“ä½œã€‚</p>

<h6>é“¾æ¥æ•°æ®åº“</h6>

<p>é¢å‘å¯¹è±¡</p>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";

// åˆ›å»ºè¿æ¥
$conn = new mysqli($servername, $username, $password);

// æ£€æµ‹è¿æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
} 
echo "è¿æ¥æˆåŠŸ";
?&gt;
</code></pre>

<p>PDOå®ç°</p>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";

try {
    $conn = new PDO("mysql:host=$servername;dbname=myDB", $username, $password);
    echo "è¿æ¥æˆåŠŸ"; 
}
catch(PDOException $e)
{
    echo $e-&gt;getMessage();
}
?&gt;

å…³é—­

$conn-&gt;close(); 
$conn = null; 
</code></pre>

<h6>åˆ›å»ºæ•°æ®åº“</h6>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";

// åˆ›å»ºè¿æ¥
$conn = new mysqli($servername, $username, $password);
// æ£€æµ‹è¿æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
}

// åˆ›å»ºæ•°æ®åº“
$sql = "CREATE DATABASE myDB";
if ($conn-&gt;query($sql) === TRUE) {
    echo "æ•°æ®åº“åˆ›å»ºæˆåŠŸ";
} else {
    echo "Error creating database: " . $conn-&gt;error;
}

$conn-&gt;close();
?&gt; 
</code></pre>

<h6>åˆ›å»ºè¡¨</h6>

<pre><code> &lt;?php
$servername = "localhost";
$username = "username";
$password = "password";
$dbname = "myDB";

// åˆ›å»ºè¿æ¥
$conn = new mysqli($servername, $username, $password, $dbname);
// æ£€æµ‹è¿æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
}

// ä½¿ç”¨ sql åˆ›å»ºæ•°æ®è¡¨
$sql = "CREATE TABLE MyGuests (
id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,
firstname VARCHAR(30) NOT NULL,
lastname VARCHAR(30) NOT NULL,
email VARCHAR(50),
reg_date TIMESTAMP
)";

if ($conn-&gt;query($sql) === TRUE) {
    echo "Table MyGuests created successfully";
} else {
    echo "åˆ›å»ºæ•°æ®è¡¨é”™è¯¯: " . $conn-&gt;error;
}

$conn-&gt;close();
?&gt; 
</code></pre>

<h6>æ’å…¥æ•°æ®åº“</h6>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";
$dbname = "myDB";

// åˆ›å»ºè¿æ¥
$conn = new mysqli($servername, $username, $password, $dbname);
// æ£€æµ‹è¿æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
}

$sql = "INSERT INTO MyGuests (firstname, lastname, email)
VALUES ('John', 'Doe', 'john@example.com')";

if ($conn-&gt;query($sql) === TRUE) {
    echo "æ–°è®°å½•æ’å…¥æˆåŠŸ";
} else {
    echo "Error: " . $sql . "&lt;br&gt;" . $conn-&gt;error;
}

$conn-&gt;close();
?&gt; 
</code></pre>

<h6>æ’å…¥å¤šæ¡</h6>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";
$dbname = "myDB";

// åˆ›å»ºé“¾æ¥
$conn = new mysqli($servername, $username, $password, $dbname);
// æ£€æŸ¥é“¾æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
}

$sql = "INSERT INTO MyGuests (firstname, lastname, email)
VALUES ('John', 'Doe', 'john@example.com');";
$sql .= "INSERT INTO MyGuests (firstname, lastname, email)
VALUES ('Mary', 'Moe', 'mary@example.com');";
$sql .= "INSERT INTO MyGuests (firstname, lastname, email)
VALUES ('Julie', 'Dooley', 'julie@example.com')";

if ($conn-&gt;multi_query($sql) === TRUE) {
    echo "æ–°è®°å½•æ’å…¥æˆåŠŸ";
} else {
    echo "Error: " . $sql . "&lt;br&gt;" . $conn-&gt;error;
}

$conn-&gt;close();
?&gt; 
</code></pre>

<h6>æŸ¥è¯¢æ•°æ®</h6>

<pre><code>&lt;?php
$servername = "localhost";
$username = "username";
$password = "password";
$dbname = "myDB";

// åˆ›å»ºè¿æ¥
$conn = new mysqli($servername, $username, $password, $dbname);
// æ£€æµ‹è¿æ¥
if ($conn-&gt;connect_error) {
    die("è¿æ¥å¤±è´¥: " . $conn-&gt;connect_error);
}

$sql = "SELECT id, firstname, lastname FROM MyGuests";
$result = $conn-&gt;query($sql);

if ($result-&gt;num_rows &gt; 0) {
    // è¾“å‡ºæ¯è¡Œæ•°æ®
    while($row = $result-&gt;fetch_assoc()) {
        echo "&lt;br&gt; id: ". $row["id"]. " - Name: ". $row["firstname"]. " " . $row["lastname"];
    }
} else {
    echo "0 ä¸ªç»“æœ";
}
$conn-&gt;close();
?&gt; 
</code></pre>

<h6>æ›´æ–°</h6>

<pre><code>&lt;?php
$con=mysqli_connect("localhost","username","password","database");
// æ£€æµ‹è¿æ¥
if (mysqli_connect_errno())
{
    echo "è¿æ¥å¤±è´¥: " . mysqli_connect_error();
}

mysqli_query($con,"UPDATE Persons SET Age=36
WHERE FirstName='Peter' AND LastName='Griffin'");

mysqli_close($con);
?&gt;
</code></pre>

<h6>åˆ é™¤</h6>

<pre><code>&lt;?php
$con=mysqli_connect("localhost","username","password","database");
// æ£€æµ‹è¿æ¥
if (mysqli_connect_errno())
{
    echo "è¿æ¥å¤±è´¥: " . mysqli_connect_error();
}

mysqli_query($con,"DELETE FROM Persons WHERE LastName='Griffin'");

mysqli_close($con);
?&gt;
</code></pre>

<h6>ODBC</h6>

<p>ä¸‹é¢çš„å®ä¾‹å±•ç¤ºäº†å¦‚ä½•é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œæ¥ç€åˆ›å»ºä¸€ä¸ªç»“æœé›†ï¼Œç„¶ååœ¨ HTML è¡¨æ ¼ä¸­æ˜¾ç¤ºæ•°æ®ã€‚</p>

<pre><code>&lt;html&gt;
&lt;body&gt;

&lt;?php
$conn=odbc_connect('northwind','','');
if (!$conn)
{
    exit("è¿æ¥å¤±è´¥: " . $conn);
}

$sql="SELECT * FROM customers";
$rs=odbc_exec($conn,$sql);

if (!$rs)
{
    exit("SQL è¯­å¥é”™è¯¯");
}
echo "&lt;table&gt;&lt;tr&gt;";
echo "&lt;th&gt;Companyname&lt;/th&gt;";
echo "&lt;th&gt;Contactname&lt;/th&gt;&lt;/tr&gt;";

while (odbc_fetch_row($rs))
{
    $compname=odbc_result($rs,"CompanyName");
    $conname=odbc_result($rs,"ContactName");
    echo "&lt;tr&gt;&lt;td&gt;$compname&lt;/td&gt;";
    echo "&lt;td&gt;$conname&lt;/td&gt;&lt;/tr&gt;";
}
odbc_close($conn);
echo "&lt;/table&gt;";
?&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h6>åœ¨æ ¹ç›®å½•çš„database.phpä¸­é…ç½®å¯¹åº”çš„æ•°æ®ä¿¡æ¯</h6>

<pre><code>&lt;?php
// +----------------------------------------------------------------------
// | ThinkPHP [ WE CAN DO IT JUST THINK ]
// +----------------------------------------------------------------------
// | Copyright (c) 2006~2016 http://thinkphp.cn All rights reserved.
// +----------------------------------------------------------------------
// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )
// +----------------------------------------------------------------------
// | Author: liu21st &lt;liu21st@gmail.com&gt;
// +----------------------------------------------------------------------

return [
    // æ•°æ®åº“ç±»å‹
    'type'           =&gt; 'mysql',
    // æœåŠ¡å™¨åœ°å€
    'hostname'       =&gt; '127.0.0.1',
    // æ•°æ®åº“å
    'database'       =&gt; 'WWWiCocos',
    // ç”¨æˆ·å
    'username'       =&gt; 'root',
    // å¯†ç 
    'password'       =&gt; '',
    // ç«¯å£
    'hostport'       =&gt; '3306',
    // è¿æ¥dsn
    'dsn'            =&gt; '',
    // æ•°æ®åº“è¿æ¥å‚æ•°
    'params'         =&gt; [],
    // æ•°æ®åº“ç¼–ç é»˜è®¤é‡‡ç”¨utf8
    'charset'        =&gt; 'utf8',
    // æ•°æ®åº“è¡¨å‰ç¼€
    'prefix'         =&gt; '',
    // æ•°æ®åº“è°ƒè¯•æ¨¡å¼
    'debug'          =&gt; true,
    // æ•°æ®åº“éƒ¨ç½²æ–¹å¼:0 é›†ä¸­å¼(å•ä¸€æœåŠ¡å™¨),1 åˆ†å¸ƒå¼(ä¸»ä»æœåŠ¡å™¨)
    'deploy'         =&gt; 0,
    // æ•°æ®åº“è¯»å†™æ˜¯å¦åˆ†ç¦» ä¸»ä»å¼æœ‰æ•ˆ
    'rw_separate'    =&gt; false,
    // è¯»å†™åˆ†ç¦»å ä¸»æœåŠ¡å™¨æ•°é‡
    'master_num'     =&gt; 1,
    // æŒ‡å®šä»æœåŠ¡å™¨åºå·
    'slave_no'       =&gt; '',
    // æ˜¯å¦ä¸¥æ ¼æ£€æŸ¥å­—æ®µæ˜¯å¦å­˜åœ¨
    'fields_strict'  =&gt; true,
    // æ•°æ®é›†è¿”å›ç±»å‹ array æ•°ç»„ collection Collectionå¯¹è±¡
    'resultset_type' =&gt; 'array',
    // æ˜¯å¦è‡ªåŠ¨å†™å…¥æ—¶é—´æˆ³å­—æ®µ
    'auto_timestamp' =&gt; false,
    // æ˜¯å¦éœ€è¦è¿›è¡ŒSQLæ€§èƒ½åˆ†æ
    'sql_explain'    =&gt; false,
];
</code></pre>

<h6>ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨Dbç±»çš„æ—¶å€™åŠ¨æ€å®šä¹‰è¿æ¥ä¿¡æ¯</h6>

<pre><code>Db::connect([
    // æ•°æ®åº“ç±»å‹
    'type'        =&gt; 'mysql',
    // æ•°æ®åº“è¿æ¥DSNé…ç½®
    'dsn'         =&gt; '',
    // æœåŠ¡å™¨åœ°å€
    'hostname'    =&gt; '127.0.0.1',
    // æ•°æ®åº“å
    'database'    =&gt; 'thinkphp',
    // æ•°æ®åº“ç”¨æˆ·å
    'username'    =&gt; 'root',
    // æ•°æ®åº“å¯†ç 
    'password'    =&gt; '',
    // æ•°æ®åº“è¿æ¥ç«¯å£
    'hostport'    =&gt; '',
    // æ•°æ®åº“è¿æ¥å‚æ•°
    'params'      =&gt; [],
    // æ•°æ®åº“ç¼–ç é»˜è®¤é‡‡ç”¨utf8
    'charset'     =&gt; 'utf8',
    // æ•°æ®åº“è¡¨å‰ç¼€
    'prefix'      =&gt; 'think_',
]);
</code></pre>

<h6>æˆ–è€…ä½¿ç”¨å­—ç¬¦ä¸²æ–¹å¼ï¼š</h6>

<pre><code>Db::connect('mysql://root:1234@127.0.0.1:3306/thinkphp#utf8');
</code></pre>

<h4>éªŒè¯è¿æ¥å¹¶æ‰“å°æ•°æ®</h4>

<pre><code>é¦–å…ˆå¿…é¡»æ¸…æ¥šçš„æ˜ç™½ä¹‹å‰åœ¨ThinkPhp3ä¸­çš„å•å­—æ¯å‡½æ•°ï¼ŒThinkPhp5ä¸­å·²ç»å–æ¶ˆäº†ï¼Œæ¯”å¦‚M(),D()ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å¿˜æ‰ä¹‹å‰çš„è¿™ç§é£æ ¼ã€‚
</code></pre>

<p>è¿™é‡Œé…ç½®å¥½äº†æ•°æ®åº“ä¹‹åï¼Œä½¿ç”¨å¯¹åº”çš„å‡½æ•°æ¥éªŒè¯è¿æ¥ï¼Œå¹¶ä¸”æ‰“å°ç›¸å…³ä¿¡æ¯ã€‚</p>

<p>ThinkPhp3çš„æ–¹å¼</p>

<pre><code>    $db = M('tp_user'); 
    print("&lt;pre&gt;"); // æ ¼å¼åŒ–è¾“å‡ºæ•°ç»„
    var_dump($db);
    print("&lt;/pre&gt;");
</code></pre>

<p>ThinkPhp5çš„æ–¹å¼</p>

<pre><code>    print("&lt;pre&gt;"); // æ ¼å¼åŒ–è¾“å‡ºæ•°ç»„
    var_dump(Db::table('tp_user')-&gt;select());
    // Db::name('user')-&gt;select(); // æˆ–è€…
    print("&lt;/pre&gt;");
</code></pre>

<p>è¿™æ ·å°±å¯ä»¥æ‰“å°å‡ºæ•°æ®åº“ç›¸å…³çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p>

<pre><code>array(2) {
  [0]=&gt;
  array(5) {
    ["id"]=&gt;
    int(1)
    ["uname"]=&gt;
    string(2) "56"
    ["upwd"]=&gt;
    string(2) "65"
    ["ip"]=&gt;
    string(3) "645"
    ["last_time"]=&gt;
    int(564)
  }
  [1]=&gt;
  array(5) {
    ["id"]=&gt;
    int(2)
    ["uname"]=&gt;
    string(3) "234"
    ["upwd"]=&gt;
    string(3) "wer"
    ["ip"]=&gt;
    string(3) "221"
    ["last_time"]=&gt;
    int(23)
  }
}
</code></pre>

<h3>åŸºæœ¬ä½¿ç”¨</h3>

<p>é…ç½®äº†æ•°æ®åº“è¿æ¥ä¿¡æ¯åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°æ®åº“è¿è¡ŒåŸç”ŸSQLæ“ä½œäº†ï¼Œæ”¯æŒqueryï¼ˆæŸ¥è¯¢æ“ä½œï¼‰å’Œexecuteï¼ˆå†™å…¥æ“ä½œï¼‰æ–¹æ³•ï¼Œå¹¶ä¸”æ”¯æŒå‚æ•°ç»‘å®šã€‚</p>

<pre><code>Db::query('select * from think_user where id=?',[8]);
Db::execute('insert into think_user (id, name) values (?, ?)',[8,'thinkphp']);
</code></pre>

<p>ä¹Ÿæ”¯æŒå‘½åå ä½ç¬¦ç»‘å®šï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>Db::query('select * from think_user where id=:id',['id'=&gt;8]);
Db::execute('insert into think_user (id, name) values (:id, :name)',['id'=&gt;8,'name'=&gt;'thinkphp']);
</code></pre>

<p>å¯ä»¥ä½¿ç”¨å¤šä¸ªæ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨</p>

<pre><code>Db::connect($config)-&gt;query('select * from think_user where id=:id',['id'=&gt;8]);
</code></pre>

<p>configæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“é…ç½®ï¼Œæ”¯æŒæ•°ç»„å’Œå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°æ®åº“è¿æ¥çš„é…ç½®å‚æ•°åã€‚</p>

<h3>CRUD</h3>

<h6>æŸ¥è¯¢ï¼š åŸºæœ¬æŸ¥è¯¢</h6>

<p>æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ä½¿ç”¨ï¼š</p>

<pre><code>// tableæ–¹æ³•å¿…é¡»æŒ‡å®šå®Œæ•´çš„æ•°æ®è¡¨å
Db::table('think_user')-&gt;where('id',1)-&gt;find();
</code></pre>

<ul>
<li>find æ–¹æ³•æŸ¥è¯¢ç»“æœä¸å­˜åœ¨ï¼Œè¿”å› null</li>
</ul>


<p>æŸ¥è¯¢æ•°æ®é›†ä½¿ç”¨ï¼š</p>

<pre><code>Db::table('think_user')-&gt;where('status',1)-&gt;select();

select æ–¹æ³•æŸ¥è¯¢ç»“æœä¸å­˜åœ¨ï¼Œè¿”å›ç©ºæ•°ç»„
</code></pre>

<p>å¦‚æœè®¾ç½®äº†æ•°æ®è¡¨å‰ç¼€å‚æ•°çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨</p>

<pre><code>Db::name('user')-&gt;where('id',1)-&gt;find();
Db::name('user')-&gt;where('status',1)-&gt;select();
</code></pre>

<h6>å¢åŠ ï¼šæ·»åŠ ä¸€æ¡æ•°æ®</h6>

<p>ä½¿ç”¨ Db ç±»çš„ insert æ–¹æ³•å‘æ•°æ®åº“æäº¤æ•°æ®</p>

<pre><code>$data = ['foo' =&gt; 'bar', 'bar' =&gt; 'foo'];
Db::table('think_user')-&gt;insert($data);
</code></pre>

<p>å¦‚æœä½ åœ¨database.phpé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†æ•°æ®åº“å‰ç¼€(prefix)ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ä½¿ç”¨ Db ç±»çš„ name æ–¹æ³•æäº¤æ•°æ®</p>

<pre><code>Db::name('user')-&gt;insert($data);
</code></pre>

<ul>
<li>insert æ–¹æ³•æ·»åŠ æ•°æ®æˆåŠŸè¿”å›æ·»åŠ æˆåŠŸçš„æ¡æ•°ï¼Œinsert æ­£å¸¸æƒ…å†µè¿”å› 1</li>
</ul>


<p>æ·»åŠ æ•°æ®åå¦‚æœéœ€è¦è¿”å›æ–°å¢æ•°æ®çš„è‡ªå¢ä¸»é”®ï¼Œå¯ä»¥ä½¿ç”¨getLastInsIDæ–¹æ³•ï¼š</p>

<pre><code>Db::name('user')-&gt;insert($data);
$userId = Db::name('user')-&gt;getLastInsID();
</code></pre>

<p>æˆ–è€…ç›´æ¥ä½¿ç”¨insertGetIdæ–¹æ³•æ–°å¢æ•°æ®å¹¶è¿”å›ä¸»é”®å€¼ï¼š</p>

<pre><code>Db::name('user')-&gt;insertGetId($data);
</code></pre>

<ul>
<li>insertGetId æ–¹æ³•æ·»åŠ æ•°æ®æˆåŠŸè¿”å›æ·»åŠ æ•°æ®çš„è‡ªå¢ä¸»é”®</li>
</ul>


<h6>æ›´æ–°ï¼šæ›´æ–°æ•°æ®è¡¨ä¸­çš„æ•°æ®</h6>

<pre><code>Db::table('think_user')
    -&gt;where('id', 1)
    -&gt;update(['name' =&gt; 'thinkphp']);
</code></pre>

<p>å¦‚æœæ•°æ®ä¸­åŒ…å«ä¸»é”®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;update(['name' =&gt; 'thinkphp','id'=&gt;1]);
</code></pre>

<ul>
<li>update æ–¹æ³•è¿”å›å½±å“æ•°æ®çš„æ¡æ•°ï¼Œæ²¡ä¿®æ”¹ä»»ä½•æ•°æ®è¿”å› 0</li>
</ul>


<p>å¦‚æœè¦æ›´æ–°çš„æ•°æ®éœ€è¦ä½¿ç”¨SQLå‡½æ•°æˆ–è€…å…¶å®ƒå­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('id', 1)
    -&gt;update([
        'login_time'  =&gt; ['exp','now()'],
        'login_times' =&gt; ['exp','login_times+1'],
    ]);
</code></pre>

<p>æ›´æ–°æŸä¸ªå­—æ®µçš„å€¼ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('id',1)
    -&gt;setField('name', 'thinkphp');
</code></pre>

<ul>
<li>setField æ–¹æ³•è¿”å›å½±å“æ•°æ®çš„æ¡æ•°ï¼Œæ²¡ä¿®æ”¹ä»»ä½•æ•°æ®å­—æ®µè¿”å› 0</li>
</ul>


<h6>åˆ é™¤ï¼š åˆ é™¤æ•°æ®è¡¨ä¸­çš„æ•°æ®</h6>

<pre><code>// æ ¹æ®ä¸»é”®åˆ é™¤
Db::table('think_user')-&gt;delete(1);
Db::table('think_user')-&gt;delete([1,2,3]);

// æ¡ä»¶åˆ é™¤    
Db::table('think_user')-&gt;where('id',1)-&gt;delete();
Db::table('think_user')-&gt;where('id','&lt;',10)-&gt;delete();
</code></pre>

<ul>
<li>delete æ–¹æ³•è¿”å›å½±å“æ•°æ®çš„æ¡æ•°ï¼Œæ²¡æœ‰åˆ é™¤è¿”å› 0</li>
</ul>


<p>åŠ©æ‰‹å‡½æ•°</p>

<pre><code>// æ ¹æ®ä¸»é”®åˆ é™¤
db('user')-&gt;delete(1);
// æ¡ä»¶åˆ é™¤    
db('user')-&gt;where('id',1)-&gt;delete();
</code></pre>

<h6>æŸ¥è¯¢ï¼šæ¡ä»¶æŸ¥è¯¢æ–¹æ³•</h6>

<ul>
<li>whereæ–¹æ³•</li>
</ul>


<p>å¯ä»¥ä½¿ç”¨whereæ–¹æ³•è¿›è¡ŒANDæ¡ä»¶æŸ¥è¯¢ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('name','like','%thinkphp')
    -&gt;where('status',1)
    -&gt;find();
</code></pre>

<p>å¤šå­—æ®µç›¸åŒæ¡ä»¶çš„ANDæŸ¥è¯¢å¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹æ–¹å¼ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('name&amp;title','like','%thinkphp')
    -&gt;find();
</code></pre>

<ul>
<li>whereOræ–¹æ³•</li>
</ul>


<p>ä½¿ç”¨whereOræ–¹æ³•è¿›è¡ŒORæŸ¥è¯¢ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('name','like','%thinkphp')
    -&gt;whereOr('title','like','%thinkphp')
    -&gt;find();
</code></pre>

<p>å¤šå­—æ®µç›¸åŒæ¡ä»¶çš„ORæŸ¥è¯¢å¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹æ–¹å¼ï¼š</p>

<pre><code>Db::table('think_user')
    -&gt;where('name|title','like','%thinkphp')
    -&gt;find();
</code></pre>

<p>å…¶ä»–é«˜çº§æ“ä½œå‚è€ƒå®˜æ–¹æ‰‹å†Œï¼š<a href="http://www.kancloud.cn/manual/thinkphp5/118058">æ•°æ®åº“æ“ä½œ</a></p>

<h3>æ¨¡å‹ä»‹ç»</h3>

<h4>æ¨¡å‹ç±»å®šä¹‰</h4>

<p>å¦‚æœåœ¨æŸä¸ªæ¨¡å‹ç±»é‡Œé¢å®šä¹‰äº†connectionå±æ€§çš„è¯ï¼Œåˆ™è¯¥æ¨¡å‹æ“ä½œçš„æ—¶å€™ä¼šè‡ªåŠ¨è¿æ¥ç»™å®šçš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„é»˜è®¤è¿æ¥ä¿¡æ¯ï¼Œé€šå¸¸ç”¨äºæŸäº›æ•°æ®è¡¨ä½äºå½“å‰æ•°æ®åº“è¿æ¥ä¹‹å¤–çš„å…¶å®ƒæ•°æ®åº“ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>//åœ¨æ¨¡å‹é‡Œå•ç‹¬è®¾ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯
namespace app\index\model;

use think\Model;

class User extends Model
{
    protected $connection = [
        // æ•°æ®åº“ç±»å‹
        'type'        =&gt; 'mysql',
        // æ•°æ®åº“è¿æ¥DSNé…ç½®
        'dsn'         =&gt; '',
        // æœåŠ¡å™¨åœ°å€
        'hostname'    =&gt; '127.0.0.1',
        // æ•°æ®åº“å
        'database'    =&gt; 'thinkphp',
        // æ•°æ®åº“ç”¨æˆ·å
        'username'    =&gt; 'root',
        // æ•°æ®åº“å¯†ç 
        'password'    =&gt; '',
        // æ•°æ®åº“è¿æ¥ç«¯å£
        'hostport'    =&gt; '',
        // æ•°æ®åº“è¿æ¥å‚æ•°
        'params'      =&gt; [],
        // æ•°æ®åº“ç¼–ç é»˜è®¤é‡‡ç”¨utf8
        'charset'     =&gt; 'utf8',
        // æ•°æ®åº“è¡¨å‰ç¼€
        'prefix'      =&gt; 'think_',
    ];
}
</code></pre>

<p>ä¹Ÿå¯ä»¥é‡‡ç”¨DSNå­—ç¬¦ä¸²æ–¹å¼å®šä¹‰ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>//åœ¨æ¨¡å‹é‡Œå•ç‹¬è®¾ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯
namespace app\index\model;

use think\Model;

class User extends Model
{
    //æˆ–è€…ä½¿ç”¨å­—ç¬¦ä¸²å®šä¹‰
    protected $connection = 'mysql://root:1234@127.0.0.1:3306/thinkphp#utf8';
}
</code></pre>

<p>å’Œè¿æ¥æ•°æ®åº“çš„å‚æ•°ä¸€æ ·ï¼Œconnectionå±æ€§çš„å€¼ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºæ•°æ®åº“çš„é…ç½®å‚æ•°ã€‚</p>

<pre><code>5.0ä¸æ”¯æŒå•ç‹¬è®¾ç½®å½“å‰æ¨¡å‹çš„æ•°æ®è¡¨å‰ç¼€ã€‚
</code></pre>

<h4>æ¨¡å‹è°ƒç”¨</h4>

<p>æ¨¡å‹ç±»å¯ä»¥ä½¿ç”¨é™æ€è°ƒç”¨æˆ–è€…å®ä¾‹åŒ–è°ƒç”¨ä¸¤ç§æ–¹å¼ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>// é™æ€è°ƒç”¨
$user = User::get(1);
$user-&gt;name = 'thinkphp';
$user-&gt;save();

// å®ä¾‹åŒ–æ¨¡å‹
$user = new User;
$user-&gt;name= 'thinkphp';
$user-&gt;save();

// ä½¿ç”¨ Loader ç±»å®ä¾‹åŒ–ï¼ˆå•ä¾‹ï¼‰
$user = Loader::model('User');

// æˆ–è€…ä½¿ç”¨åŠ©æ‰‹å‡½æ•°`model`
$user = model('User');
$user-&gt;name= 'thinkphp';
$user-&gt;save();
</code></pre>

<h4>æ¨¡å‹åˆå§‹åŒ–</h4>

<p>æ¨¡å‹åŒæ ·æ”¯æŒåˆå§‹åŒ–ï¼Œä¸æ§åˆ¶å™¨çš„åˆå§‹åŒ–ä¸åŒçš„æ˜¯ï¼Œæ¨¡å‹çš„åˆå§‹åŒ–æ˜¯é‡å†™Modelçš„initializeï¼Œå…·ä½“å¦‚ä¸‹</p>

<pre><code>namespace app\index\model;

use think\Model;

class Index extends Model
{

    //è‡ªå®šä¹‰åˆå§‹åŒ–
    protected function initialize()
    {
        //éœ€è¦è°ƒç”¨`Model`çš„`initialize`æ–¹æ³•
        parent::initialize();
        //TODO:è‡ªå®šä¹‰çš„åˆå§‹åŒ–
    }
}
</code></pre>

<p>åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨é™æ€initæ–¹æ³•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯initåªåœ¨ç¬¬ä¸€æ¬¡å®ä¾‹åŒ–çš„æ—¶å€™æ‰§è¡Œï¼Œå¹¶ä¸”æ–¹æ³•å†…éœ€è¦æ³¨æ„é™æ€è°ƒç”¨çš„è§„èŒƒï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>

<pre><code>namespace app\index\model;

use think\Model;

class Index extends Model
{

    //è‡ªå®šä¹‰åˆå§‹åŒ–
    protected static function init()
    {
        //TODO:è‡ªå®šä¹‰çš„åˆå§‹åŒ–
    }
}
</code></pre>

<h4>CRUD</h4>

<h6>å¢åŠ </h6>

<ul>
<li>æ·»åŠ ä¸€æ¡æ•°æ®</li>
</ul>


<p>ç¬¬ä¸€ç§æ˜¯å®ä¾‹åŒ–æ¨¡å‹å¯¹è±¡åèµ‹å€¼å¹¶ä¿å­˜ï¼š</p>

<pre><code>$user           = new User;
$user-&gt;name     = 'thinkphp';
$user-&gt;email    = 'thinkphp@qq.com';
$user-&gt;save();
</code></pre>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨dataæ–¹æ³•æ‰¹é‡èµ‹å€¼ï¼š</p>

<pre><code>$user = new User;
$user-&gt;data([
    'name'  =&gt;  'thinkphp',
    'email' =&gt;  'thinkphp@qq.com'
]);
$user-&gt;save();
</code></pre>

<p>æˆ–è€…ç›´æ¥åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ä¼ å…¥æ•°æ®</p>

<pre><code>$user = new User([
    'name'  =&gt;  'thinkphp',
    'email' =&gt;  'thinkphp@qq.com'
]);
$user-&gt;save();
</code></pre>

<p>å¦‚æœéœ€è¦è¿‡æ»¤éæ•°æ®è¡¨å­—æ®µçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code>$user = new User($_POST);
// è¿‡æ»¤postæ•°ç»„ä¸­çš„éæ•°æ®è¡¨å­—æ®µæ•°æ®
$user-&gt;allowField(true)-&gt;save();
</code></pre>

<p>å¦‚æœä½ é€šè¿‡å¤–éƒ¨æäº¤èµ‹å€¼ç»™æ¨¡å‹ï¼Œå¹¶ä¸”å¸Œæœ›æŒ‡å®šæŸäº›å­—æ®µå†™å…¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code>$user = new User($_POST);
// postæ•°ç»„ä¸­åªæœ‰nameå’Œemailå­—æ®µä¼šå†™å…¥
$user-&gt;allowField(['name','email'])-&gt;save();

saveæ–¹æ³•æ–°å¢æ•°æ®è¿”å›çš„æ˜¯å†™å…¥çš„è®°å½•æ•°ã€‚
</code></pre>

<h6>æ›´æ–°</h6>

<ul>
<li>æŸ¥æ‰¾å¹¶æ›´æ–°</li>
</ul>


<p>åœ¨å–å‡ºæ•°æ®åï¼Œæ›´æ”¹å­—æ®µå†…å®¹åæ›´æ–°æ•°æ®ã€‚</p>

<pre><code>$user = User::get(1);
$user-&gt;name     = 'thinkphp';
$user-&gt;email    = 'thinkphp@qq.com';
$user-&gt;save();
</code></pre>

<ul>
<li>ç›´æ¥æ›´æ–°æ•°æ®</li>
</ul>


<p>ä¹Ÿå¯ä»¥ç›´æ¥å¸¦æ›´æ–°æ¡ä»¶æ¥æ›´æ–°æ•°æ®</p>

<pre><code>$user = new User;
// saveæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ›´æ–°æ¡ä»¶
$user-&gt;save([
    'name'  =&gt; 'thinkphp',
    'email' =&gt; 'thinkphp@qq.com'
],['id' =&gt; 1]);
</code></pre>

<p>ä¸Šé¢ä¸¤ç§æ–¹å¼æ›´æ–°æ•°æ®ï¼Œå¦‚æœéœ€è¦è¿‡æ»¤éæ•°æ®è¡¨å­—æ®µçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code>$user = new User();
// è¿‡æ»¤postæ•°ç»„ä¸­çš„éæ•°æ®è¡¨å­—æ®µæ•°æ®
$user-&gt;allowField(true)-&gt;save($_POST,['id' =&gt; 1]);
</code></pre>

<p>å¦‚æœä½ é€šè¿‡å¤–éƒ¨æäº¤èµ‹å€¼ç»™æ¨¡å‹ï¼Œå¹¶ä¸”å¸Œæœ›æŒ‡å®šæŸäº›å­—æ®µå†™å…¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>

<pre><code>$user = new User();ã€‘(['name','email'])-&gt;save($_POST, ['id' =&gt; 1]);
</code></pre>

<h6>åˆ é™¤</h6>

<ul>
<li>åˆ é™¤å½“å‰æ¨¡å‹</li>
</ul>


<p>åˆ é™¤æ¨¡å‹æ•°æ®ï¼Œå¯ä»¥åœ¨å®ä¾‹åŒ–åè°ƒç”¨deleteæ–¹æ³•ã€‚</p>

<pre><code>$user = User::get(1);
$user-&gt;delete();
</code></pre>

<ul>
<li>æ ¹æ®ä¸»é”®åˆ é™¤</li>
</ul>


<p>æˆ–è€…ç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•</p>

<pre><code>User::destroy(1);
// æ”¯æŒæ‰¹é‡åˆ é™¤å¤šä¸ªæ•°æ®
User::destroy('1,2,3');
// æˆ–è€…
User::destroy([1,2,3]);
</code></pre>

<ul>
<li>æ¡ä»¶åˆ é™¤</li>
</ul>


<p>ä½¿ç”¨æ•°ç»„è¿›è¡Œæ¡ä»¶åˆ é™¤ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>// åˆ é™¤çŠ¶æ€ä¸º0çš„æ•°æ®
User::destroy(['status' =&gt; 0]);
</code></pre>

<p>è¿˜æ”¯æŒä½¿ç”¨é—­åŒ…åˆ é™¤ï¼Œä¾‹å¦‚ï¼š</p>

<pre><code>User::destroy(function($query){
    $query-&gt;where('id','&gt;',10);
});
</code></pre>

<p>æˆ–è€…é€šè¿‡æ•°æ®åº“ç±»çš„æŸ¥è¯¢æ¡ä»¶åˆ é™¤</p>

<pre><code>User::where('id','&gt;',10)-&gt;delete();
</code></pre>

<h6>æŸ¥è¯¢</h6>

<ul>
<li>è·å–å•ä¸ªæ•°æ®</li>
</ul>


<p>è·å–å•ä¸ªæ•°æ®çš„æ–¹æ³•åŒ…æ‹¬ï¼š</p>

<p>å–å‡ºä¸»é”®ä¸º1çš„æ•°æ®</p>

<pre><code>$user = User::get(1);
echo $user-&gt;name;

// ä½¿ç”¨æ•°ç»„æŸ¥è¯¢
$user = User::get(['name' =&gt; 'thinkphp']);

// ä½¿ç”¨é—­åŒ…æŸ¥è¯¢
$user = User::get(function($query){
    $query-&gt;where('name', 'thinkphp');
});
echo $user-&gt;name;
</code></pre>

<p>æˆ–è€…åœ¨å®ä¾‹åŒ–æ¨¡å‹åè°ƒç”¨æŸ¥è¯¢æ–¹æ³•</p>

<pre><code>$user = new User();
// æŸ¥è¯¢å•ä¸ªæ•°æ®
$user-&gt;where('name', 'thinkphp')
    -&gt;find();
</code></pre>

<ul>
<li>getæˆ–è€…findæ–¹æ³•è¿”å›çš„æ˜¯å½“å‰æ¨¡å‹çš„å¯¹è±¡å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡å‹çš„æ–¹æ³•ã€‚</li>
</ul>


<p>å…¶ä»–é«˜çº§æ“ä½œå‚è€ƒå®˜æ–¹æ‰‹å†Œï¼š<a href="http://www.kancloud.cn/manual/thinkphp5/135186">æ¨¡å‹æ“ä½œ</a></p>

<h4>MVCæ€æƒ³</h4>

<ol>
<li><p>è¿æ¥å¹¶è·å–æ•°æ®ç›¸å…³æ•°æ®</p>

<pre><code> $result = Db::table('tp_user')-&gt;find();

 //$result = Db::table('tp_user')-&gt;where('upwd', 'wer')-&gt;find();

 //var_dump(Db::select(function ($query)
 //{
 //   $query-&gt;table('tp_user')-&gt;where('id', 2);
 //
 //}));
</code></pre></li>
<li><p>å°†è·å–åˆ°çš„æ•°æ®åº“æ•°æ®èµ‹å€¼ç»™Viewï¼ˆæ³¨æ„è¿™é‡Œä½¿ç”¨assign,thin3ä¸­æ˜¯displayï¼‰</p>

<pre><code> $this-&gt;assign('result',$result);
 return $this-&gt;fetch();
</code></pre></li>
<li><p>åœ¨Viewä¸­æ‹¿åˆ°æ•°æ®æ˜¾ç¤º</p>

<pre><code> &lt;!DOCTYPE html&gt;
 &lt;html&gt;
 &lt;head&gt;
   &lt;meta charset="UTF-8"&gt;
   &lt;title&gt;Insert title here&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
   {$result.id}--{$result.data}
 &lt;/body&gt;
 &lt;/html&gt;
</code></pre></li>
</ol>


<p>ä¸€ä¸ªæœ€ç®€å•çš„MVCæ¨¡å¼å°±å®ç°äº†ï¼Œå…¶å®åé¢å¼€å‘å’Œå®æˆ˜ä¸­åŸºæœ¬ä¸Šå°±æ˜¯è®²è¿™ä¸ªå®ç°æ‰©å¤§ï¼Œç„¶ååšç›¸åº”çš„é€»è¾‘æˆ–è€…ç»†èŠ‚å¤„ç†ã€‚</p>

<h3>æ€»ç»“</h3>

<h4>ThinkPHP5.<em> ä¸ ThinkPHP3.</em> ä¹‹é—´çš„ä½¿ç”¨å·®å¼‚</h4>

<p>å› ä¸ºç ”ç©¶TP5æ—¶é—´ä¸æ˜¯å¾ˆé•¿ï¼Œæš‚æ—¶å…ˆåˆ—ä»¥ä¸‹å‡ å¤„å·®å¼‚ï¼š</p>

<p>1ã€è¿‡å»çš„å•å­—æ¯å‡½æ•°å·²å®Œå…¨è¢«æ›¿æ¢æ‰ï¼Œå¦‚ä¸‹ï¼š</p>

<pre><code>S=&gt;cacheï¼ŒC=&gt;configï¼ŒM/D=&gt;modelï¼ŒU=&gt;urlï¼ŒI=&gt;inputï¼ŒE=&gt;exceptionï¼ŒL=&gt;langï¼ŒA=&gt;controllerï¼ŒR=&gt;action
</code></pre>

<p>2ã€æ¨¡ç‰ˆæ¸²æŸ“ï¼š$this->display() => return view()/return $this->fetch();</p>

<p>3ã€åœ¨modelä¸­è°ƒç”¨è‡ªèº«modelï¼š$this => Db::table($this->table)</p>

<p>4ã€åœ¨æ–°å»ºæ§åˆ¶å™¨ä¸æ¨¡å‹æ—¶çš„å‘½åï¼š</p>

<pre><code>ã€€ã€€â‘ æ§åˆ¶å™¨å»æ‰åç¼€controllerï¼šUserController =&gt; User

ã€€ã€€â‘¡æ¨¡å‹å»æ‰åç¼€modelï¼šUserModel =&gt; User
</code></pre>

<p>5ã€urlè®¿é—®ï¼š</p>

<pre><code>ã€€ã€€å¦‚æœæ§åˆ¶å™¨åä½¿ç”¨é©¼å³°æ³•ï¼Œè®¿é—®æ—¶éœ€è¦å°†å„å­—æ¯ä¹‹é—´ç”¨ä¸‹åˆ’çº¿é“¾æ¥åè¿›è¡Œè®¿é—®ã€‚

ã€€ã€€egï¼šæ§åˆ¶å™¨åä¸ºAddUserï¼Œè®¿é—®æ˜¯ç”¨add_useræ¥è¿›è¡Œè®¿é—®
</code></pre>

<p>6ã€åœ¨TP5ä¸­æ”¯æŒé…ç½®äºŒçº§å‚æ•°ï¼ˆå³äºŒç»´æ•°ç»„ï¼‰ï¼Œé…ç½®æ–‡ä»¶ä¸­ï¼ŒäºŒçº§é…ç½®å‚æ•°è¯»å–ï¼š</p>

<pre><code>ã€€ã€€â‘ Config::get('user.type');

ã€€ã€€â‘¡config('user.type');
</code></pre>

<p>7ã€æ¨¡æ¿ä¸­æ”¯æŒä¸‰å…ƒè¿ç®—ç¬¦çš„è¿ç®—ï¼š{$info.status ? $info.msg : $info.error}è¿˜æ”¯æŒè¿™ç§å†™æ³•ï¼š</p>

<pre><code>{$varname.aa ?? 'xxx'}æˆ–{$varname.aa ?: 'xxx'}
</code></pre>

<p>8ã€TP5å†…ç½®æ ‡ç­¾ï¼š</p>

<pre><code>ã€€ã€€ç³»ç»Ÿå†…ç½®çš„æ ‡ç­¾ä¸­ï¼Œvolistã€switchã€ifã€elseifã€elseã€foreachã€compareï¼ˆåŒ…æ‹¬æ‰€æœ‰çš„æ¯”è¾ƒæ ‡ç­¾ï¼‰ã€ï¼ˆnotï¼‰presentã€ï¼ˆnotï¼‰emptyã€ï¼ˆnotï¼‰definedç­‰
</code></pre>

<p>9ã€TP5æ•°æ®éªŒè¯ï¼š</p>

<pre><code>ã€€ã€€$validate = new Validate(['name' =&gt; 'require|max:25','email' =&gt; 'email']);

ã€€ã€€$data = ['name' =&gt; 'thinkphp','email' =&gt; 'thinkphp@qq.com'];

ã€€ã€€if(!validate-&gt;check($data)){

ã€€ã€€ã€€ã€€debug::dump($validate-&gt;getError());

ã€€ã€€}
</code></pre>

<blockquote><p>æ³¨ï¼šä½¿ç”¨åŠ©æ‰‹å‡½æ•°å®ä¾‹åŒ–éªŒè¯å™¨â€”â€”$validate = validate(&lsquo;User&rsquo;);</p></blockquote>

<p>10ã€TP5å®ç°äº†å†…ç½®åˆ†é¡µï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š</p>

<p>æŸ¥è¯¢çŠ¶æ€ä¸º1çš„ç”¨æˆ·æ•°æ®ï¼Œä¸”æ¯é¡µæ˜¾ç¤º10æ¡æ•°æ®</p>

<pre><code>ã€€ã€€$list = model('User')-&gt;where('status',1)-&gt;paginate(10);

ã€€ã€€ $page = $this-&gt;render();

ã€€ã€€ $this-&gt;assign('_list',$list);

ã€€ã€€ $this-&gt;assign('_page',$page);

ã€€ã€€ return $this-&gt;fetch();
</code></pre>

<p>æ¨¡æ¿æ–‡ä»¶ä¸­åˆ†é¡µè¾“å‡ºä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code>ã€€ã€€&lt;div&gt;{$_page}&lt;/div&gt;
</code></pre>

<hr />

<pre><code>Q Qï¼š2211523682/790806573

å¾®ä¿¡ï¼š18370997821/13148454507

å¾®åšWB:http://weibo.com/u/3288975567?is_hot=1

gitåšæ–‡ï¼šhttp://al1020119.github.io/

githubï¼šhttps://github.com/al1020119
</code></pre>

<p><img src="/images/iCocosCoder.jpg" title="Caption" ></p>

<p><img src="/images/iCocosPublic.jpg" title="Caption" ></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">iCocos</span></span>

      




<time class='entry-date' datetime='2016-12-01T00:30:20+08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>12:30 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/11/18/ios-mian-m-v-v-m/" title="Previous Post: Ios Mian M V V M">&laquo; Ios Mian M V V M</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/12/02/zhong-zheng-linux/" title="Next Post: é‡æ•´Linuxä¸€æ¬¡å°±å¤Ÿäº†">é‡æ•´Linuxä¸€æ¬¡å°±å¤Ÿäº† &raquo;</a>
      
    </p>
  </footer>
</article>



  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread" data-title="å®Œè™ThinkPHP 5.* è¿œä¸æ­¢è¿™äº›ğŸ˜±ğŸ˜‚"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"icocoscao"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
    <h1>æ–‡ç« åˆ†ç±»</h1>
    <ul id="categories">
        <li class='category'><a href='/blog/categories/algorithms/'>algorithms (6)</a></li>
<li class='category'><a href='/blog/categories/and/'>and (11)</a></li>
<li class='category'><a href='/blog/categories/apples/'>apples (2)</a></li>
<li class='category'><a href='/blog/categories/application/'>application (1)</a></li>
<li class='category'><a href='/blog/categories/architecture/'>architecture (2)</a></li>
<li class='category'><a href='/blog/categories/audio/'>audio (5)</a></li>
<li class='category'><a href='/blog/categories/audio-video/'>audio-video (1)</a></li>
<li class='category'><a href='/blog/categories/data/'>data (6)</a></li>
<li class='category'><a href='/blog/categories/developer/'>developer (16)</a></li>
<li class='category'><a href='/blog/categories/foundation/'>foundation (31)</a></li>
<li class='category'><a href='/blog/categories/full/'>full (13)</a></li>
<li class='category'><a href='/blog/categories/low-level/'>low-level (4)</a></li>
<li class='category'><a href='/blog/categories/lve/'>lve (5)</a></li>
<li class='category'><a href='/blog/categories/news/'>news (4)</a></li>
<li class='category'><a href='/blog/categories/others/'>others (1)</a></li>
<li class='category'><a href='/blog/categories/performance/'>performance (12)</a></li>
<li class='category'><a href='/blog/categories/php-lover/'>php-lover (2)</a></li>
<li class='category'><a href='/blog/categories/practical/'>practical (1)</a></li>
<li class='category'><a href='/blog/categories/radio/'>radio (5)</a></li>
<li class='category'><a href='/blog/categories/reverse/'>reverse (7)</a></li>
<li class='category'><a href='/blog/categories/senior/'>senior (31)</a></li>
<li class='category'><a href='/blog/categories/stack/'>stack (13)</a></li>
<li class='category'><a href='/blog/categories/structures/'>structures (6)</a></li>
<li class='category'><a href='/blog/categories/summarize/'>summarize (5)</a></li>
<li class='category'><a href='/blog/categories/tools/'>tools (5)</a></li>
<li class='category'><a href='/blog/categories/video/'>video (5)</a></li>

    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/12/08/bao-chi-chu-cin-ji-xu-qian-jin/">ä¿æŒåˆå¿ƒç»§ç»­å‰è¿›-å¹´ç»ˆç¯‡</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/06/ios-daobao/">è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ ä»£ç </a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/03/phpwan-mei-da-pei-mysql/">PHPå®Œç¾æ­é…ä¹‹Mysqlåˆæ¢</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/02/zhong-zheng-linux/">é‡æ•´Linuxä¸€æ¬¡å°±å¤Ÿäº†</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/01/wan-zhuan-thinkphp-5-dot-star/">å®Œè™ThinkPHP 5.* è¿œä¸æ­¢è¿™äº›ğŸ˜±ğŸ˜‚</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/al1020119">@al1020119</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'al1020119',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





<section>
<h1>åšå®¢<abbr title="The word 'åšå®¢' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'åšå®¢', not for image.">&trade;</abbr></h1>
<a href="http://al1020119.github.io/blog/2016/12/01/wan-zhuan-thinkphp-5-dot-star/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://al1020119.github.io/blog/2016/12/01/wan-zhuan-thinkphp-5-dot-star/" alt="post-qrcode"></a></section>


<section>
<h1>github<abbr title="The word 'github' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'github', not for image.">&trade;</abbr></h1>
<a><img src="/images/iCocosgithub.png" alt="post-qrcode"></a></section>


<section>
<h1>å¾®ä¿¡<abbr title="The word 'å¾®ä¿¡' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'å¾®ä¿¡', not for image.">&trade;</abbr></h1>
<a><img src="/images/iCocosWX.png" alt="post-qrcode"></a></section>


<section>
<h1>å…¬ä¼—å·<abbr title="The word 'å…¬ä¼—å·' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'å…¬ä¼—å·', not for image.">&trade;</abbr></h1>
<a><img src="/images/iCocosMGC.png" alt="post-qrcode"></a><section>
  
  
</section>
<h1>å…¬ä¼—å·<abbr title="The word 'å…¬ä¼—å·' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'å…¬ä¼—å·', not for image.">&trade;</abbr></h1>
<a><img src="/images/iCocos520.png" alt="post-qrcode"></a></section>
<section>
    <h1>è®¿å®¢ç»Ÿè®¡</h1>
    <br/>
    <a href="http://s07.flagcounter.com/more/2SH"><img src="http://s07.flagcounter.com/count/2SH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/" alt="Flag Counter" border="0"></a>
</section><section>
    <h1>æ–°æµªå¾®åš</h1>
    <ul id="weibo">
        <li>
            
            <!-- åœ¨æ­¤æ’å…¥è·å¾—çš„å¾®åšç§€ä»£ç  -->
            <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3288975567&verifier=20ffcedd&dpc=1"></iframe>
            
        </li>
    </ul>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - iCocos -
<span class="credit">welcome to <a href="http://al1020119.github.io">æ›¹#é»</a></span>
</p>

</footer>
  






<!--
-->



</body>
</html>
