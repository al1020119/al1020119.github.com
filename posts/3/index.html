
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>iOS梦工厂</title>
  <meta name="author" content="iCocos">

  
  <meta name="description" content="目录 deb
ipa
pxl iOS安装包的三种格式 deb、ipa 和 pxl的解释和说明 目前 iOS 平台上常见的安装包有三种，deb、ipa 和 pxl。
转自链接：http://fanlb.blogbus.com/logs/80466716.html 多谢作者分享！
其中 deb 格式是 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://al1020119.github.io/posts/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iOS梦工厂" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">iOS梦工厂</a></h1>
  
    <h2>不战胜自己，何以改变未来！</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="al1020119.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/03/02/anzhuangbaogeshi/">安装包格式</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-02T13:32:08+08:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h5>目录</h5>

<ul>
<li>deb</li>
<li>ipa</li>
<li>pxl</li>
</ul>


<h2>iOS安装包的三种格式 deb、ipa 和 pxl的解释和说明</h2>

<p>目前 iOS 平台上常见的安装包有三种，deb、ipa 和 pxl。
转自链接：<a href="http://fanlb.blogbus.com/logs/80466716.html">http://fanlb.blogbus.com/logs/80466716.html</a>  多谢作者分享！
其中 deb 格式是 Debian 系统(包含 Debian 和 Ubuntu )专属安装包格式，配合 APT 软件管理系统，成为了当前在 Linux 下非常流行的一种安装包。进入 2.x 时代之后有 Cydia 作者 Jay Freeman（saurik） 移植到 iPhone 平台上，一起的还有 APT 软件管理系统。</p>

<ul>
<li><p>而 ipa 格式则是苹果在 iOS 平台上推出的专属软件安装包，在2.0固件开始才正式使用，是目前 iPhone/iPod Touch/iPad 平台上唯一的官方安装包。</p></li>
<li><p>而pxl格式则起源于 Mac 系统上的 pkg 安装包，被广泛应用于1.x固件时代，曾经是 iPhone 平台上唯一的软件安装包，现在仍在被91等软件所使用。</p></li>
</ul>


<h3>.deb</h3>

<p>deb 是 Unix 系统(其实主要是 Linux )下的安装包，基于 tar 包，因此本身会记录文件的权限(读/写/可执行)以及所有者/用户组。</p>

<p>由于 Unix 类系统对权限、所有者、组的严格要求，而 deb 格式安装包又经常会涉及到系统比较底层的操作，所以权限等的设置尤其重要。</p>

<p>deb 包本身有三部分组成：</p>

<ul>
<li>数据包，包含实际安装的程序数据，文件名为 data.tar.XXX；</li>
<li>安装信息及控制脚本包，包含 deb 的安装说明，标识，脚本等，文件名为 control.tar.gz；</li>
<li>最后一个是 deb 文件的一些二进制数据，包括文件头等信息，一般看不到，在某些软件中打开可以看到。</li>
</ul>


<p>deb 本身可以使用不同的压缩方式。tar 格式并不是一种压缩格式，而是直接把分散的文件和目录集合在一起，并记录其权限等数据信息。之前提到过的 data.tar.XXX，这里 XXX 就是经过压缩后的后缀名。deb 默认使用的压缩格式为 gzip 格式，所以最常见的就是 data.tar.gz。常有的压缩格式还有 bzip2 和 lzma，其中 lzma 压缩率最高，但压缩需要的 CPU 资源和时间都比较长。</p>

<p>data.tar.gz包含的是实际安装的程序数据，而在安装过程中，该包里的数据会被直接解压到根目录(即 / )，因此在打包之前需要根据文件所在位置设置好相应的文件/目录树。</p>

<p>而 control.tar.gz 则包含了一个 deb 安装的时候所需要的控制信息。一般有 5 个文件：</p>

<ul>
<li>control，用了记录软件标识，版本号，平台，依赖信息等数据；</li>
<li>preinst，在解包 data.tar.gz 前运行的脚本；</li>
<li>postinst，在解包数据后运行的脚本；</li>
<li>prerm，卸载时，在删除文件之前运行的脚本；</li>
<li>postrm，在删除文件之后运行的脚本；
在 Cydia 系统中，Cydia 的作者 Saurik 另外添加了一个脚本，extrainst_，作用与 postinst 类似。</li>
</ul>


<p>关于 deb 的详细介绍和打包说明，请见此贴1楼：<a href="http://bbs.weiphone.com/read-htm-tid-669283.html">http://bbs.weiphone.com/read-htm-tid-669283.html</a></p>

<h3>.ipa</h3>

<p>使用过 Mac OS 的人可能都知道，Mac 下的软件大部分都只有一个 .app 目录，里面包含了程序全部资源和可执行文件。简单来说，Mac 下的软件就像是 Windows 下的绿色软件一样，解压后即可使用，不需要安装，卸载的话也只用删除程序文件即可(这里不涉及 pkg 格式安装包)。而 ipa 格式可以视为这种 .app 软件的衍生物。</p>

<p>ipa 文件实质是一个 zip 压缩包(不是 rar 或 7z 包)，包含 3 个组件：</p>

<ul>
<li>payload 目录下的 .app 目录，这个是软件的主程序；</li>
<li>iTunesArtwork，实质是一个无后缀名的 png 图片，用来在 iTunes 中显示图标；</li>
<li>iTunesMetadata.plist，记录购买者信息、售价等数据。</li>
</ul>


<p>由于 zip 包不能记录权限和所有者等信息，所以苹果规定了 ipa 的安装方式，即全部 ipa 都会解包安装在 /var/mobile/Applications 目录下，全部文件和目录的所有者及用户组均设为 mobile(ID 为 501)，主程序(可执行文件)的权限设为 0755 (所有人都可以执行，但只有所有者可以修改)，可执行文件在 plist 中定义。全部目录权限设为 0755，而其它所有文件都设为 0644(仅所有者可以修改，其余人只允许读取，全部人都不允许执行)。</p>

<p>ipa 解包后并非直接放置于 Applications 目录下，而是放在一串由随机码构成的目录下，其作用在于，只允许这个软件运行在一个特定的沙盒(Sandbox)中，不能干扰其他软件。因此那串随机码目录下，除了 ipa 本身的三个组件之外，还有三个目录：</p>

<ul>
<li>Library，一般是用了储存设置文件等数据；</li>
<li>Documents，存储数据，多用了保存存档；</li>
<li>tmp，临时文件夹。</li>
</ul>


<p>由于这个软件只能在这个特定的目录下运行（当然了，部分程序会调用系统的通讯录、相机等组件，但仍然是受限制的），从而保证了整个系统的安全性和稳定性。</p>

<p>由于 Unix 系统下对权限的规定相当严格，所以“越权”的行为是绝对不允许的。举个例子，mobile 用户无权删除 root 所有的文件，因为 root 的权限高于 mobile。所以有些人在修改 ipa 安装后的文件时，比如进行汉化或者修改存档，发现不能删除干净软件，或不能保存，这是因为删除时不能删除 root 所有的文件，程序本身也无法对 root 所有的存档文件进行写入操作。</p>

<h3>.pxl</h3>

<p>pxl 格式在1.x时代是 iPhone 平台上唯一的安装格式，原因是那时候还没有 Cydia 这样的 APT 管理软件，苹果官方也没有推出 App Store。由于在1.x时代积累了大量人气，在接下来的 App Store 时代中，pxl 格式以其相对简易的打包和安装方式，仍然占据了很大一部分市场。但随着 Installer 的停止开发，iBrickr 等软件停止更新，目前唯一还在坚持使用 pxl 格式的就只剩下91一家了。</p>

<p>pxl 安装包通常包含3个组件：</p>

<ul>
<li>PxlPkg.plist 记录程序文件的存放位置、所有者、权限以及软件标识等信息；</li>
<li>PkgScript文 件夹，存放安装和卸载脚本；</li>
<li>程序文件。</li>
</ul>


<p>PxlPkg.plist 文件的开头通常是 CFBundleIdentifier，记录着软件的唯一标识，以和其他软件进行区分。RDPxlPackageVersion 则记录软件版本。RDPxlPackageFireware 被用来记录可以运行的固件版本。其余还有一些键值是用来记录软件介绍、网址、作者信息等数据。</p>

<p>除了软件标识、软件版本和可用固件版本以外，PxlPkg.plist 的核心部分就是 RDPxlPackageFiles 和 RDPxlPackagePostflight 两项。RDPxlPackageFiles 记录了程序文件应该被复制到的路径，并提供了是否覆盖的参数: overwrite。而 RDPxlPackagePostflight 则记录程序文件应该被赋予的所有者和权限，分别以 chown 和 chmod 命令来实现。另外，对于含有安装/卸载脚本的 pxl 来说，还会以 sh 命令执行相应的脚本 Postflight 和 Preremove。</p>

<p>PkgScript 通常包含两个文件，安装后执行的脚本 Postflight 和卸载前执行的脚本 Preremove，这两个脚本就是标准的 Linux Shell Script，以 sh 命令执行。</p>

<h2>安装包的特点</h2>

<h3>.deb</h3>

<p>丰富的资源：Cydia 上本身就不少，更何况任何格式的安装包都可以转换为 deb。</p>

<p>相对方便的在线购买模式：Cydia Store，不过尽管没有 App Store 的5台设备的限制，但对国内用户来说，付款方式比较困难。</p>

<p>破解难度较大，没有使用 App Store 的验证方式，所以必须将验证和防破解措施加入程序里面，这样就比较难破解，对软件开发者来说是个好事。</p>

<p>完善的 Unix 文件系统支持：无需以命令设置文件的权限、所有者和用户组（当然也可以以脚本来设置）
完善的脚本支持：5个脚本依照安装和卸载的先后顺序执行，可以提供更多选择。比如备份还原操作，可以在 preinst 中备份文件，而在 postrm 中还原文件</p>

<p>严格的依赖关系：deb 遵循严格的依赖关系（于 Depends 和 Pre-Depends 指定），可以确保软件运行所必需的组件。在线安装的时候会自动安装所依赖的软件包。卸载时也很重要，比如软件包 A 依赖于 B，当卸载 B 的时候会提示 A 依赖于 B，卸载掉 B 的话会导致 A 不能用，这样可以确保系统的完整性和稳定性。</p>

<p>Conflicts、Replaces、Provides 等键值的存在可以实现冲突提示或替换其它软件包。
完全权限：由于 deb 必须以最高权限 root 的身份运行，deb可以对系统任何位置进行操作，换句话说，deb
拥有对整个系统的完全控制，因此 deb 安装包软件可以实现很多 ipa 不能实现的功能。</p>

<p>相对简单的获取方式（在线或离线）和安装方式，也不用担心在不同机器上同步会删掉程序的问题。</p>

<p>安装相对简单：其实无论是哪种安装包，安装方法都不算很复杂，只不过 deb 稍微复杂一些。</p>

<p>deb 的安装方法大体有 5 种：</p>

<ol>
<li><p>Cydia 或同类 APT 管理软件在线安装，这个是最佳的安装方式，因为通常无需考虑依赖关系，但缺点是对网络的要求比较高；</p></li>
<li><p>命令行中以 dpkg -i XXX.deb 的形式安装，好处是可以以通配符一次性安装多个 deb，而且也可以直接看到脚本的运行状况和安装成功/失败的提示信息，缺点是需要命令行软件的支持，如 Putty/WinSCP的控制台/iSSH/MobileTerminal，很多人也不熟悉命令行下的操作。另外，安装完后会不显示图标；</p></li>
<li><p>放置于 AutoInstall 目录重启安装。该方法实际是 Cydia 提供的一个启动脚本，在每次系统启动时以 dpkg 命令安装 AutoInstall 目录下的 deb，好处是不需要命令行操作，缺点是必须要重启，有些甚至要重启两次，也会出现不显示图标的情况；</p></li>
<li><p>利用 iFile 安装，好处是图形化操作，桌面会显示图标，缺点是不能一次安装多个 deb；</p></li>
<li><p>用 Cyder II 等软件来安装，其原理是模拟一个 APT 软件管理器来下载相应的 deb 文件并传到设备，然后以前面几种方式来安装。</p></li>
</ol>


<p>总体来说，deb 的安装都是依赖于 dpkg -i 命令来安装，只不过有些是在命令行下输入命令，有些是提供了图形界面。但除了 Cydia 安装一种方式之外，其余几种安装方式都存在一些共有的问题：</p>

<p>不会自行搜索依赖关系，必须手动提供所依赖的 deb；
Cydia 会读取安装脚本里的一些特殊语句，比如仅在全新安装时执行而不在升级时执行，安装完成后重启 SpringBoard 或设备等等。</p>

<p>当然了，deb 软件的卸载也比较简单，有两种方式：</p>

<p>Cydia 里卸载，优点是卸载过程和提示信息很详细，全图形界面操作，同时也提供了重新安装的选项；
以 dpkg -r Package_ID 命令或 dpkg -P Package_ID 命令来卸载（详情后面会说）；
Cydelete 来卸载，优点是可以直接在桌面上卸载有图标的软件，但对那些没有图标的无能为力。</p>

<p>其实，不管是安装还是删除，都可以才要全手动的方法。即，解包 deb 之后，自己将文件放到相应位置，然后设置权限等并执行脚本。但这样有必要么？</p>

<p>deb 的安装过程如下：</p>

<ul>
<li>读取数据库并锁定，避免同时有两个安装程序在运行</li>
<li>读取 control 中的 Package（软件包标识）和版本信息，并搜索数据库，若已存在，则卸载之后再安装；</li>
<li>检查 Depends, Pre-Depends, Conflicts 和 Replaces，如果检测到已存在 Conflicts 中存在的软件，则报错并终止安装。如未找到 Pre-Depends 指定的软件，则报错并终止安装。如找到 Replaces 中指定的软件，则卸载之；</li>
<li>将数据写入 /var/lib/dpkg/status 文件中；</li>
<li>执行 preinst 脚本（如果有）；</li>
<li>解包 data.tar.gz，将文件放置于相应位置，并将文件列表写入 /var/lib/dpkg/info/XXX.list；</li>
<li>运行 postinst 和 extrainst_ 脚本（如果有）；</li>
<li>如果之前的安装都没有出错，即安装成功，那么会在 status 文件中写入 Status: install ok installed 信息，否则会写入其它状态数据，比如 Unpacked （未解包数据）、Failed-config（脚本未能成功执行）、Half-installed（安装失败等）；</li>
<li>重新加载数据库并解除锁定。</li>
</ul>


<p>deb 的卸载过程如下：</p>

<ul>
<li>读取数据库并锁定；</li>
<li>根据软件标识搜寻数据库；</li>
<li>检查是否有软件依赖于待卸载的软件，如果有则提示，并中断卸载；</li>
<li>执行 prerm 脚本（如果有）；</li>
<li>读取 /var/lib/dpkg/info/XXX.list 文件，并删除 list 文件中记录的全部文件和非空文件夹；</li>
<li>运行 postrm 脚本；</li>
<li>如果卸载命令是 dpkg -r，则保留 status 中的记录并改为 Status: Not installed；如果卸载命令是 * dpkg -P，则删除全部数据；</li>
<li>如果卸载过程没有错误的话，重新读取数据库并解除锁定。</li>
</ul>


<p>由于 deb 安装的软件可能会在运行时在 /var/mobile/Documents 下放置存档文件，或在 /var/mobile/Library/Preferences 下放置设置文件，而这些文件并没有记录在 list 文件里，所以卸载的时候不会被删除。</p>

<h3>.ipa</h3>

<ul>
<li>丰富的资源：App Store 上那么多资源，apptrackr 等网站也提供了很多破解版。</li>
<li>完善的更新、后期服务。</li>
<li>只能使用最小权限，保障安全性。</li>
<li>不涉及系统级的操作，所以一般不容易造成死机或白苹果（有些是因为资源消耗太大所以卡死）。</li>
<li>便捷的安装方式，无论是直接在设备上用App Store安装，还是用 iTunes 来同步，抑或是用 Installous 和 91 这类第三方软件来安装，都是很方便快速的安装方式。</li>
<li>超级简单的卸载方式：还有什么比只需要点一个 X 就能卸载更简单呢？</li>
<li>完全删除，不会留下任何垃圾文件（如存档、设置文件等）</li>
<li>总体来说破解还是比较容易的，但现在越来越多软件加入了防破解措施。</li>
</ul>


<p>之前提到过，ipa 软件是被安装在一个类似于沙盒的环境中，除了能对 /var/mobile/Media/DCIM 目录（拍照、截图存放目录）进行操作，或是调用壁纸、铃声、相机等组件，不能对系统进行任何干涉，这样在最大程度上保证了系统的稳定运行，也不会干扰其它软件的正常使用。但问题是，由于 ipa 软件的权限很低，想要对系统进行修改，尤其是应用补丁时，ipa 就无能为力了。</p>

<p>ipa 软件官方的安装方式有两种，一是在 App Store 这个软件中下载安装，二是用 iTunes 同步。</p>

<p>前者的问题主要是网络问题，网速不好很容易安装失败；GPRS之类的上网安装又很耗流量。后者的问题主要是不能在不同系统下使用（包含不同电脑和同一部电脑上的不同系统），在其它系统上同步会抹掉原有的软件。当然了，iTunes 每次同步时间比较长也是经常被人诟病的。尤其是当安装软件比较多的时候，每次同步之前的备份需要很长很长时间，这个很恶心（不过可以直接 X 掉备份操作）。</p>

<p>由于以上两种方式存在一些问题，所以很多人会选择使用 Installous 或 91 来安装 ipa，这也确实是个不错的选择。</p>

<p>Installous 一般没什么问题，但对部分验证比较严格的 ipa 处理不是很好。虽然 Installous 基本能代替 iTunes，但毕竟不完全等同。最典型的就是 Installous 安装 Microsoft 官方出的 Live Messenger （正版，非破解版）时不能运行。实际上 Installous 对很多未破解的正版软件支持不是很好。</p>

<p>至于91，经常被人批评。91 虽然可以安装 ipa，但除了 Installous 都有的正版软件的支持问题外，由于91的安装机制有缺陷，软件不能实现多语言，只会使用英文界面，而忽略掉 zh_CN.lproj，zh_TW.lproj 这些语言包。这对那些用希望使用汉化版的人来说实在是一个悲剧。所以通常是要避免使用91来安装 ipa 的。</p>

<p>至于卸载，三种方法：</p>

<ul>
<li>设备上按住图标直到开始晃动，点击图标左上角的 X 即可卸载；</li>
<li>于 iTunes 中取消选中，然后同步</li>
<li>找到 /var/mobile/Applications 下的相应目录，强行删除整个文件夹。这个在前面两种方法无法使用是可以采用（有时候卸载体积太大的软件，比如超过 1G，因为删除过程太长导致失去响应并删除失败。），但这种方法会造成系统的不稳定。除非是确实碰到了问题，否则强烈建议不要使用。</li>
</ul>


<h3>.pxl</h3>

<p>严格来说，pxl 格式的资源并不算多，但也不少。现在使用 pxl 格式的绝大多数都是91的用户。
从时效性上来说，很多软件（主要是 App Store 上的）一被人破解就马上会被人转成 pxl 格式，这样来说，pxl 格式的更新还是不错的。
由于91手机助手没有 iTunes 同步会抹掉软件的问题，加上其它一些比较方便的功能，使得很多新手都是从91开始了解并熟悉 iPhone/iPod Touch 的使用。其结果是，pxl 格式依赖于91而生存。
pxl 格式的流行也不是历史的遗物，而是符合市场规律的需求。91助手的便捷的软件管理方式（尤其是支持 WiFi 管理），加上免费的旗号，使得 pxl 格式在新手中很受欢迎。</p>

<p>实际上，pxl 格式和 deb 格式具有的功能完全一样。虽然 pxl 不能记录文件的权限等数据，但完全可以用脚本来弥补。即是说，pxl 格式和 deb 格式其实是不相伯仲的。而且因为 pxl 格式的制作并不需要比较少见的 Unix 环境，尤其是 Debian 环境，其本身是优于 deb 格式的。</p>

<p>但为什么现在很多人都经常在说不要使用 pxl 呢？我个人认为，原因主要有以下几个：</p>

<ul>
<li>资源的局限性：除了91公司自己开发的几个软件之外，其余所有软件都是从 deb 和 ipa 转换而来。如果原版软件没破解，pxl 无能为力（比如 Microsoft 官方出的 Live Messenger 和 Cydia 上一众没被破解的软件）；</li>
<li>资源时效性：跟上面一点相似，pxl 格式大部分是从其它格式转换而来，跟原版相比总是会慢一些，尤其是当无法破解时，pxl 根本就出不来；
打包人水平有限：现在很多人都是直接用91助手来打包 pxl。对大部分只有一个 XXX.app 目录的程序来说一般不会有问题，但若遇见那些对文件权限等数据有严格要求的软件（比如可执行文件没有可执行权限，或是 mobile 用户不能改写 root 所有的文件等等），或是需要比较复杂的脚本才能运行的软件，往往 pxl 制作者并没有能力去制作一个完善的 pxl 出来，这样也导致了许多安装使用上的问题；</li>
<li>安全性：绝大部分人在制作 pxl 的时候都习惯用 chmod -R 命令来将整个 XXX.app 目录及其中的全部文件和子目录设为755/775/777权限，而这种行为会造成一定的安全隐患。关于这些数字的意思请自行搜索相关资料。这里简单说明一下。644属性表示仅有该文件的所有人才可以进行改写操作，其余任何人都只能读取，任何人都不能执行这个文件。755和775是在644的基础上加入了可执行权限，755是该文件所在的用户组的所有人都可以改写。而777权限则标识任何人都可以改写并执行。由于 mobile 本身是受限账户，如果使用777权限的话，有机会通过这个漏洞来获取整个系统的控制权。只不过因为 iPhone 系统相对封闭，也不太有机会造成损失。但采用775和777权限是不应该的；
ipa 转 pxl 的存档问题：不少人都有这样的经历，在游戏 A 存档之后再进游戏 B，存档 B 之后再进 A，发现 A 的存档已经不在了。原因在于，ipa 转换成的 pxl 软件，存档全部是放在 /var/mobile/Documents 目录下，而正好有两个软件的存档文件名相同（最常见的就是 data.sav 或 save.data），互相改写之后导致不能读取。这种问题也发生在 ipa 转 deb 上，而且无法解决；
无法完整删除：卸载 pxl 格式时，不会删除存档文件、配置文件、临时文件等数据，长期使用会导致可用空间减少；</li>
<li>在部分机型上存在兼容问题：有些机器越狱后并没有将系统分区中的 /Applications 目录转移到 /var/stash 的用户分区中。由于系统分区的可用空间很少（默认500MB，通常可用空间不超过50MB），强行往 /Applications 里安装会导致剩余空间消耗殆尽或安装失败。</li>
</ul>


<p>由此可以看出，pxl 格式的问题更多不是 pxl 本身的问题，而是打包者的问题以及安装方式的缺陷所致。</p>

<p>另外要指出的是，pxl 最大的提供者，91，经常是转载他人发布的软件（包括 网友自己购买破解的，或 Cydia 上直接下载的）然后当作自己发布的软件，对版权问题完全不在意，这样也引起了很多人，尤其是原发布者的反感。这种赤裸裸的剽窃行为实在是令人不耻。正因为这样，很多人是因为不爽91而不爽 pxl，这实在是冤枉 pxl 格式本身了。</p>

<p>安装和卸载：</p>

<ul>
<li>91手机助手</li>
<li>91百宝箱</li>
</ul>


<p> pxl 转 ipa <a href="http://bbs.weiphone.com/read-htm-tid-569364.html">http://bbs.weiphone.com/read-htm-tid-569364.html</a>
 pxl 转 deb <a href="http://bbs.weiphone.com/read-htm-tid-692225.html">http://bbs.weiphone.com/read-htm-tid-692225.html</a></p>

<p>pxl 格式曾经是1.x时代唯一的安装包格式，给我们留下了太多的回忆，对于 pxl 的贡献，我们还是应该缅怀和尊敬的。但随着时代的发展，pxl 已经老态尽显，就如同 Installer 的退出一样，pxl 最终会退出市场而被供奉在殿堂之内。</p>

<p>总结</p>

<blockquote><p>一般的软件还是尽量用 ipa 格式，不要使用 ipa 转换成的 deb 或 pxl 格式，这样可以确保兼容性和安全性。而在系统级的程序（如 SBSettings 和输入法），ipa 是绝无能力的，那么最好的选择还是 deb。pxl 作为快被淘汰的格式，还是果断的放弃比较好。
至于 ipa 和 deb 的安装方式，ipa 的安装首选 iTunes 同步和 App Store 在线安装，次选 Installous，以保证最佳兼容性。deb 的安装首选 Cydia 在线安装，次选除91外的其它任何安装方式。
任何情况下都不推荐用91来安装 ipa 和 deb，因为91的安装机制并不完善，很容易出问题。</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/29/xitongwenjianjiagou/">系统文件结构</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-29T13:32:08+08:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>29</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>系统文件架构概述</p>

<p>1.IOS是由Mac OS X演化而来，而Mac OS X则是基于UNIX操作系统的，三者有区别，但血脉相连</p>

<ol>
<li>IOS系统主要的文件目录说明：
 /Applications : 存放系统的App和来自Cydia 的App，不包括App Store下载的，越狱过程把/Applications变成了一个符号链接，实际指向/var/stash/Applications
 /Library : 存放系统APP和Cydia App的数据（数据文件、动态链接库等）
 /Library/MobileSubstrate : 存放所有基于MobileSubstrate的插件，MobileSubstrate是一个提供  hook功能的基础平台，运行在这个平台上的插件通称为tweak <br/>
/System/Library/Frameworks
/System/Library/PrivateFrameworks : IOS的共有和私有框架库，路径与模拟器的不同，在使用一些私有函数库时需要指定这样的路径
/System/Library/CoreServices/SpringBoard.app，也就是桌面管理器，越狱开发时刻用到
/System/Library/PreferenceBundles : 各种bundle提供了“设置”中得大多数功能，越狱开发可用
/User 实际指向 /var/mobile ： 存放用户数据（跟用户相关的数据都在此）
/var/mobile/Application :  一般应用程序安装的目录</li>
</ol>


<p>3.越狱/逆向分析方法：
    找到需要实现的功能点，可能是一个app、framework、动态库， 对于app先要哪个Reveal找到界面上的触发点，然后class-dump可执行文件或framework  找到对应的函数  然后结合IDA、Hopper汇编分析</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/26/changyongxitongwenjianjia/">常用系统文件夹</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-26T13:32:08+08:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>iPhone系统常用文件夹位置</p>

<p>1、 【/Applications】 <br/>
常用软件的安装目录</p>

<ol>
<li>【/private /var/ mobile/Media /iphone video Recorder】 <br/>
iphone video Recorder录像文件存放目录</li>
</ol>


<p>3、 【/private /var/ mobile/Media /DCIM】
相机拍摄的照片文件存放目录</p>

<p>4、 【/private/var/ mobile /Media/iTunes_Control/Music】
iTunes上传的多媒体文件（例如MP3、MP4等）存放目录，文件没有被修改，但是文件名字被修改了，直接下载到电脑即可读取。</p>

<p>5、 【/private /var/root/Media/EBooks】
熊猫看书存放目录</p>

<p>6、 【/Library/Ringtones】
系统自带的来电铃声存放目录（用iTunes将文件转换为ACC文件，把后缀名改成.m4r,用iPhone_PC_Suite传到/Library/Ringtones即可）</p>

<p>7、 【/System/Library/Audio/UISounds】
短信记其它系统默认效果铃声（m4r铃声文件改扩展名为.caf）短信铃声文件名为sms-received开头的caf文件</p>

<p>8、 【/private/var/ mobile /Library/AddressBook】
系统电话本的存放目录</p>

<pre><code>   【/private/var/mobile/Library/SMS】 
</code></pre>

<p>短信存放目录</p>

<p>9、 【/private /var/ mobile/Media /iphone Recorder】
iphone Recorder录音软件文件存放目录</p>

<p>10、【/Applications/Preferences.app/zh_CN.lproj】
软件Preferences.app的中文汉化文件存放目录</p>

<p>11、【/Library/Wallpaper】
系统q1ang纸的存放目录</p>

<p>12、【/System/Library/Audio/UISounds】
系统声音文件的存放目录</p>

<p>13、【/private/var/root/Media/PXL】
ibrickr上传安装程序建立的一个数据库，估计和windows的uninstall记录差不多。</p>

<p>14、【/bin】
和linux系统差不多，是系统执行指令的存放目录。</p>

<p>15、【/private/var/ mobile /Library/SMS】
系统短信的存放目录</p>

<p>16、【/private/var/run】
系统进程运行的临时目录？（查看这里可以看到系统启动的所有进程）</p>

<p>17、【/private/var/logs/CrashReporter】
系统错误记录报</p>

<p>特殊图标存放目录介绍：</p>

<p>充电图标：
System/Library/CoreServices/SpringBoard.app/BatteryBG_1.png 一直到 BatteryBG_17.png ，Batteryfill.png<br/>
18个图标为充电图标</p>

<p>手机信号图标：
SystemLibraryCoreServicesSpringBoard.app下Default_0_Bars.png一直到Default_5_Bars.png 和FSO_0_Bars.png&ndash;FSO_5_Bars.png</p>

<p>10个图标为信号图标</p>

<p>Wifi信号图标:
SystemLibraryCoreServicesSpringBoard.appDefault_0_AirPort.png&mdash;Default_3_AirPort.png和FSO_0_AirPort.png&mdash;FSO_3_AirPort.png</p>

<p>8个图标为wifi信号图标</p>

<p>Edge信号图标:
SystemLibraryCoreServicesSpringBoard.app Default_EDGE_ON.png和FSO_EDGE_ON.png</p>

<p>2个图标为Edge信号图标</p>

<p>日期美化图标：
SystemLibraryCoreServicesSpringBoard.app|FSO_LockIcon.png</p>

<p>待机播放器图标：
SystemLibraryCoreServicesSpringBoard.app|nexttrack.png , pause.png , play.png, prevtrack.png</p>

<p>4个图标为待机播放器图标</p>

<p>IPOD播放信号图标：
SystemLibraryCoreServicesSpringBoard.appFSO_Play.png ,Default_Play.png</p>

<p>闹钟信号图标：
SystemLibraryCoreServicesSpringBoard.appDefault_AlarmClock.png ,FSO_AlarmClock.png</p>

<p>震动图标：
SystemLibraryCoreServicesSpringBoard.appsilent.png ,hud.png ,ring.png</p>

<p>滑块图标：</p>

<p>SystemLibraryPrivateFrameworksTelephonyUI.framework 目录下：
Bottombarknobgray.png（待机解锁滑块图标）
bottombarknobgreen.png（待机状态下移动滑动来接听 滑块图标)
Bottombarknobred.png（关机滑块 图标）</p>

<p>待机时间字体：
/System/Library/Fonts/Cache/LockClock.ttf</p>

<p>待机时间背景：
system/library/Frameworks/UIKit.framework/Other.artwork</p>

<p>滑块文字变为闪光字:
SystemLibraryPrivateFrameworksTelephonyUI.framework/bottombarlocktextmask.png</p>

<p>解锁滑条路径:
SystemLibraryPrivateFrameworksTelephonyUI.framework/ opbarbkgnd.png ,bottombarbkgndlock.png</p>

<p>滑块文字路径：
/System/Library/CoreServices/SpringBoard.app/zh_CN.lproj</p>

<p>移动：</p>

<p>改彩色的文件名为：Default_CARRIER_CHINAMOBILE.png
改黑白的文件名为：FSO_CARRIER_CHINAMOBILE.png</p>

<p>联通：</p>

<p>改彩色的文件名为：Default_CARRIER_CHINAUNICOM.png
改黑白的文件名为：FSO_CARRIER_CHINAUNICOM.png</p>

<p>iPhone 特殊文件目录介绍：</p>

<ol>
<li><p>【/private/var/mobile】
新刷完的机器，要在这个文件夹下建一个Documents的目录。</p></li>
<li><p>【/private/var/mobile/Applications】
通过AppStore和iTunes安装的程序都在里面。</p></li>
<li><p>【/private/var/stash】 iPhone4这条不能用
这个文件夹下的Applications目录里面是所有通过Cydia和app安装的程序，Ringtones目录里是所有的手机铃音，自制铃音直接拷在里面即可，Themes目录里是所有Winterboard主题，可以手工修改。</p></li>
<li><p>【/var/mobile/Media/ROMs/GBA】
gpsPhone模拟器存放rom的目录。</p></li>
<li><p>【/var/mobile/Media/textReader】
textReader看书软件读取的电子书的存放路径。</p></li>
<li><p>【/System/Library/Fonts/Cache】
系统字体目录，要替换的字体放在该目录下，权限644不变</p></li>
<li><p>【/private/var/mobile/Media/Maps】
离线地图目录，把地图文件夹放到该目录下，文件夹赋予777权限</p></li>
<li><p>【/private/var/mobile/Library/Downloads】
ipa文件存放目录，用Installous安装</p></li>
<li><p>【/private/var/mobile/Library/Keyboard】
系统拼音字库文件位置</p></li>
<li><p>【/var/stash/Themes.XXXXXX】 iPhone4这条不能用
winterboard主题文件存放路径</p></li>
<li><p>【/private/var/mobile/Media/DCIM/999APPLE】
系统自带截屏文件存放路径</p></li>
</ol>


<p>一.进程优化:</p>

<p>优化内存的操作最好用WinSCP，用91手机助手也可以可以。</p>

<p>这些后台进程的启动程序都存放在</p>

<p>【/System/Library/LaunchDaemon】目录下,就是那些【.plist】文件.要不启动这些进程的最简单的方法就是删除相应的【.plist】文件.
前先一定要备份,以防万一！你可以在你的iPhone或iPod的【/private/var/】下面建一个【backup】目录,然后把要删除的【.plist】文件用iFile直接剪切并存储到【backup】目录下 ，或者直接备份整个【/System/Library/LaunchDaemon】目录！</p>

<p>完全可以安全删除的进程:</p>

<ol>
<li>com.apple.DumpPanic.plist -这是苹果公司用来评估系统崩溃的,完全没必要运行.</li>
<li>com.apple.DumpBasebandCrash.plist -这是苹果公司用来苹果基带崩溃的,也没必要运行.</li>
<li>ReportCrash -有5个带"ReportCrash"的".plist"文件,都是用来收集系统或系统程序崩溃的信息,没什么用处.</li>
<li>com.apple.CrashHouseKeeping.plist -也是和程序崩溃相关的,可以删.</li>
<li>com.apple.powerlog.plist -用来监测第三方不兼容的充电器,可以删.</li>
<li>com.apple.tcpdump.server.plist -似乎是用来转存网络数据的,具体不是很清楚,但删除后不影响设备. <br/>
7.com.apple.chud.chum.plist -这个进程应该和苹果的CHUD工具相关(计算机硬件协议开发/ComputerHardware Understanding Developer).如果你不是一个软件开发者,应该不用启动这个进程.</li>
<li>com.apple.chud.pilotfish.plist -着也是和苹果CHUD工具相关的一个进程.如果你不开发苹果软件,可以删除这个. 要稍微谨慎一点处理的进程-有些用户可以禁用以下几个进程.</li>
</ol>


<p>选择性删除：
1. com.apple.AddressBook.plist -如果不启动这个进程,那么电话中的通讯录的载入速度会稍微变慢一些.若不介意这一点,则可以删除这个进程. <br/>
2. com.apple.accessoryd.plist -不启动这个进程就会禁用一些辅助设备功能,例如: FM收音机, iPhone座充, AV数据线.当然,即便禁用了这个进程,用iPhone座充还是能充电,但也只能有充电的功能啦. <br/>
3. com.apple.dataaccess.dataaccessd.plist -禁用了这个进程,就不能通过Exchange或者Google来同步了. <br/>
4. com.apple.datamigrator.plist -这个进程的作用是把联系人从你的SIM卡传到你的iPhone里. iPod用户就没必要启动它了.尽管我是iPhone,但我也没有启动它,因为我从来不在SIM卡中存联系人. <br/>
5. com.apple.racoon.plist -这是ＶＰＮ需要的进程.若你不用ＶＰＮDaiLi,那就不需要启动了. <br/>
6. com.apple***leInternetSharing.plist -这是网络共享功能. iPod用户完全可以删除. iPhone用户就看你自己是否需要网络共享.其实真没啥作用. <br/>
7. com.apple.aggregated.plist -这个应该和"音频输入"有关.第一代的iPod完全不需要这个进程.第二代iPod可以根据自己的需要来决定. iPhone用户需要这个进程. <br/>
8. com.apple.AOSNotification.plist -这是同步MobileMe用的.不用MobileMe的人完全不需要它. <br/>
9.com.apple.AdminLite.plist-这个进程的作用是:当某个程序启动或反应时间过长,则iPhone或iPod会自动终止这个程序(即:让程序崩溃),从而把控制权转交到你手中.如果你不愿意经常看到程序崩溃,那么你可以关闭这个进程,但结果是,当遇到某个程序启动或反应过慢时,你得多等一会儿.一般情况下不建议关闭这个进程. <br/>
10. com.saurik.Cydia.Startup.plist -安装Cydia后产生的进程,应该是用来执行自动安装deb软件的.其实完全可以禁用它,我更喜欢用MobileTerminal来安装deb软件.</p>

<p>二.服务优化:<br/>
4.01通讯录解决排序混乱的方法（包括英文名）
设置——通用——多语言环境——语言 改成ENGLISH， 然后区域格式 中国，然后，再把 多语言环境 语言改成 中文。
XX或多装了一些应用程序后，都存在反应慢、很卡或者无故退出等问题。这都是因为运行内存不足造成的，下面的教程可以解决这个问题。</p>

<p>步骤:</p>

<p>(1)首先我们需要安装BossPrefs，请从Cydia上下载最新版本。
(2)需要下载一些服务开关插件
(3)安装Bossprefs。
(4)将Svrs Svrs</p>

<p>7个文件上传到/private/var/stash/Applications.xxxxxx/BossPrefs.app/services/文件夹中。(用户:root 权限:777)</p>

<p>(注意:是将Svrs内的7个文件上传,而不是将Svrs文件夹上传!)</p>

<p>(5)运行BossPrefs，可以看到你手机的所有服务。大家可以按需要随时启动或关闭上述服务，无需重启iPhone，效果等同于Windows的服务管理器——当你在BossPrefs关闭上述任一服务时，会立即从内存中关闭该项服务，并把占用的内存释放出来。当选择打开该服务时，则会立即启动该项服务。</p>

<p>(6)部分服务解释以及建议：</p>

<p>大部分的服务大家应该都看的明白，我说一下比较重点的服务</p>

<p>FairPlaydSvr：FairPlayd服务，占用17M内存；（注意：这个不能关闭，否则有些程序运行不了！）
SysLogdSvr：iPhone日志服务，占用13M内存；（可以关闭！）
UpdateSvr：iPhone更新服务，占用12M内存；（可以关闭！）
Wiki2touchSvr：wiki服务，占用20M内存。（可以关闭！）</p>

<p>上述服务，平时都可关掉，当要用服务时，只需到BossPrefs中启动相应服务即可，无需重启手机。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/02/25/fangfayugongju/">iOS逆向工程前奏篇－方法与工具介绍</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-02-25T13:32:08+08:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>之前接触过iOS逆向开发，后来工作中没这方面需求，也就没再看了。最近一段时间由于各种原因又需要逆向某些App来用于学习，所以又重新拾起来。</p>

<p>这里总结一下几种iOS逆向的方法和工具：</p>

<h4>iOS逆向-静态分析</h4>

<p>涉及到的工具有</p>

<ul>
<li> OpenSSH (用于远程登录ssh和文件传输scp)</li>
<li> class-dump(用于简单分析出工程中的类名和函数名)</li>
<li> Hopper Disassembler(反编译工具)</li>
<li> Reveal (对越狱后的设备查看任意app的布局)</li>
</ul>


<p>iOS逆向-动态分析</p>

<p>涉及到的工具有
    cycript (cycript是一个脚本语言，可以看做Objective-JavaScript，形容 的非常贴切。配合静态调试，可以调用运行中的app内的任意方法)</p>

<p>iOS逆向-内部钩子</p>

<p>主要是编写iOS动态库，加载到越狱手机中，使用iOS的 Method Swizzling(方法调配)来获 得(截断/改变)底层调用的方法。这样我们可以自由的修改或者读取一些想要的东西。</p>

<p>iOS逆向相关:theos和iOSOpenDev搭建越狱开发环境，创建iOS动态链接库(Dylib文件)编写(hook)及测试；</p>

<p>iOS逆向思路进展:使用InspectiveC来查看调用堆栈：</p>

<p>跟踪一个程序，看看这个程序的执行流程是什么样的，以及某个函数的调用参数是什么。</p>

<p>常规的方法是在汇编中寻找objc_msgSend，一层一层跟下去。这是比较笨的办法，而且不能动态查看函数的数。</p>

<p>通过InspectiveC,我们可以动态的查看：</p>

<ul>
<li>某个类的所有方法调用情况</li>
<li>某个类的某个方法的调用情况</li>
<li>某个类的实例对象的所有方法的调用情况</li>
<li>某个类的实例对象的某个方法的调用情况</li>
<li>某个方法签名的调用情况</li>
</ul>


<p>跟踪一个程序，看看这个程序的执行流程是什么样的，以及某个函数的调用参数是什么。</p>

<p>常规的方法是在汇编中寻找objc_msgSend，一层一层跟下去。这是比较笨的办法，而且不能动态查看函数的数。</p>

<p>通过InspectiveC,我们可以动态的查看：
* 某个类的所有方法调用情况
* 某个类的某个方法的调用情况
* 某个类的实例对象的所有方法的调用情况
* 某个类的实例对象的某个方法的调用情况
* 某个方法签名的调用情况</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/24/iCocos/">温馨提示</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-24T13:32:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>引言：</p>

<ul>
<li>由于过年和公司的原因，近期不会有新的文章推出。</li>
</ul>


<p>而且笔者最近也研究《ios逆向工程第二版》</p>

<p><img src="/images/psbnixiangbook.jpg" title="Caption" ></p>

<h6>所以后期会推出一系列ios逆向相关技术，会根据自己的学习与研究结合《沙梓社/吴航/刘瑾》，念茜等大牛的大作，整理一套相关文章，敬请期待！</h6>

<ul>
<li><p>文章的大致目录如下（可能会有变动，但是不会很大，结合上面的书进行整理）：</p>

<ul>
<li><p>1.逆向工程前奏篇－方法与工具介绍</p></li>
<li><p>2.逆向工程前奏篇－安装包格式总结</p></li>
<li><p>3.逆向工程准备篇－逆向技术分析</p></li>
<li><p>4.逆向工程准备篇－常见越狱方法</p></li>
<li><p>5.逆向工程准备篇－环境简单介绍</p></li>
<li><p>6.逆向工程实战篇－检测是否越狱</p></li>
<li><p>7.逆向工程作用篇－反编译和防反编译</p></li>
<li><p>8.逆向工程初步篇－静态分析及使用</p></li>
<li><p>9.逆向工程应用篇－资源文件获取</p></li>
<li><p>10.逆向工程应用篇－简单App实战</p></li>
<li><p>11.逆向工程总结篇－使用Tweak工程</p></li>
<li><p>13.逆向工程实战篇－私有API</p></li>
<li><p>14.逆向工程实战篇－游戏反编译</p></li>
<li><p>15.逆向工程实战篇－非6S实现3DTouch</p></li>
<li><p>16.逆向工程总结篇－逆向支付宝</p></li>
<li><p>17.逆向工程总结篇－驱动开发</p></li>
<li><p>18.逆向工程总结篇－微信机器人</p></li>
<li><p>19.逆向工程总结篇－iOS逆向总结</p></li>
</ul>
</li>
</ul>


<p>最后，听说最近到处都开始下雪了，我的老家（江西-修水），也是白茫茫的一篇，就连广州也带来的百年以来的的第一场雪，广东都能下雪，你觉得还有什么不可能发生呢？</p>

<p>我相信只要你有耐心，有梦想，成功只是时间的问题！</p>

<p>希望各位都注意保暖，多多关爱家人，身体是革命的本钱（这句话，程序🐶最懂了）。</p>

<p>如果你喜欢我的文章，或者有任何问题可以直接联系我<a href="http://al1020119.github.io/icocos/">iCocos</a></p>

<p>相关技术请参照：</p>

<ul>
<li><p><a href="http://www.kanxue.com/">http://www.kanxue.com/</a></p></li>
<li><p><a href="http://iosre.com/">http://iosre.com/</a></p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/22/cookie-session/">Cookie是撒(&session）</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-22T13:32:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>1:32 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>引言：</p>

<ol>
<li><p>简单说不管是NSURLConnection还是UIWebView都会保留并传递服务端的cookie，重启进程，或重启系统cookie都在应用中。</p></li>
<li><p>多个应用间默认是不共亨cookie的</p></li>
<li><p>删除重装应用cookie会被清除</p></li>
</ol>


<h4>一. Cookie介绍</h4>

<p>Cookie是在客户端存储服务器状态的一种机制,Web服务器可以通过Set-Cookie或者Set-Cookie2 HTTP头部设置Cookie。</p>

<p>Cookie可以分为两类</p>

<ul>
<li>会话Cookie</li>
<li>持久Cookie</li>
</ul>


<p>会话Cookie是临时Cookie,当前会话结束(浏览器退出)时Cookie会被删除。</p>

<p>持久Cookie会存储在用户的硬盘上,浏览器退出，然后重新启动后Cookie仍然存在。会话Cookie和持久Cookie的区别在于过期时间，如果设置了Discard参数(Cookie 版本1)或者没有设置Expires(Cookie版本0)或Max-Age(Cookie版本1)设置过期时间，则此Cookie为会话Cookie</p>

<p>Cookie有两个版本,一个是版本0(Netscape Cookies)和版本1(RFC 2965),目前大多数服务器使用的Cookie 0。</p>

<h4>二. NSHTTPCookie</h4>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/22/cookie-session/">阅读全文😘</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/21/keyChain/">Keychain介绍与使用</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-21T10:05:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>10:05 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>介绍</h3>

<p>引言：</p>

<blockquote><p>Mac OS可以利用KeyChain保存各应用中用户的账号密码，让用户不用重复输入。其实在iOS中也有KeyChain，也可以用KeyChain在应用间共享数据，只是有一些限制，无法像Mac OS一样开放，也无法让用户手动控制。那么KeyChain到底如何使用呢？</p></blockquote>

<p>我们可以把KeyChain理解为一个Dictionary，所有数据都以key-value的形式存储，可以对这个Dictionary进行add、update、get、delete这四个操作。对于每一个应用来说，KeyChain都有两个访问区，私有区和公共区。私有区是一个sandbox，本程序存储的任何数据都对其他程序不可见。而要想在将存储的内容放在公共区，需要先声明公共区的名称，官方文档管这个名称叫“keychain access group”</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/21/keyChain/">阅读全文😘</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/18/disanfangzhifu/">第三方支付总结</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-18T11:35:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:35 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>引言：
随着移动互联的发展，支付功能越来越流行，这也使得各大app公司不得不集成相关支付功能，文本就就此谈谈支付相关。</p>

<p>本文源码源码（封装）<a href="https://github.com/al1020119/iCocosPay">iCocosPay</a>（内集常见支付方案：成支付宝，微信，银联）</p>

<p>目录</p>

<ul>
<li>常见支付方案</li>
<li>第三方支付SDK</li>
<li>苹果官方支付方案</li>
<li>web支付方案</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/18/disanfangzhifu/">阅读全文😘</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/15/tupianyibuhuancun/">图片处理-异步缓存优化</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-15T02:35:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>2:35 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
<li>引言</li>
</ol>


<p>过去的几年里，iOS 应用在视觉方面越来越吸引人。图像展示是其中很关键的部分，因为大部分图像展示都需要下载并且渲染。大部分开发者都要使用图像填充表格视图（table views）或者集合视图（collection views）。下载图片消耗一些资源（如蜂窝数据、电池以及 CPU 等）。为了减少资源消耗，一些缓存模型也应运而生。</p>

<p>为了获得良好的用户体验，当我们缓存和加载图像时，了解 iOS 底层如何处理是很重要的。此外，大多数使用了图片缓存的开源库也是个不错解决方案。</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/15/tupianyibuhuancun/">阅读全文😘</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/15/tupianchuliyouhuajiqiao/">图片优化-总结</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-15T01:21:08+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:21 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>主要针对问题</p>

<ul>
<li><p>图片文件比较大</p></li>
<li><p>图片文件比较多</p></li>
</ul>


<h4>网络图片显示大体步骤:</h4>

<ul>
<li>下载图片</li>
<li>图片处理（裁剪，边框等)</li>
<li>写入磁盘</li>
<li>从磁盘读取数据到内核缓冲区</li>
<li>从内核缓冲区复制到用户空间(内存级别拷贝)</li>
<li>解压缩为位图（耗cpu较高）</li>
<li>如果位图数据不是字节对齐的，CoreAnimation会copy一份位图数据并进行字节对齐</li>
<li>CoreAnimation渲染解压缩过的位图</li>
<li>以上4，5，6，7，8步是在UIImageView的setImage时进行的，所以默认在主线程进行(iOS UI操作必须在主线程执行)。</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/15/tupianchuliyouhuajiqiao/">阅读全文😘</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/4">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/2">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
    <h1>文章分类</h1>
    <ul id="categories">
        <li class='category'><a href='/blog/categories/advanced/'>advanced (22)</a></li>
<li class='category'><a href='/blog/categories/algorithm/'>algorithm (1)</a></li>
<li class='category'><a href='/blog/categories/background/'>background (1)</a></li>
<li class='category'><a href='/blog/categories/bottom/'>bottom (5)</a></li>
<li class='category'><a href='/blog/categories/developer/'>developer (7)</a></li>
<li class='category'><a href='/blog/categories/fore-end/'>fore-end (2)</a></li>
<li class='category'><a href='/blog/categories/interview/'>interview (1)</a></li>
<li class='category'><a href='/blog/categories/necessary/'>necessary (5)</a></li>
<li class='category'><a href='/blog/categories/newfeatures/'>newfeatures (5)</a></li>
<li class='category'><a href='/blog/categories/performance/'>performance (8)</a></li>
<li class='category'><a href='/blog/categories/projects/'>projects (27)</a></li>
<li class='category'><a href='/blog/categories/summary/'>summary (40)</a></li>
<li class='category'><a href='/blog/categories/tools/'>tools (5)</a></li>
<li class='category'><a href='/blog/categories/watchos2/'>watchos2 (1)</a></li>

    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/04/25/nixiangzongjie/">Nixiangzongjie</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/20/weixinjiqiren/">微信机器人</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/15/qudongkaifa/">驱动开发</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/10/nixiangzhifubao/">逆向支付宝</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/05/fei6sshixian3dtouch/">非6S-实现3D Touch</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/al1020119">@al1020119</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'al1020119',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
<h1>扫一扫<abbr title="The word '扫一扫' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word '扫一扫', not for image.">&trade;</abbr></h1>
<a href="http://al1020119.github.io/posts/3/index.html"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://al1020119.github.io/posts/3/index.html" alt="post-qrcode"></a></section>
<section>
    <h1>访客统计</h1>
    <br/>
    <a href="http://s07.flagcounter.com/more/2SH"><img src="http://s07.flagcounter.com/count/2SH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/" alt="Flag Counter" border="0"></a>
</section><section>
    <h1>新浪微博</h1>
    <ul id="weibo">
        <li>
            
            <!-- 在此插入获得的微博秀代码 -->
            <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3288975567&verifier=20ffcedd&dpc=1"></iframe>
            
        </li>
    </ul>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - iCocos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
