
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>iOSæ¢¦å·¥å‚</title>
  <meta name="author" content="iCocos">

  
  <meta name="description" content="ä»‹ç» realmæ˜¯ä¸€ä¸ªè·¨å¹³å°ç§»åŠ¨æ•°æ®åº“å¼•æ“ï¼Œæ”¯æŒiOSã€OS Xï¼ˆObjective-Cå’ŒSwiftï¼‰ä»¥åŠAndroidã€‚ 2014å¹´7æœˆå‘å¸ƒã€‚ç”±YCombinatorå­µåŒ–çš„åˆ›ä¸šå›¢é˜Ÿå†æ—¶å‡ å¹´æ‰“é€ ï¼Œæ˜¯ç¬¬ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ç§»åŠ¨å¹³å°è®¾è®¡çš„æ•°æ®åº“ã€‚ç›®æ ‡æ˜¯å–ä»£SQLiteã€‚ ä¸ºäº†å½»åº•è§£å†³æ€§èƒ½é—®é¢˜ï¼Œæ ¸å¿ƒæ•°æ®å¼•æ“C &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://al1020119.github.io/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="iOSæ¢¦å·¥å‚" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//libs.baidu.com/jquery/1.7.2/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->

<!--<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">iOSæ¢¦å·¥å‚</a></h1>
  
    <h2>iCocosâ€”â€”ä¸æˆ˜èƒœè‡ªå·±ï¼Œä½•ä»¥æ”¹å˜æœªæ¥ï¼</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="al1020119.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">åšæ–‡</a></li>
  <li><a href="/blog/archives">å½’æ¡£</a></li>
  <li><a href="/icocos">iCocos</a></li>
  <li><a href="/about">æ–‡ç« </a></li>
  <li><a href="/other">å…¶ä»–</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/03/realmjichupian/">RealmåŸºç¡€ç¯‡</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-03T02:59:42+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>2:59 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ä»‹ç»</p>

<p>realmæ˜¯ä¸€ä¸ªè·¨å¹³å°ç§»åŠ¨æ•°æ®åº“å¼•æ“ï¼Œæ”¯æŒiOSã€OS Xï¼ˆObjective-Cå’ŒSwiftï¼‰ä»¥åŠAndroidã€‚</p>

<p>2014å¹´7æœˆå‘å¸ƒã€‚ç”±YCombinatorå­µåŒ–çš„åˆ›ä¸šå›¢é˜Ÿå†æ—¶å‡ å¹´æ‰“é€ ï¼Œæ˜¯ç¬¬ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ç§»åŠ¨å¹³å°è®¾è®¡çš„æ•°æ®åº“ã€‚ç›®æ ‡æ˜¯å–ä»£SQLiteã€‚</p>

<p>ä¸ºäº†å½»åº•è§£å†³æ€§èƒ½é—®é¢˜ï¼Œæ ¸å¿ƒæ•°æ®å¼•æ“C++æ‰“é€ ï¼Œå¹¶ä¸æ˜¯å»ºç«‹åœ¨SQLiteä¹‹ä¸Šçš„ORMã€‚å¦‚æœå¯¹æ•°æ®å¼•æ“å®ç°æƒ³æ·±å…¥äº†è§£å¯ä»¥æŸ¥çœ‹ï¼šRealm æ ¸å¿ƒæ•°æ®åº“å¼•æ“æ¢ç§˜ã€‚å› æ­¤å¾—åˆ°çš„æ”¶ç›Šå°±æ˜¯æ¯”æ™®é€šçš„ORMè¦å¿«å¾ˆå¤šï¼Œç”šè‡³æ¯”å•ç‹¬æ— å°è£…çš„SQLiteè¿˜è¦å¿«ã€‚</p>

<p>å› ä¸ºæ˜¯ORMï¼Œæœ¬èº«åœ¨è®¾è®¡æ—¶ä¹Ÿé’ˆå¯¹ç§»åŠ¨è®¾å¤‡ï¼ˆiOSã€Androidï¼‰ï¼Œæ‰€ä»¥éå¸¸ç®€å•æ˜“ç”¨ï¼Œå­¦ä¹ æˆæœ¬å¾ˆä½ã€‚</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/03/realmjichupian/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/02/fmdbzfenghuznag/">FMDBå°è£…ç¯‡</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-02T22:59:42+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>10:59 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>å‰è¨€ï¼š</p>

<p>åœ¨è‡ªå·±å¼€å‘ä¸­ï¼Œæ¯æ¬¡ç”¨åˆ°æ•°æ®åº“éƒ½ä¼šçº ç»“æ˜¯ä½¿ç”¨CoreDataè¿˜æ˜¯FMDBã€‚CoreDataè™½ç„¶Apiç®€å•ï¼Œä½†æ˜¯è°ƒç”¨æ ˆéå¸¸å¤æ‚ï¼Œè¦åˆå§‹åŒ–ä¸€ä¸ªContextéœ€è¦è‡³å°‘20è¡Œä»£ç ã€‚ã€‚ã€‚</p>

<p>æ˜¾ç„¶ï¼Œå¯¹äºè¿™ç§è¿™ä¹ˆæ¶å¿ƒçš„æƒ…å†µï¼Œæˆ‘ä»¬çš„å¤§Githubå¿…é¡»æœ‰äººä¼šè·³å‡ºæ¥è§£å†³è¿™ç§é—®é¢˜ã€‚äºæ˜¯å°±å‡ºç°äº†MagicRecordè¿™ä¸ªå¯¹CoreDataçš„å°è£…åº“ã€‚ä¸€å¼€å§‹é‡åˆ°è¿™ä¸ªåº“çš„æ—¶å€™ï¼Œå¥½ç”¨åˆ°å‡ ä¹è®©æˆ‘æƒ³æŠŠæ‰€æœ‰é¡¹ç›®çš„æ•°æ®åº“éƒ½æ¢æˆCoreDataäº†ã€‚ä¸¤å¥è¯è§£å†³CoreDataè°ƒç”¨æ ˆçš„åˆå§‹åŒ–ï¼Œä¸€å¥è¯å®Œæˆæ•°æ®åº“ç‰ˆæœ¬å‡çº§å’Œè‡ªåŠ¨æ•°æ®åˆå¹¶æ›´æ–°ï¼ˆè™½ç„¶æˆ‘ä»¬å¾ˆå°‘ç”¨åˆ°ï¼‰ã€‚</p>

<p>ç„¶è€Œè¿™å¹¶ä¸èƒ½è§£å†³ä¸€ä¸ªæ ¹æœ¬æ€§çš„é—®é¢˜ï¼ŒCoreDataä¸­çš„æ¯ä¸ªObjectéƒ½è¦å’Œä¸€ä¸ªcontextè¿›è¡Œç»‘å®šï¼Œå¯¼è‡´æˆ‘ä»¬å¾ˆå¤šä¸šåŠ¡éœ€æ±‚éœ€è¦åˆ›å»ºè‡ªå·±çš„ç§æœ‰contextï¼Œç„¶åå†éœ€è¦æ›´æ–°çš„æ—¶å€™ä¿å­˜åˆ°ä¸»contextä¸­ã€‚è¿™åˆå¯¼è‡´äº†æˆ‘ä»¬åœ¨controllerä¸­æˆ–è€…åœ¨è‡ªå·±çš„ä¸šåŠ¡ç±»ä¸­ç»´æŠ¤å¤šä¸€ä¸ªç§æœ‰contextå±æ€§ã€‚</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/02/fmdbzfenghuznag/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/02/fmdbjinghua/">FMDBç²¾åç¯‡</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-02T12:59:42+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>12:59 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>ç”±äºFMDBæ˜¯å»ºç«‹åœ¨SQLiteçš„ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥ä½ è‡³å°‘ä¹Ÿè¯¥æŠŠè¿™ç¯‡æ–‡ç« ä»å¤´åˆ°å°¾è¯»ä¸€éã€‚ä¸æ­¤åŒæ—¶ï¼ŒæŠŠSQLiteçš„æ–‡æ¡£é¡µ åŠ åˆ°ä½ çš„ä¹¦ç­¾ä¸­ã€‚è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆAPCï¼‰è¿˜æ˜¯æ‰‹åŠ¨å†…å­˜ç®¡ç†å‘¢ï¼Ÿ</p>

<p>ä¸¤ç§éƒ½è¡Œï¼ŒFMDBä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™çŸ¥é“ä½ æ˜¯ç”¨çš„å“ªä¸€ç§ï¼Œç„¶åè¿›è¡Œç›¸åº”å¤„ç†ã€‚</p>

<h5>ä½¿ç”¨æ–¹æ³•</h5>

<p>FMDBæœ‰ä¸‰ä¸ªä¸»è¦çš„ç±»</p>

<pre><code>1.FMDatabase â€“ è¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„SQLiteæ•°æ®åº“ã€‚ ç”¨æ¥æ‰§è¡ŒSQLiteçš„å‘½ä»¤ã€‚
2.FMResultSet â€“ è¡¨ç¤ºFMDatabaseæ‰§è¡ŒæŸ¥è¯¢åç»“æœé›†
3.FMDatabaseQueue â€“ å¦‚æœä½ æƒ³åœ¨å¤šçº¿ç¨‹ä¸­æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢æˆ–æ›´æ–°ï¼Œä½ åº”è¯¥ä½¿ç”¨è¯¥ç±»ã€‚è¿™æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚
</code></pre>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/02/fmdbjinghua/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/01/weixinhongbao/">ç¦åˆ©ï¼šæŠ¢çº¢åŒ…ç¥å™¨å°±æ˜¯è¿™ä¹ˆæ¥çš„</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-01T21:52:15+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>9:52 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>å¾®ä¿¡çº¢åŒ…</p>

<p><img src="/images/weixinhongbao0001.jpg" title="Caption" ></p>

<p>åˆ«å‘Šè¯‰æˆ‘ä½ å¯¹çº¢åŒ…ä¸æ„Ÿå…´è¶£ï¼Œå¦‚æœçœŸçš„æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆè¯·ç»•é“ï¼Œå“ˆå“ˆã€‚</p>

<p>ç°åœ¨ç”±äºå¾®ä¿¡å’ŒQQçš„æ™®åŠï¼Œå‡ ä¹æ‰€æœ‰ç”¨æˆ·éƒ½ä¼šä½¿ç”¨çº¢åŒ…è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªç¨‹åºå‘˜æ¥è¯´ï¼Œæ¯çœ‹åˆ°ä¸€ä¸ªå¥½çš„åŠŸèƒ½éƒ½ä¼šåŠªåŠ›è¯•ç€ç ”ç©¶ä¸€ä¸‹ï¼Œå“ªæ€•ä¸èƒ½æˆåŠŸï¼Œç”±äºçœ‹åˆ°äº†ä¸€ç¯‡æ¯”è¾ƒçœ‹çš„æ–‡ç« ï¼Œæ‰€ä»¥å°±ä¸“é—¨èŠ±æ—¶é—´å»æä¸€é¡¿ï¼Œç»“æœå¤§åƒä¸€æƒŠã€‚</p>

<p>æœ€è¿‘æœ‰ä¸å°‘æœ‹å‹æ‰¾æˆ‘è¦çº¢åŒ…å°¾æ•°çš„åŠŸèƒ½ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä»–ä»¬ä¸ºä»€ä¹ˆè¦è¿™ä¸ªï¼Œå¯èƒ½æ˜¯ç¬”è€…å¤ªå¹´è½»äº†ã€‚ä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ªå¯èƒ½ä¸ç®€å•ï¼Œè€Œä¸”è¿™æ ·çš„åŠŸèƒ½åšå¥½äº†ä¹Ÿä¸èƒ½å¤–æ¼ï¼Œä¸ç„¶ç¬”è€…çš„ç¨‹åºå‘˜èŒä¸šç”Ÿæ¶¯ä¼°è®¡å°±åˆ°å¤´äº†ï¼</p>

<pre><code>å‰è¨€ï¼šæœ€è¿‘ç¬”è€…åœ¨ç ”ç©¶iOSé€†å‘å·¥ç¨‹ï¼Œé¡ºä¾¿æ‹¿å¾®ä¿¡æ¥ç»ƒæ‰‹ï¼Œåœ¨éè¶Šç‹±æ‰‹æœºä¸Šå®ç°äº†å¾®ä¿¡è‡ªåŠ¨æŠ¢çº¢åŒ…çš„åŠŸèƒ½ã€‚
</code></pre>

<p>é¢˜å¤–è¯ï¼šæ­¤æ•™ç¨‹æ˜¯ä¸€ç¯‡ä¸¥è‚ƒçš„å­¦æœ¯æ¢è®¨ç±»æ–‡ç« ï¼Œä»…ä»…ç”¨äºå­¦ä¹ ç ”ç©¶ï¼Œä¹Ÿè¯·è¯»è€…ä¸è¦ç”¨äºå•†ä¸šæˆ–å…¶ä»–éæ³•é€”å¾„ä¸Šï¼Œç¬”è€…ä¸€æ¦‚ä¸è´Ÿè´£å“Ÿ~~</p>

<p>å¥½äº†ï¼Œæ¥ä¸‹æ¥å¯ä»¥è¿›å…¥æ­£é¢˜äº†ï¼</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/01/weixinhongbao/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/01/gezhongdicenshixian/">iOSå¼€å‘å„ç§åº•å±‚å®ç°--åŒ…ä½ æ»¡æ„ï¼</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-01T13:53:19+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>1:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>iOSå¼€å‘å¸¸ç”¨æŠ€æœ¯åº•å±‚å®ç°ï¼ˆç²¾ç®€æ¦‚è¿°ï¼‰</p>

<h6>ç³»ç»Ÿç¯‡</h6>

<ul>
<li>å†…å­˜ç®¡ç†</li>
<li>Runtime</li>
</ul>


<h6>ä»£ç ç¯‡</h6>

<ul>
<li>Block</li>
<li>__Block</li>
</ul>


<h6>å®æˆ˜</h6>

<ul>
<li>KVO</li>
<li>KVC</li>
</ul>


<h6>é«˜çº§</h6>

<ul>
<li>GCD</li>
</ul>


<h6>é€šç”¨ç¯‡</h6>

<ul>
<li>æ•°ç»„</li>
<li>å­—å…¸</li>
<li>é›†åˆ</li>
</ul>


<h6>å¿…å¤‡ç¯‡</h6>

<ul>
<li>å¤šçº¿ç¨‹</li>
<li>ç½‘ç»œ</li>
<li>æ•°æ®æŒä¹…åŒ–</li>
</ul>


<h6>å…¨æ ˆç¯‡</h6>

<ul>
<li>JSPatch</li>
<li>React Native</li>
</ul>


<h6>#å†™åœ¨æœ€å</h6>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/01/gezhongdicenshixian/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/01/sqlzfengzhuang/">SQLiteå°è£…ç¯‡</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-01T12:59:42+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>12:59 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>æœ€è¿‘å†™çš„é¡¹ç›®ä¸­æœ‰ç”¨åˆ°æ•°æ®åº“,å†™äº†ä¸å°‘è›‹ç–¼çš„sqlè¯­å¥,æ¯æ¬¡éƒ½æ˜¯å¥½å‡ è¡Œä»£ç ,è€Œä¸”æ¯æ¬¡éƒ½æ˜¯é‡å¤çš„æ²¡æœ‰ä¸€ç‚¹æŠ€æœ¯å«é‡çš„ä»£ç ,è™½ç„¶ä¹Ÿæœ‰ä¸å°‘åŸºäºsqliteçš„å°è£…,ä¸è¿‡ç”¨èµ·æ¥è¿˜æ˜¯æ„Ÿè§‰ä¸å¤Ÿé¢å‘å¯¹è±¡! ä¸ºäº†ä¸å†å†™é‡å¤çš„ä»£ç ,èŠ±äº†å‡ å¤©æ—¶é—´,åŸºäºSQLite3ç®€å•å°è£…äº†ä¸‹,å®ç°äº†ä¸€è¡Œä»£ç è§£å†³å¢åˆ æ”¹æŸ¥ç­‰å¸¸ç”¨çš„åŠŸèƒ½!å¹¶æ²¡æœ‰å¤ªè¿‡é«˜æ·±çš„çŸ¥è¯†,ä¸»è¦ç”¨äº†runtimeå’ŒKVC:</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/01/sqlzfengzhuang/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/07/01/sqljinghua/">SQLiteç²¾åç¯‡</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-07-01T02:59:42+08:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>2:59 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>æ¦‚è¿°</h4>

<p>iOSç³»ç»Ÿè‡ªå¸¦Core Dataæ¥è¿›è¡ŒæŒä¹…åŒ–å¤„ç†ï¼Œè€Œä¸”Core Dataå¯ä»¥ä½¿ç”¨å›¾å½¢åŒ–ç•Œé¢æ¥åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯Core Dataä¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå¯¹äºCore Dataæ¥è¯´æ¯”è¾ƒæ“…é•¿ç®¡ç†åœ¨è®¾å¤‡ä¸Šåˆ›å»ºçš„æ•°æ®æŒä¹…åŒ–å­˜å‚¨ç”¨æˆ·åˆ›å»ºçš„å¯¹è±¡ï¼Œä½†æ˜¯è¦å¤„ç†å¤§é‡çš„æ•°æ®æ—¶å°±åº”è¯¥ä¼˜å…ˆé€‰æ‹©SQLå…³ç³»å‹æ•°æ®åº“æ¥å­˜å‚¨è¿™äº›æ•°æ®ã€‚
Core Dataåœ¨åå°ä¹Ÿæ˜¯ä½¿ç”¨SQLiteæ¥å­˜å‚¨æ•°æ®çš„ï¼Œä½†æ˜¯å¼€å‘äººå‘˜ä¸èƒ½ç›´æ¥è®¿é—®è¿™äº›æ•°æ®ï¼Œåªèƒ½é€šè¿‡Core Dataæä¾›çš„APIæ¥æ“ä½œï¼Œå¦‚æœä¸€æ—¦äººä¸ºçš„é€šè¿‡SQLiteä¿®æ”¹è¿™äº›æ•°æ®é‚£ä¹ˆä½¿ç”¨Core Dataå†æ¬¡è®¿é—®è¿™äº›æ•°æ®æ—¶å°±ä¼šå‘ç”Ÿé”™è¯¯ã€‚</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/07/01/sqljinghua/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/22/socketudp/">Socketudp</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-22T00:00:00+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2016</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><hr />

<p>layout: post
title: &ldquo;Socketç¼–ç¨‹-UDPç¯‡&rdquo;
date: 2016-06-22 13:53:19 +0800
comments: true
categories: Senior
description: iCocosåšå®¢
keywords: iCocos, iOSå¼€å‘, åšå®¢, æŠ€æœ¯åˆ†æ, æ–‡ç« , å­¦ä¹ , æ›¹é», æ›¹ç†é¹</p>

<hr />

<h3>1. UDP Socketç¼–ç¨‹</h3>

<p>å…ˆè®²ä¸€è®²UDPç¼–ç¨‹ï¼Œå› ä¸ºæ¯”TCPè¦ç®€å•å¤šäº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½UDPæ˜¯ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œè‹±æ–‡åä¸ºUser Datagram Protocolï¼Œå®ƒæ˜¯é¢å‘æ— è¿æ¥çš„ã€‚</p>

<p>æ³¨æ„ï¼šSocketé€šä¿¡ä¸€å®šæœ‰è¦æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p>

<h4>1.1 UDP Socketå®¢æˆ·ç«¯</h4>

<p>å®¢æˆ·ç«¯çš„å·¥ä½œæµç¨‹ï¼šé¦–å…ˆè°ƒç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªSocketï¼Œç„¶åæŒ‡å®šæœåŠ¡ç«¯çš„IPåœ°å€å’Œç«¯å£å·ï¼Œå°±å¯ä»¥è°ƒç”¨sendtoå°†å­—ç¬¦ä¸²ä¼ é€ç»™æœåŠ¡å™¨ç«¯ï¼Œå¹¶å¯ä»¥è°ƒç”¨recvfromæ¥æ”¶æœåŠ¡å™¨ç«¯è¿”å›çš„å­—ç¬¦ä¸²ï¼Œæœ€åå…³é—­è¯¥socketã€‚</p>

<p>ç¬”è€…è¿™é‡Œåˆ†æˆäº†å››æ­¥ï¼š</p>

<pre><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocketå¹¶é…ç½®socketï¼Œå¦‚æœåŠ¡ç«¯ipåœ°å€å’Œç«¯å£å·
ç¬¬äºŒæ­¥ï¼šè°ƒç”¨sendtoå‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨ç«¯
ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨recvfromæ¥æ”¶æ¥è‡ªæœåŠ¡å™¨ç«¯çš„æ¶ˆæ¯
ç¬¬å››æ­¥ï¼šè°ƒç”¨closeå…³é—­socket
</code></pre>

<h4>1.1.1 å®¢æˆ·ç«¯çš„ä»£ç å®ç°ï¼š</h4>

<pre><code>- (void)udpClient {
  int clientSocketId;
  ssize_t len;
  socklen_t addrlen;
  struct sockaddr_in client_sockaddr;
  char buffer[256] = "Hello, server, how are you?";

  // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºSocket
  clientSocketId = socket(AF_INET, SOCK_DGRAM, 0);
  if(clientSocketId &lt; 0) {
    NSLog(@"creat client socket fail\n");
    return;
  }

  addrlen = sizeof(struct sockaddr_in);
  bzero(&amp;client_sockaddr, addrlen);
  client_sockaddr.sin_family = AF_INET;
  client_sockaddr.sin_addr.s_addr = inet_addr("192.168.1.107");
  client_sockaddr.sin_port = htons(1024);

  int count = 10;
  do {
    bzero(buffer, sizeof(buffer));
    sprintf(buffer, "%s", "Hello, server, how are you?");

    // ç¬¬äºŒæ­¥ï¼šå‘é€æ¶ˆæ¯åˆ°æœåŠ¡ç«¯
    // æ³¨æ„:UDPæ˜¯é¢å‘æ— è¿æ¥çš„ï¼Œå› æ­¤ä¸ç”¨è°ƒç”¨connect()
    // å°†å­—ç¬¦ä¸²ä¼ é€ç»™serverç«¯
   len = sendto(clientSocketId, buffer, sizeof(buffer), 0, (struct sockaddr *)&amp;client_sockaddr, addrlen);

    if (len &gt; 0) {
      NSLog(@"å‘é€æˆåŠŸ");
    } else {
      NSLog(@"å‘é€å¤±è´¥");
    }

    // ç¬¬ä¸‰æ­¥ï¼šæ¥æ”¶æ¥è‡ªæœåŠ¡ç«¯è¿”å›çš„æ¶ˆæ¯
    // æ¥æ”¶serverç«¯è¿”å›çš„å­—ç¬¦ä¸²
    bzero(buffer, sizeof(buffer));
    len = recvfrom(clientSocketId, buffer, sizeof(buffer), 0, (struct sockaddr *)&amp;client_sockaddr, &amp;addrlen);
    NSLog(@"receive message from server: %s", buffer);

    count--;
  } while (count &gt;= 0);

  // ç¬¬å››æ­¥ï¼šå…³é—­socket
  // ç”±äºæ˜¯é¢å‘æ— è¿æ¥çš„ï¼Œæ¶ˆæ¯å‘å‡ºå¤„å°±å¯ä»¥äº†ï¼Œä¸ç”¨ç®¡å®ƒæ”¶ä¸æ”¶å¾—åˆ°ï¼Œå‘å®Œå°±å¯ä»¥å…³é—­äº†
  close(clientSocketId);
}
</code></pre>

<h4>1.1.2 å®¢æˆ·ç«¯çš„æ‰“å°æ—¥å¿—</h4>

<pre><code>2015-12-06 15:38:36.095 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.286 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.286 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.291 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.291 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.296 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.296 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.316 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.317 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.324 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.324 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.328 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.329 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.339 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.339 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.355 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.356 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.366 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.366 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.372 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
2015-12-06 15:38:36.373 iOS-Socket-C-Version-Client[9709:4234848] å‘é€æˆåŠŸ
2015-12-06 15:38:36.392 iOS-Socket-C-Version-Client[9709:4234848] receive message from server: Hello, server, how are you?
</code></pre>

<h4>1.2 UDP SocketæœåŠ¡å™¨ç«¯</h4>

<p>æœåŠ¡å™¨ç«¯çš„å·¥ä½œæµç¨‹ï¼šé¦–å…ˆè°ƒç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼Œç„¶åè°ƒç”¨bindå‡½æ•°å°†å…¶ä¸æœ¬æœºåœ°å€ä»¥åŠä¸€ä¸ªæœ¬åœ°ç«¯å£å·ç»‘å®šï¼Œæ¥æ”¶åˆ°ä¸€ä¸ªå®¢æˆ·ç«¯æ—¶ï¼ŒæœåŠ¡å™¨æ˜¾ç¤ºè¯¥å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œå¹¶å°†å­—ä¸²è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>

<p>ç¬”è€…è¿™é‡Œåˆ†æˆäº†äº”æ­¥ï¼š</p>

<pre><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocketå¹¶é…ç½®socket
ç¬¬äºŒæ­¥ï¼šè°ƒç”¨bindç»‘å®šæœåŠ¡å™¨æœ¬æœºipåŠç«¯å£å·
ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨recvfromæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯
ç¬¬å››æ­¥ï¼šè°ƒç”¨sendtoå°†æ¥æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯
ç¬¬å››æ­¥ï¼šè°ƒç”¨closeå…³é—­socket
</code></pre>

<h4>1.2.1 æœåŠ¡å™¨ç«¯ä»£ç å®ç°</h4>

<pre><code>- (void)udpServer {
  int serverSockerId = -1;
  ssize_t len = -1;
  socklen_t addrlen;
  char buff[1024];
  struct sockaddr_in ser_addr;

  // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocket
  // æ³¨æ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯SOCK_DGRAMï¼Œå› ä¸ºudpæ˜¯æ•°æ®æŠ¥æ ¼å¼çš„
  serverSockerId = socket(AF_INET, SOCK_DGRAM, 0);

  if(serverSockerId &lt; 0) {
    NSLog(@"Create server socket fail");
    return;
  }

  addrlen = sizeof(struct sockaddr_in);
  bzero(&amp;ser_addr, addrlen);

  ser_addr.sin_family = AF_INET;
  ser_addr.sin_addr.s_addr = htonl(INADDR_ANY);
  ser_addr.sin_port = htons(1024);

  // ç¬¬äºŒæ­¥ï¼šç»‘å®šç«¯å£å·
  if(bind(serverSockerId, (struct sockaddr *)&amp;ser_addr, addrlen) &lt; 0) {
    NSLog(@"server connect socket fail");
    return;
  }

  do {
    bzero(buff, sizeof(buff));

    // ç¬¬ä¸‰æ­¥ï¼šæ¥æ”¶å®¢æˆ·ç«¯çš„æ¶ˆæ¯
    len = recvfrom(serverSockerId, buff, sizeof(buff), 0, (struct sockaddr *)&amp;ser_addr, &amp;addrlen);
    // æ˜¾ç¤ºclientç«¯çš„ç½‘ç»œåœ°å€
    NSLog(@"receive from %s\n", inet_ntoa(ser_addr.sin_addr));
    // æ˜¾ç¤ºå®¢æˆ·ç«¯å‘æ¥çš„å­—ç¬¦ä¸²
    NSLog(@"recevce:%s", buff);

    // ç¬¬å››æ­¥ï¼šå°†æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯ï¼Œå‘å›å®¢æˆ·ç«¯
    // å°†å­—ä¸²è¿”å›ç»™clientç«¯
    sendto(serverSockerId, buff, len, 0, (struct sockaddr *)&amp;ser_addr, addrlen);
  } while (strcmp(buff, "exit") != 0);

  // ç¬¬äº”æ­¥ï¼šå…³é—­socket
  close(serverSockerId);
}
</code></pre>

<h4>1.2.2 æœåŠ¡å™¨ç«¯çš„æ‰“å°æ—¥å¿—</h4>

<pre><code>2015-12-06 15:38:36.268 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.269 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.372 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.372 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.377 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.377 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.382 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.382 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.405 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.405 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.409 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.410 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.414 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.415 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.425 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.426 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.441 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.441 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.452 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.452 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
2015-12-06 15:38:36.472 iOS-Socket-C-Version-Server[39130:2473780] receive from 192.168.1.100
2015-12-06 15:38:36.473 iOS-Socket-C-Version-Server[39130:2473780] recevce:Hello, server, how are you?
</code></pre>

<p>æˆ‘ä»¬è¿™é‡Œæ‰“å°å‡ºäº†å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯ï¼Œç”±äºä¸Šé¢å®ç°çš„ä»£ç ä¸­ï¼Œåªå‘10æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œåªæœ‰10æ¡ã€‚</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/21/cockettcp/">Cockettcp</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-21T00:00:00+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><hr />

<p>layout: post
title: &ldquo;Socketç¼–ç¨‹-TCPç¯‡&rdquo;
date: 2016-06-21 13:53:19 +0800
comments: true
categories: Senior
description: iCocosåšå®¢
keywords: iCocos, iOSå¼€å‘, åšå®¢, æŠ€æœ¯åˆ†æ, æ–‡ç« , å­¦ä¹ , æ›¹é», æ›¹ç†é¹</p>

<hr />

<h3>1. TCP Socketç¼–ç¨‹</h3>

<p>TCPæ˜¯é¢å‘è¿æ¥çš„ï¼Œå®‰å…¨å¯é çš„ä¼ è¾“å±‚åè®®ã€‚TCPçš„ç¨‹åºåŸºæœ¬æ¡†æ¶è®¾è®¡å›¾ï¼š</p>

<p>image</p>

<p>æ³¨æ„ï¼šSocketé€šä¿¡ä¸€å®šæœ‰è¦æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p>

<h4>1.1 TCP Socketå®¢æˆ·ç«¯</h4>

<p>å®¢æˆ·ç«¯çš„å·¥ä½œæµç¨‹ï¼šé¦–å…ˆè°ƒç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªSocketï¼Œç„¶åæŒ‡å®šæœåŠ¡ç«¯çš„IPåœ°å€å’Œç«¯å£å·ï¼Œå°±å¯ä»¥è°ƒç”¨sendtoå°†å­—ç¬¦ä¸²ä¼ é€ç»™æœåŠ¡å™¨ç«¯ï¼Œå¹¶å¯ä»¥è°ƒç”¨recvfromæ¥æ”¶æœåŠ¡å™¨ç«¯è¿”å›çš„å­—ç¬¦ä¸²ï¼Œæœ€åå…³é—­è¯¥socketã€‚</p>

<p>ç¬”è€…è¿™é‡Œåˆ†æˆäº†å…­æ­¥ï¼š</p>

<pre><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocketå¹¶é…ç½®socket
ç¬¬äºŒæ­¥ï¼šè°ƒç”¨bindç»‘å®šç›‘å¬ipå’Œç«¯å£å·
ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨connectè¿æ¥æœåŠ¡å™¨
ç¬¬å››æ­¥ï¼šè°ƒç”¨getsocknameè·å–å¥—æ¥å­—ä¿¡æ¯
ç¬¬äº”æ­¥ï¼šè°ƒç”¨sendå‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨ç«¯
ç¬¬å…­æ­¥ï¼šè°ƒç”¨closeå…³é—­socket
</code></pre>

<p>è¿™é‡Œæ²¡æœ‰å†™æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨ç«¯çš„æ¶ˆæ¯ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæ·»åŠ ã€‚</p>

<h4>1.1.1 å®¢æˆ·ç«¯çš„ä»£ç å®ç°ï¼š</h4>

<pre><code>- (void)tcpClient {
  // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsoket
  // TCPæ˜¯åŸºäºæ•°æ®æµçš„ï¼Œå› æ­¤å‚æ•°äºŒä½¿ç”¨SOCK_STREAM
  int error = -1;
  int clientSocketId = socket(AF_INET, SOCK_STREAM, 0);
  BOOL success = (clientSocketId != -1);
  struct sockaddr_in addr;

  // ç¬¬äºŒæ­¥ï¼šç»‘å®šç«¯å£å·
  if (success) {
    NSLog(@"client socket create success");
    // åˆå§‹åŒ–
    memset(&amp;addr, 0, sizeof(addr));
    addr.sin_len = sizeof(addr);

    // æŒ‡å®šåè®®ç°‡ä¸ºAF_INETï¼Œæ¯”å¦‚TCP/UDPç­‰
    addr.sin_family = AF_INET;

    // ç›‘å¬ä»»ä½•ipåœ°å€
    addr.sin_addr.s_addr = INADDR_ANY;
    error = bind(clientSocketId, (const struct sockaddr *)&amp;addr, sizeof(addr));
    success = (error == 0);
  }

  if (success) {
    // p2p
    struct sockaddr_in peerAddr;
    memset(&amp;peerAddr, 0, sizeof(peerAddr));
    peerAddr.sin_len = sizeof(peerAddr);
    peerAddr.sin_family = AF_INET;
    peerAddr.sin_port = htons(1024);

    // æŒ‡å®šæœåŠ¡ç«¯çš„ipåœ°å€ï¼Œæµ‹è¯•æ—¶ï¼Œä¿®æ”¹æˆå¯¹åº”è‡ªå·±æœåŠ¡å™¨çš„ip
    peerAddr.sin_addr.s_addr = inet_addr("192.168.1.107");

    socklen_t addrLen;
    addrLen = sizeof(peerAddr);
    NSLog(@"will be connecting");

    // ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æœåŠ¡å™¨
    error = connect(clientSocketId, (struct sockaddr *)&amp;peerAddr, addrLen);
    success = (error == 0);

    if (success) {
      // ç¬¬å››æ­¥ï¼šè·å–å¥—æ¥å­—ä¿¡æ¯
      error = getsockname(clientSocketId, (struct sockaddr *)&amp;addr, &amp;addrLen);
      success = (error == 0);

      if (success) {
        NSLog(@"client connect success, local address:%s,port:%d",
              inet_ntoa(addr.sin_addr),
              ntohs(addr.sin_port));

        // è¿™é‡Œåªå‘é€10æ¬¡
        int count = 10;
        do {
          // ç¬¬äº”æ­¥ï¼šå‘é€æ¶ˆæ¯åˆ°æœåŠ¡ç«¯
          send(clientSocketId, "å“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼", 1024, 0);
          count--;

          // å‘Šè¯‰serverï¼Œå®¢æˆ·ç«¯é€€å‡ºäº†
          if (count == 0) {
            send(clientSocketId, "exit", 1024, 0);
          }
        } while (count &gt;= 1);

        // ç¬¬å…­æ­¥ï¼šå…³é—­å¥—æ¥å­—
        close(clientSocketId);
      }
    } else {
      NSLog(@"connect failed");

      // ç¬¬å…­æ­¥ï¼šå…³é—­å¥—æ¥å­—
      close(clientSocketId);
    }
  }
}
</code></pre>

<h4>1.1.2 å®¢æˆ·ç«¯çš„æ‰“å°æ—¥å¿—</h4>

<pre><code>2015-12-06 18:35:00.385 iOS-Socket-C-Version-Client[9726:4256295] client socket create success
2015-12-06 18:35:00.386 iOS-Socket-C-Version-Client[9726:4256295] will be connecting
2015-12-06 18:35:00.507 iOS-Socket-C-Version-Client[9726:4256295] client connect success, local address:192.168.1.100,port:50311
</code></pre>

<p>è¯´æ˜è¿æ¥æœåŠ¡å™¨æˆåŠŸï¼Œç„¶åå‘é€äº†æ¶ˆæ¯åˆ°æœåŠ¡å™¨ç«¯ã€‚
1.2 TCP SocketæœåŠ¡å™¨ç«¯</p>

<p>æœåŠ¡å™¨ç«¯çš„å·¥ä½œæµç¨‹ï¼šé¦–å…ˆè°ƒç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼Œç„¶åè°ƒç”¨bindå‡½æ•°å°†å…¶ä¸æœ¬æœºåœ°å€ä»¥åŠä¸€ä¸ªæœ¬åœ°ç«¯å£å·ç»‘å®šï¼Œæ¥æ”¶åˆ°ä¸€ä¸ªå®¢æˆ·ç«¯æ—¶ï¼ŒæœåŠ¡å™¨æ˜¾ç¤ºè¯¥å®¢æˆ·ç«¯çš„IPåœ°å€ï¼Œå¹¶å°†å­—ä¸²è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>

<p>ç¬”è€…è¿™é‡Œåˆ†æˆäº†äº”æ­¥ï¼š</p>

<pre><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocketå¹¶é…ç½®socket
ç¬¬äºŒæ­¥ï¼šè°ƒç”¨bindç»‘å®šæœåŠ¡å™¨æœ¬æœºipåŠç«¯å£å·
ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨listenç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶æŒ‡å®šåŒæ—¶æœ€å¤šå¯è®©acceptçš„æ•°é‡
ç¬¬å››æ­¥ï¼šè°ƒç”¨acceptç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥
ç¬¬äº”æ­¥ï¼šè°ƒç”¨recvfromæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯
ç¬¬å…­æ­¥ï¼šè°ƒç”¨closeå…³é—­socket
</code></pre>

<h4>1.2.1 æœåŠ¡å™¨ç«¯ä»£ç å®ç°</h4>

<pre><code>- (void)tcpServer {
  // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºsocket
  int error = -1;

  // åˆ›å»ºsocketå¥—æ¥å­—
  int serverSocketId = socket(AF_INET, SOCK_STREAM, 0);
  // åˆ¤æ–­åˆ›å»ºsocketæ˜¯å¦æˆåŠŸ
  BOOL success = (serverSocketId != -1);

  // ç¬¬äºŒæ­¥ï¼šç»‘å®šç«¯å£å·
  if (success) {
    NSLog(@"server socket create success");
    // Socket address
    struct sockaddr_in addr;

    // åˆå§‹åŒ–å…¨ç½®ä¸º0
    memset(&amp;addr, 0, sizeof(addr));

    // æŒ‡å®šsocketåœ°å€é•¿åº¦
    addr.sin_len = sizeof(addr);

    // æŒ‡å®šç½‘ç»œåè®®ï¼Œæ¯”å¦‚è¿™é‡Œä½¿ç”¨çš„æ˜¯TCP/UDPåˆ™æŒ‡å®šä¸ºAF_INET
    addr.sin_family = AF_INET;

    // æŒ‡å®šç«¯å£å·
    addr.sin_port = htons(1024);

    // æŒ‡å®šç›‘å¬çš„ipï¼ŒæŒ‡å®šä¸ºINADDR_ANYæ—¶ï¼Œè¡¨ç¤ºç›‘å¬æ‰€æœ‰çš„ip
    addr.sin_addr.s_addr = INADDR_ANY;

    // ç»‘å®šå¥—æ¥å­—
    error = bind(serverSocketId, (const struct sockaddr *)&amp;addr, sizeof(addr));
    success = (error == 0);
  }

  // ç¬¬ä¸‰æ­¥ï¼šç›‘å¬
  if (success) {
    NSLog(@"bind server socket success");
    error = listen(serverSocketId, 5);
    success = (error == 0);
  }

  if (success) {
    NSLog(@"listen server socket success");

    while (true) {
      // p2p
      struct sockaddr_in peerAddr;
      int peerSocketId;
      socklen_t addrLen = sizeof(peerAddr);

      // ç¬¬å››æ­¥ï¼šç­‰å¾…å®¢æˆ·ç«¯è¿æ¥
      // æœåŠ¡å™¨ç«¯ç­‰å¾…ä»ç¼–å·ä¸ºserverSocketIdçš„Socketä¸Šæ¥æ”¶å®¢æˆ·è¿æ¥è¯·æ±‚
      peerSocketId = accept(serverSocketId, (struct sockaddr *)&amp;peerAddr, &amp;addrLen);
      success = (peerSocketId != -1);

      if (success) {
        NSLog(@"accept server socket success,remote address:%s,port:%d",
              inet_ntoa(peerAddr.sin_addr),
              ntohs(peerAddr.sin_port));
        char buf[1024];
        size_t len = sizeof(buf);

        // ç¬¬äº”æ­¥ï¼šæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„ä¿¡æ¯
        // å½“å®¢æˆ·ç«¯è¾“å…¥exitæ—¶æ‰é€€å‡º
        do {
          // æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„ä¿¡æ¯
          recv(peerSocketId, buf, len, 0);
          if (strlen(buf) != 0) {
            NSString *str = [NSString stringWithCString:buf encoding:NSUTF8StringEncoding];
            if (str.length &gt;= 1) {
              NSLog(@"received message from clientï¼š%@",str);
            }
          }
        } while (strcmp(buf, "exit") != 0);

        NSLog(@"æ”¶åˆ°exitä¿¡å·ï¼Œæœ¬æ¬¡socketé€šä¿¡å®Œæ¯•");

        // ç¬¬å…­æ­¥ï¼šå…³é—­socket
        close(peerSocketId);
      }
    }
  }
}
</code></pre>

<h4>1.2.2 æœåŠ¡å™¨ç«¯çš„æ‰“å°æ—¥å¿—</h4>

<pre><code>2015-12-06 18:34:31.258 iOS-Socket-C-Version-Server[39929:2622200] server socket create success
2015-12-06 18:34:31.258 iOS-Socket-C-Version-Server[39929:2622200] bind server socket success
2015-12-06 18:34:31.259 iOS-Socket-C-Version-Server[39929:2622200] listen server socket success
2015-12-06 18:35:00.743 iOS-Socket-C-Version-Server[39929:2622200] accept server socket success,remote address:192.168.1.100,port:50311
2015-12-06 18:35:00.743 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.743 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.743 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.744 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.745 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šå“ˆå“ˆï¼Œserveræ‚¨å¥½ï¼
2015-12-06 18:35:00.745 iOS-Socket-C-Version-Server[39929:2622200] received message from clientï¼šexit
2015-12-06 18:35:00.745 iOS-Socket-C-Version-Server[39929:2622200] æ”¶åˆ°exitä¿¡å·ï¼Œæœ¬æ¬¡socketé€šä¿¡å®Œæ¯•
</code></pre>

<p>æˆ‘ä»¬è¿™é‡Œæ‰“å°å‡ºäº†å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯ï¼Œç”±äºä¸Šé¢å®ç°çš„ä»£ç ä¸­ï¼Œåªå‘10æ¬¡ï¼Œæ‰€ä»¥è¿™é‡Œåªæœ‰10æ¡ã€‚</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/20/cocketjichu/">Cocketjichu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-20T00:00:00+08:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><hr />

<p>layout: post
title: &ldquo;Socketç¼–ç¨‹-ç²¾åç¯‡&rdquo;
date: 2016-06-20 13:53:19 +0800
comments: true
categories: Senior
description: iCocosåšå®¢
keywords: iCocos, iOSå¼€å‘, åšå®¢, æŠ€æœ¯åˆ†æ, æ–‡ç« , å­¦ä¹ , æ›¹é», æ›¹ç†é¹</p>

<hr />

<p>æœ¬åºåˆ—æ–‡ç« å…³äºSocketç¼–ç¨‹ï¼Œæ‘˜è‡ª<a href="http://www.huangyibiao.com/">å¤§ç¥æ ‡å“¥</a>çš„ç²¾å</p>

<h2>åºè¨€</h2>

<p>ç½‘ç»œä¸ƒå±‚ç”±ä¸‹å¾€ä¸Šåˆ†åˆ«ä¸ºç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚ã€‚ å…¶ä¸­ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚å’Œç½‘ç»œå±‚é€šå¸¸è¢«ç§°ä½œåª’ä½“å±‚ï¼Œæ˜¯ç½‘ç»œå·¥ç¨‹å¸ˆæ‰€ç ”ç©¶çš„å¯¹è±¡ï¼› ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚åˆ™è¢«ç§°ä½œä¸»æœºå±‚ï¼Œæ˜¯ç”¨æˆ·æ‰€é¢å‘å’Œå…³å¿ƒçš„å†…å®¹ã€‚</p>

<pre><code>httpåè®®å¯¹åº”äºåº”ç”¨å±‚
tcp/udpåè®®å¯¹åº”äºä¼ è¾“å±‚
ipåè®®å¯¹åº”äºç½‘ç»œå±‚
</code></pre>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/06/20/cocketjichu/">é˜…è¯»å…¨æ–‡ğŸ˜˜</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
    <h1>æ–‡ç« åˆ†ç±»</h1>
    <ul id="categories">
        <li class='category'><a href='/blog/categories/apples/'>apples (2)</a></li>
<li class='category'><a href='/blog/categories/audio-video/'>audio-video (1)</a></li>
<li class='category'><a href='/blog/categories/developer/'>developer (15)</a></li>
<li class='category'><a href='/blog/categories/foundation/'>foundation (32)</a></li>
<li class='category'><a href='/blog/categories/full/'>full (13)</a></li>
<li class='category'><a href='/blog/categories/low-level/'>low-level (4)</a></li>
<li class='category'><a href='/blog/categories/news/'>news (4)</a></li>
<li class='category'><a href='/blog/categories/others/'>others (1)</a></li>
<li class='category'><a href='/blog/categories/performance/'>performance (12)</a></li>
<li class='category'><a href='/blog/categories/reverse/'>reverse (25)</a></li>
<li class='category'><a href='/blog/categories/senior/'>senior (38)</a></li>
<li class='category'><a href='/blog/categories/stack/'>stack (13)</a></li>
<li class='category'><a href='/blog/categories/summarize/'>summarize (5)</a></li>
<li class='category'><a href='/blog/categories/tools/'>tools (5)</a></li>

    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/07/26/chongzhengzhidao/">é‡æ•´ä¹‹é“ï¼ˆé¢è¯•+æŠ€æœ¯+åº•å±‚+é«˜çº§ï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/10/duoxianc/">å¤šçº¿ç¨‹ä¹‹è‘µèŠ±å®å…¸</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/05/zsqlfmdbcoredata/">CoreData ğŸ˜˜ SQLite ğŸ˜ FMDB</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/05/xsqlyucoredata/">CoreData å¤§æˆ˜ SQLite</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/07/05/ycoredatayurealm/">Realm çˆ†èŠ CoreData</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/al1020119">@al1020119</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'al1020119',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>




<section>
<h1>æ‰«ä¸€æ‰«<abbr title="The word 'æ‰«ä¸€æ‰«' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'æ‰«ä¸€æ‰«', not for image.">&trade;</abbr></h1>
<a href="http://al1020119.github.io/posts/2/index.html"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://al1020119.github.io/posts/2/index.html" alt="post-qrcode"></a></section>
<section>
    <h1>è®¿å®¢ç»Ÿè®¡</h1>
    <br/>
    <a href="http://s07.flagcounter.com/more/2SH"><img src="http://s07.flagcounter.com/count/2SH/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_12/viewers_0/labels_0/pageviews_1/flags_0/" alt="Flag Counter" border="0"></a>
</section><section>
    <h1>æ–°æµªå¾®åš</h1>
    <ul id="weibo">
        <li>
            
            <!-- åœ¨æ­¤æ’å…¥è·å¾—çš„å¾®åšç§€ä»£ç  -->
            <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3288975567&verifier=20ffcedd&dpc=1"></iframe>
            
        </li>
    </ul>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - iCocos -
<span class="credit">welcome to <a href="http://al1020119.github.io">æ›¹#é»</a></span>
</p>

</footer>
  






<!--
-->



</body>
</html>
